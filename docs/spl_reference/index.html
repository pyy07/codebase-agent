<!DOCTYPE html><html lang="en" style="--yotta-icon-color-default: #4a4a4a;"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="YottaByte"><meta name="author" content="yottateam"><title>帮助文档</title><script>try{document.fonts.ready.then((()=>{document.fonts.check("14px PingFangSC-Regular")||document.fonts.add(new FontFace("PingFangSC-Regular","url('/static/public/font/PingFangSC-Regular.ttf')"))}))}catch(n){console.error("Failed to load font 'PingFangSC-Regular'")}</script><style>body{font-family:PingFangSC-Regular,Helvetica Neue,STHeiti,Microsoft Yahei,Tahoma,Simsun,sans-serif}</style><script defer="defer" src="/static/dist/dll/locales.dll.js"></script><script defer="defer" src="/static/dist/docs/runtime~index.7d5b0eb3.js"></script><script defer="defer" src="/static/dist/docs/vendors.9571e86b.js"></script><script defer="defer" src="/static/dist/docs/index.ef482e2f.js"></script><link href="/static/dist/docs/vendors.f56234ed.css" rel="stylesheet"><link href="/static/dist/docs/index.5f4a3641.css" rel="stylesheet"><style data-emotion="css" data-s=""></style></head><body><div id="app"><div class="css-m8dnq0"><div class="css-1mrew9n"><div class="css-nyt6sb"><img class="css-1xlq5hq" src="blob:http://log.gf.com.cn/f34adde2-b1b5-4c4e-8ffb-fcf01a9f7785"></div><span class="css-4flieg"><span>应用</span></span><span class="css-4flieg" style="margin-left: 16px;"><span>导航</span></span><div class="css-1246wep"><div class="yotta-divider yotta-divider-vertical yotta-divider-gap-medium css-1571gh5" style="margin-left: 16px; background: rgba(255, 255, 255, 0.4);"></div><div class="navigation-shortcut__container"><a class="yotta-typography-link css-1u6z3rv navigation-shortcut__link-main" href="/dashboard/" target="_top" style="color: rgb(255, 255, 255); display: inline-block;">仪表盘</a><a class="yotta-typography-link css-1u6z3rv navigation-shortcut__link-main" href="/search/" target="_top" style="color: rgb(255, 255, 255); display: inline-block;">搜索</a></div></div><div style="flex: 1 1 auto;"></div><div class="yotta-input-affix-wrapper yotta-input-affix-wrapper-large css-4xc2iu"><input yotta-test="global_search-input" class="yotta-input yotta-input-large css-yva7x5" type="text" autocomplete="off" placeholder="全局搜索" value=""><span class="yotta-input-suffix"><span class="yotta-icon yotta-icon-Search yotta-input-affix-icon" role="img" aria-label="Search"><svg viewBox="0 0 1024 1024" focusable="false" width="1em" height="1em" data-icon="Search" fill="currentColor"><defs><style></style></defs><path d="M695.18 638.3a42.67 42.67 0 0155.53-4.16l4.77 4.15 213.34 213.34a42.67 42.67 0 01-55.53 64.45l-4.77-4.15L695.18 698.6a42.67 42.67 0 010-60.3z"></path><path d="M469.33 14.22a398.22 398.22 0 100 796.45 398.22 398.22 0 000-796.45zm0 85.34a312.89 312.89 0 110 625.77 312.89 312.89 0 010-625.77z"></path></svg></span></span></div><div class="yotta-avatar yotta-avatar-circle css-1z0wblt" style="width: 24px; height: 24px; cursor: pointer; margin-left: 16px;"><img class="yotta-avatar-img" src="blob:http://log.gf.com.cn/76858ffd-7d3b-46fe-8ace-60371473e44f" alt="潘义勇_ldap"></div></div><div class="css-o4ribp"><div class="yotta-pageheader css-1jd3i8m"><div class="yotta-pageheader-banner"><div class="yotta-pageheader-banner-main"><span class="yotta-pageheader-title"><nav aria-label="breadcrumb" class="yotta-breadcrumb css-xk0dim"><ol class="yotta-breadcrumb-list"><li class="yotta-breadcrumb-item">个人</li><li aria-hidden="true" class="yotta-breadcrumb-separator">/</li><li class="yotta-breadcrumb-item yotta-breadcrumb-redirect"><a href="/docs/" class="yotta-breadcrumb-link">帮助文档</a></li><li aria-hidden="true" class="yotta-breadcrumb-separator">/</li><li class="yotta-breadcrumb-item">日志易检索参考</li></ol></nav></span></div><div class="yotta-pageheader-operation"><a href="/docs/"><button type="button" class="yotta-button yotta-button-medium yotta-button-secondary css-l0t1eh"><span class="yotta-button-content"><span>返回</span></span></button></a></div></div></div></div><div class="css-63xlk0"><div class="css-cq4vr8"><div id="help"><div class="yw-content yw-help yw-content-with-subnav"><div class="page-content css-t84f6l"><div class="detail-content">
<div id="header">
<h1>日志易检索参考</h1>
<div class="details">
<span id="author" class="author">北京优特捷信息技术有限公司</span><br>
<span id="revnumber">version 4.1,</span>
<span id="revdate">2021-11-09</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_搜索命令简要描述">1. 搜索命令简要描述</a></li>
<li><a href="#_搜索命令类型">2. 搜索命令类型</a>
<ul class="sectlevel2">
<li><a href="#_按照执行阶段分类">2.1. 按照执行阶段分类</a>
<ul class="sectlevel3">
<li><a href="#_集中式命令">2.1.1. 集中式命令</a></li>
<li><a href="#_分布式命令">2.1.2. 分布式命令</a></li>
<li><a href="#_命令类型列表">2.1.3. 命令类型列表</a></li>
</ul>
</li>
<li><a href="#_按照功能分类">2.2. 按照功能分类</a>
<ul class="sectlevel3">
<li><a href="#_生成命令">2.2.1. 生成命令</a></li>
<li><a href="#_流式命令">2.2.2. 流式命令</a></li>
<li><a href="#_转换命令">2.2.3. 转换命令</a></li>
<li><a href="#_命令类型列表_2">2.2.4. 命令类型列表</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_搜索命令函数">3. 搜索命令函数</a>
<ul class="sectlevel2">
<li><a href="#_搜索命令函数参数说明补充">3.1. 搜索命令函数参数说明补充</a>
<ul class="sectlevel3">
<li><a href="#_printf函数的format参数类型">3.1.1. printf函数的format参数类型</a></li>
<li><a href="#_tonumber的参数类型">3.1.2. tonumber的参数类型</a></li>
<li><a href="#_in函数">3.1.3. in函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_与stats有关的函数">4. 与stats有关的函数</a></li>
<li><a href="#_常见的时间和时间格式">5. 常见的时间和时间格式</a>
<ul class="sectlevel2">
<li><a href="#_时间格式">5.1. 时间格式</a></li>
<li><a href="#_与搜索结合使用的时间修饰符">5.2. 与搜索结合使用的时间修饰符</a></li>
</ul>
</li>
<li><a href="#_检索指令">6. 检索指令</a>
<ul class="sectlevel2">
<li><a href="#_search">6.1. search</a></li>
<li><a href="#_multisearch">6.2. multisearch</a></li>
<li><a href="#_addinfo">6.3. addinfo</a></li>
<li><a href="#_append">6.4. append</a></li>
<li><a href="#_union">6.5. union</a></li>
<li><a href="#_appendcols">6.6. appendcols</a></li>
<li><a href="#_autoregress">6.7. autoregress</a></li>
<li><a href="#_bucket">6.8. bucket</a></li>
<li><a href="#_composite">6.9. composite</a></li>
<li><a href="#_chart">6.10. chart</a></li>
<li><a href="#_collect">6.11. collect</a></li>
<li><a href="#_correlation">6.12. correlation</a></li>
<li><a href="#_dbxexec">6.13. dbxexec</a></li>
<li><a href="#_dbxlookup">6.14. dbxlookup</a></li>
<li><a href="#_dbxoutput">6.15. dbxoutput</a></li>
<li><a href="#_dbxquery">6.16. dbxquery</a></li>
<li><a href="#_dedup">6.17. dedup</a></li>
<li><a href="#_delete">6.18. delete</a></li>
<li><a href="#_download">6.19. download</a></li>
<li><a href="#_esma">6.20. esma</a></li>
<li><a href="#_eval">6.21. eval</a></li>
<li><a href="#_eventstats">6.22. eventstats</a></li>
<li><a href="#_fields">6.23. fields</a></li>
<li><a href="#_filldown">6.24. filldown</a></li>
<li><a href="#_fillnull">6.25. fillnull</a></li>
<li><a href="#_foreach">6.26. foreach</a></li>
<li><a href="#_fromes">6.27. fromes</a></li>
<li><a href="#_fromkafkapy">6.28. fromkafkapy</a></li>
<li><a href="#_gentimes">6.29. gentimes</a></li>
<li><a href="#_geostats">6.30. geostats</a></li>
<li><a href="#_inputlookup">6.31. inputlookup</a></li>
<li><a href="#_iplocation">6.32. iplocation</a></li>
<li><a href="#_join">6.33. join</a></li>
<li><a href="#_jpath">6.34. jpath</a></li>
<li><a href="#_kvextract">6.35. kvextract</a></li>
<li><a href="#_ldapfetch">6.36. ldapfetch</a></li>
<li><a href="#_ldapfilter">6.37. ldapfilter</a></li>
<li><a href="#_ldapgroup">6.38. ldapgroup</a></li>
<li><a href="#_ldapsearch">6.39. ldapsearch</a></li>
<li><a href="#_ldaptestconnection">6.40. ldaptestconnection</a></li>
<li><a href="#_limit">6.41. limit</a></li>
<li><a href="#_head">6.42. head</a></li>
<li><a href="#_lookup">6.43. lookup</a></li>
<li><a href="#_lookup2">6.44. lookup2</a></li>
<li><a href="#_makecontinuous">6.45. makecontinuous</a></li>
<li><a href="#_makeresults">6.46. makeresults</a></li>
<li><a href="#_map">6.47. map</a></li>
<li><a href="#_movingavg">6.48. movingavg</a></li>
<li><a href="#_mvcombine">6.49. mvcombine</a></li>
<li><a href="#_mvexpand">6.50. mvexpand</a></li>
<li><a href="#_outputlookup">6.51. outputlookup</a></li>
<li><a href="#_parse">6.52. parse</a></li>
<li><a href="#_partition">6.53. partition</a></li>
<li><a href="#_rare">6.54. rare</a></li>
<li><a href="#_rename">6.55. rename</a></li>
<li><a href="#_rollingstd">6.56. rollingstd</a></li>
<li><a href="#_save">6.57. save</a></li>
<li><a href="#_sort">6.58. sort</a></li>
<li><a href="#_stats">6.59. stats</a></li>
<li><a href="#_streamstats">6.60. streamstats</a></li>
<li><a href="#_table">6.61. table</a></li>
<li><a href="#_timechart">6.62. timechart</a></li>
<li><a href="#_timewrap">6.63. timewrap</a></li>
<li><a href="#_top">6.64. top</a></li>
<li><a href="#_transaction">6.65. transaction</a></li>
<li><a href="#_transpose">6.66. transpose</a></li>
<li><a href="#_unpivot">6.67. unpivot</a></li>
<li><a href="#_where">6.68. where</a></li>
<li><a href="#_xpath">6.69. xpath</a></li>
<li><a href="#_replace">6.70. replace</a></li>
<li><a href="#_makemv">6.71. makemv</a></li>
<li><a href="#_localop">6.72. localop</a></li>
<li><a href="#_strcat">6.73. strcat</a></li>
<li><a href="#_loadjob">6.74. loadjob</a></li>
<li><a href="#_accum">6.75. accum</a></li>
<li><a href="#_untable">6.76. untable</a></li>
<li><a href="#_rest">6.77. rest</a></li>
<li><a href="#_typeahead">6.78. typeahead</a></li>
<li><a href="#_history">6.79. history</a></li>
<li><a href="#_addcoltotals">6.80. addcoltotals</a></li>
<li><a href="#_addtotals">6.81. addtotals</a></li>
<li><a href="#_multireport">6.82. multireport</a></li>
</ul>
</li>
<li><a href="#_spl中使用注释">7. SPL中使用注释</a></li>
<li><a href="#_logtail功能">8. Logtail功能</a></li>
<li><a href="#_download功能">9. Download功能</a></li>
<li><a href="#_搜索宏功能">10. 搜索宏功能</a></li>
<li><a href="#_高基功能flink">11. 高基功能(Flink)</a></li>
<li><a href="#_自定义命令功能">12. 自定义命令功能</a>
<ul class="sectlevel2">
<li><a href="#_摘要">12.1. 摘要：</a>
<ul class="sectlevel3">
<li><a href="#_自定义命令执行文件示例">12.1.1. 自定义命令执行文件示例：</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_搜索命令简要描述"><a class="anchor" href="#_搜索命令简要描述"></a><a class="link" href="#_搜索命令简要描述">1. 搜索命令简要描述</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">命令</th>
<th class="tableblock halign-left valign-top">描述</th>
<th class="tableblock halign-left valign-top">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定的搜索条件，或者作为过滤条件</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">host: localhost AND status: &gt;=200</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multisearch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">同时执行多个搜索，子查询只允许分布式流式命令</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | multisearch [[ status: 200 | eval tag=succ ]] [[ status: 404 | eval tag=err ]]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addinfo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向每个事件添加包含有关搜索的全局通用信息的字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | addinfo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">append</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将子管道的结果附加在主管道的结果之后</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | append [[ * | stats max(status) by appname ]]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">union</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">同时执行多个搜索，子查询可以用任意命令</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | union [[ * | stats max(status) by appname ]] [[ * | stats max(status) by tag ]]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appendcols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加一个子搜索，并将子搜索的结果按顺序合并到父搜索上</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | appendcols [[ * | stats min(timestamp)]]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">autoregress</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拷贝一个或者多个当前事件之前的事件中的字段值到当前事件</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | autoregress clientip p=1-2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">chart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">按照over字段进行分桶后的统计行为</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | chart sep="," format="$VAL**$AGG" limit=5 cont=false rendertype="pie" count(apache.x_forward) over apache.status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将查询的结果写到索引</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ |collect index=test marker="appname=\"test\", tag=\"tag1\""</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bucket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将连续的值放入离散集中</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | bucket timestamp span=1h as ts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dedup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对搜索结果中指定字段值的重复情况进行去重和过滤</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | dedup 3 apache.status, apache.geo.city</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">类似sql的连接，将来自远程数据库表的结果和子管道的结果连接在一起</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">| dbxlookup lookup="test1"<br>
<br>
| dbxlookup test1,test2 connection="179test" query="select * from test" on id=bid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxoutput</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将当前搜索的数据按照已配置的dbxoutput名称写出到远程数据库。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">| dbxoutput output="test1"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxquery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">是一个可以使用sql来查远程数据库的数据并作为spl的查询语句的命令</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">| dbxquery connection="179test" query="select * from test"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对某一个字段的未来值进行预测</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | esma latency timefield=ts period=7 futurecount=30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">计算表达式，并将表达式的值放入字段中，请参阅 搜索命令函数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval username = case(user_name, user)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eventstats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">提供统计信息，可以选择字段进行分组，并且将按照当前行所属于的分组的统计结果作为新的字段值添加在本行</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eventstats count() by logtype</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通过操作符保留或排除结果中的系列字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | fields status, clientip</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filldown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将某些字段的null值用之前最近的非null值进行填充，支持通配符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | filldown hostname app*</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fillnull</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将空值替换为指定值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | fillnull value="aaa" foo,bar</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentimes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可以生成指定时间范围内的时间戳</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">| gentimes start="2019-01-01:00:00:00" end="2019-01-04:00:00:00"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">geostats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可以基于地理位置信息，即经度和纬度进行分区域统计</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | geostats count(appname)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">inputlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可以读取csv文件</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">| inputlookup a.csv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">join</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">类似sql的连接，将来自主管道的结果和子管道的结果连接在一起</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | join type=left clientip [[ * | stats avg(resp_len) by clientip ]]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jpath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">类似xpath抽取json中的字段值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | jpath output=prices path="store.book[*].price"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kvextract</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将指定字段按键值对抽取</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | kvextract json.kvex</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回前n个结果</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | limit 10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">显示调用字段值查找</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | lookup email <a href="http://data.cn/user.csv&nbsp;on" class="bare">http://data.cn/user.csv&nbsp;on</a> id=userId</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lookup2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">显示调用指定方式查找</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | lookup2 external_file outputfields appname,hostname</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">makecontinuous</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在一定数值或时间范围内，根据给定的区间大小，对原始数据升序处理，并补充不连续的区间，区间的划分采用向前圆整的方式</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | makecontinuous time span=3 start=216 end=226</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">makeresults</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">构造指定的结果</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">| makeresults count=1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将前一个查询的结果用于下一个查询</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | map "apache.status:$apache.status$ | stats count()"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">movingavg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">计算移动平均值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | movingavg sum_len,10 as smooth_sum_len</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvexpand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">拆分多值字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | mvexpand iplist limit=100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvcombine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">合并指定字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | mvcombine sep="," ip</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nomv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将多值字段转换为单值字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | nomv delim="," a</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">outputlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">导出csv文件</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | outputlookup createempty=false overrideifempty=false maxresult=100 filename.csv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索时抽取字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | parse "(?&lt;ip_addr&gt;\d+\.\d+\.\d+\.\d+)"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">重新命名指定字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | rename apache.status as http_code</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rollingstd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">计算移动的标准差</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | rollingstd sum_resp_len, 10 as resp_len_rolling_std</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">save</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将搜索结果输出为外部文件</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | save /data/spldata/apahce_clientip.csv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">按照指定的字段对结果进行排序</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | sort by apache.status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">提供统计信息，可以选择按照字段分组</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | stats count() by apache.method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">streamstats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">连续统计</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | streamstats count() as cnt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将查询结果以表格形式展示，并对字段进行筛选</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | table apache.status, apache.method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timechart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对时间分桶进行统计查询</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | timechart limit=5 bins=10 minspan=1m span=10m max(x) as ma count() as cnt by apache.geo.city</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timewrap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对timechart命令的结果进行显示或者折叠</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | top 3 apache.clientip by apache.method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">top</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回指定字段top的值集合</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | top 3 apache.clientip by apache.method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回指定字段最少出现次数的值集合</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | rare apache.clientip by apache.method</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将结果分组成交易</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | transaction apache.clientip startswith="Android 4.3" endswith="AndroidPhone" maxopenevents = 10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">transpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将查询的表格结果进行行列转换</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | transpose row=apache.method column=apache.status valuefield=cnt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">where</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用表达式对结果进行过滤</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | where apache.status &lt; 200 &amp;&amp; apache.status&gt;400</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xpath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">提供对xml数据的处理和抽取</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | xpath input=json.xp output=lyly path="/purchases/book/title"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unpivot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">行转列转换</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | unpivot 10 header_field=count column_name=title</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段列表执行流式命令</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | foreach count* [[ eval &lt;&lt;FIELD&gt;&gt; = &lt;&lt;FIELD&gt;&gt; + 1 ]]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iplocation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从ip地址抽取地理信息</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | iplocation clientip</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">replace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用指定字符串替换字段值，可以指定一个或多个字段，仅替换指定字段的值，如果没有指定字段，则替换所有字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | replace "192.168.1.1" with "localhost"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">makemv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用分隔符或者带捕获组的正则表达式，将单值字段转换为多值字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | makemv delim="," testmv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">localop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localop命令强制随后的命令都在spl单机执行</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | localop</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strcat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">连接来自2个或更多字段的值。将字段值和指定字符串组合到一个新字段中</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval field1=\"10.192.1.1\",field2=\"192.168.1.1\" |strcat field1 \"abcd\" field2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadjob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">加载先前完成的定时任务或告警的执行结果。由ID 和type唯一确定一个任务。如果最近一次时间点的结果不存在，则临时运行原始查询。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | loadjob id=1,type="savedschedule"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">accum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对每个事件中为数字的指定字段进行逐次累加，得到的累加结果会放入该字段或者新字段中。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | accum apache.resp_len as sum_resp_len</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">untable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table指令的逆操作，使用该指令可以将表格的查看方式转换到事件列表的查看方式。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | untable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">调用日志易API，返回对应结果</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | rest /agentgroup/ apikey="user apikey" count=2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeahead</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回指定前缀的字段信息。返回的最大结果数取决于为size参数指定的值。typeahead命令可以以指定索引为目标，并受时间限制。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | typeahead prefix="app" size=5 index=yotta</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">history</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">查看搜索历史记录</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | history</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">correlation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">计算的与搜索结果相关性高的字段与字段值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | bucket timestamp ranges=0, 1000),(1000, 10000),(1000, 1753587702986 as ts| correlation bucket_field=ts|sort by correlation| sort by -ts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fromes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索指定索引的数据</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|fromes host=10.200.0.140 index=logs-my_app-default querydsl='{<br>
"query": {<br>
"match_all": { }<br>
}<br>
}'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fromkafkapy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">消费指定主题的数据</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">|fromkafkapy topic=test</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addcoltotals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在搜索结果集中添加汇总行</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | addcoltotals</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addtotals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">默认在搜索结果集中添加汇总列且列名为Total；同时可以在搜索结果中添加汇总行，可指定列名和行名，可指定求和行/列</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | addtotals col=true labelfield=products label="Quarterly Totals" fieldname="Product Totals"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multireport</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对同一数据流做不同的处理，最后汇聚输出</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | multireport [[</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">where _c%2==0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eval v=0]] [[</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where _c%2==1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_搜索命令类型"><a class="anchor" href="#_搜索命令类型"></a><a class="link" href="#_搜索命令类型">2. 搜索命令类型</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_按照执行阶段分类"><a class="anchor" href="#_按照执行阶段分类"></a><a class="link" href="#_按照执行阶段分类">2.1. 按照执行阶段分类</a></h3>
<div class="paragraph">
<p>命令的处理流程：当SPL模块接收到SPL搜索语句时，找到第一个出现的集中式命令，将之前的分布式命令下沉到引擎分布式处理，后半部分交由SPL集中式处理。</p>
</div>
<div class="sect3">
<h4 id="_集中式命令"><a class="anchor" href="#_集中式命令"></a><a class="link" href="#_集中式命令">2.1.1. 集中式命令</a></h4>
<div class="paragraph">
<p>集中式命令<strong>只能</strong>在SPL单机执行。</p>
</div>
</div>
<div class="sect3">
<h4 id="_分布式命令"><a class="anchor" href="#_分布式命令"></a><a class="link" href="#_分布式命令">2.1.2. 分布式命令</a></h4>
<div class="paragraph">
<p>分布式命令可以在引擎分布式执行，也可以在spl集中式执行。分布式命令使用了多机资源，性能更好。</p>
</div>
<div class="paragraph">
<p>分布式命令在不同位置执行模式有所不同，最终是否是分布式执行，由下面的规则决定：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>如果一个命令可分布式，并且之前的命令都是分布式执行的，那这个命令是分布式执行；</p>
</li>
<li>
<p>如果一个命令是集中式执行的，之后的命令都是集中式执行；</p>
</li>
<li>
<p><strong>query查询部分</strong>不能在spl执行，只能在引擎执行。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>例如 <code>* | eval …​ | parse …​</code> 中的eval，parse都是分布式执行。</p>
</div>
<div class="paragraph">
<p>例如 <code>* | transaction …​| eval …​ | parse …​</code> 中的transaction是集中式命令，所以eval，parse都是集中式执行。</p>
</div>
</div>
<div class="sect3">
<h4 id="_命令类型列表"><a class="anchor" href="#_命令类型列表"></a><a class="link" href="#_命令类型列表">2.1.3. 命令类型列表</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2">集中式命令</th>
<th class="tableblock halign-left valign-top">分布式命令命令</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">append</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addinfo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appendcols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">autoregress</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bucket</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">custom command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldaptestconnection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxoutput</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fields</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxquery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lookup2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fillnull</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dedup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreach</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">makecontinuous</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geostats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">download</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">makeresults</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">iplocation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">esma</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jpath</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eventstats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">movingavg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kvextract</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filldown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvcombine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parse</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentimes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvexpand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">inputlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outputlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">join</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rollingstd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">timechart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapfetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">save</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapfilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">streamstats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xpath</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapgroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rare</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldapsearch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">timewrap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rename</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">transpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">top</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unpivot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadjob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">history</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">localop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">untable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">makemv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fromes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addcoltotals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strcat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fromkafkapy</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeahead</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">correlation</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">history</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addtotals</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_按照功能分类"><a class="anchor" href="#_按照功能分类"></a><a class="link" href="#_按照功能分类">2.2. 按照功能分类</a></h3>
<div class="paragraph">
<p>SPL的搜索命令类型有下面几种</p>
</div>
<div class="ulist">
<ul>
<li>
<p>生成命令</p>
</li>
<li>
<p>流式命令</p>
</li>
<li>
<p>转换命令</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_生成命令"><a class="anchor" href="#_生成命令"></a><a class="link" href="#_生成命令">2.2.1. 生成命令</a></h4>
<div class="paragraph">
<p>生成数据的命令，用于产生数据，通常是命令或者子命令的第一个命令。</p>
</div>
</div>
<div class="sect3">
<h4 id="_流式命令"><a class="anchor" href="#_流式命令"></a><a class="link" href="#_流式命令">2.2.2. 流式命令</a></h4>
<div class="paragraph">
<p>流式命令对数据一行一行处理，处理一行产生一行结果。</p>
</div>
<div class="paragraph">
<p>分布式流式命令是可以分布式执行的流式命令，对数据一行一行处理，处理一行产生一行结果，不依赖全局顺序和上下行的命令，比如eval，parse。</p>
</div>
<div class="paragraph">
<p>集中式流式命令，也对数据一行一行处理，和分布式流式命令区别在，依赖输入数据的顺序，比如autoregress，filldown。</p>
</div>
<div class="paragraph">
<p>还有一些集中式流式命令是暂时只在SPL实现的，不在引擎执行的命令，具体参考命令类型列表。</p>
</div>
</div>
<div class="sect3">
<h4 id="_转换命令"><a class="anchor" href="#_转换命令"></a><a class="link" href="#_转换命令">2.2.3. 转换命令</a></h4>
<div class="paragraph">
<p>把输入命令作为一个整体来处理， 需要所有数据才能产生结果，比如transpose，dedup。这类命令在SPL执行，不可分布式执行。</p>
</div>
</div>
<div class="sect3">
<h4 id="_命令类型列表_2"><a class="anchor" href="#_命令类型列表_2"></a><a class="link" href="#_命令类型列表_2">2.2.4. 命令类型列表</a></h4>
<div class="paragraph">
<p>以下是搜索命令的类型，支持分布式命令有特殊说明，否则是集中式的。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">生成命令</th>
<th class="tableblock halign-left valign-top">流式命令</th>
<th class="tableblock halign-left valign-top">转换命令</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">search</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addinfo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">multisearch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">append</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxoutput</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">union</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">appendcols</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dedup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentimes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bucket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">esma</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">inputlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">collect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eventstats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">makeresults</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxlookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geostats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dbxquery</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">makecontinuous</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">history</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">map</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">loadjob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">filldown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvcombine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fillnull</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">outputlookup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeahead</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">foreach</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rare</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fromes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">head</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">save</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fromkafkapy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">iplocation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">join</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stats</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jpath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">timechart</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kvextract</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">timewrap</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">top</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lookup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">transpose</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lookup2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unpivot</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">movingavg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">correlation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvexpand</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nomv</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parse</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rename</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replace</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">rollingstd</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">streamstats</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">table</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">transaction</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">where</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xpath</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">makemv</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">localop</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strcat</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accum</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">untable</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addcoltotals</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_搜索命令函数"><a class="anchor" href="#_搜索命令函数"></a><a class="link" href="#_搜索命令函数">3. 搜索命令函数</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">函数</th>
<th class="tableblock halign-left valign-top">描述</th>
<th class="tableblock halign-left valign-top">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">abs(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数获取一个数字X，并返回其绝对值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回absv，该变量的值为数值字段value的绝对值：<br>
…​ | eval absv = abs(value)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exp(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数获取一个数字X，并返回e的X次方</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回y，该变量的值为e的3次方：<br>
…​ | eval y = exp(3)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ln(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数获取一个数字X，并返回X的自然对数（以e为底）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回y，该变量的值为bytes的自然对数：<br>
…​ | eval lnBytes = ln(bytes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">empty(x)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断某个field是否为空。也可写作isempty(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">empty(field)<br>
如果存在返回false，否则返回true。也可写作isempty(field)<br>
比如：<br>
empty(apache.status)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">case(X, "Y", …​， [default, Z])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数会获取X, Y的参数对，X参数必须为布尔表达式，如果结果为true，则返回响应的Y的值，如果计算结果均为false, 则返回default对应的值，default部分为可选，不指定default，则default的返回为空值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回http状态代码的描述<br>
…​ | eval desc = case(error == 200, "OK", error == 500, "Internal Server Error ", default, "Unexpected error")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ceil(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数返回X向上取整的整数值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回n = 5<br>
…​ | eval n = ceil(4.1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cidrmatch(X, Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字段X必须是无分类和子网地址扩展(CIDR)，字段Y为一个IP地址，判断IP地址Y的子网地址是否和X匹配</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：<br>
…​| eval matched = cidrmatch("192.168.1.130/25", "192.168.1.129")'<br>
将192.168.1.130转换为二进制并保留高位的25位，低位设为0得到下限（不包括），对应的ip为192.168.1.128<br>
将192.168.1.130转换为二进制保留高位的25位，低位全部设置为1得到上限（不包括），对应的ip地址为192.168.1.255<br>
因此ip的范围是(192.168.1.128, 192.168.1.255)<br>
凡落在此范围的ip地址均match成功，因此matched的值为true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">coalesce(X, …​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受任意数量的并返回第一个不为空值的值，如果所有参数都是空值，则返回空值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">假设有一部分日志，用户名字段放在user_name或者user字段里，以下示例定义名为username的字段，该字段值为user_name和user字段不是空值的那一个：<br>
…​ | eval username = coalesce(user_name, user)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">floor(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数向下取整为最接近的整数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回 n = 4<br>
…​ | eval n = floor(4.1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">format(FORMAT, [X…​])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">格式化字符串, 提供类似printf的功能<br>
FORMAT，为printf函数的format字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：<br>
format("%.1fMB", rate)输出速率，rate保留小数点后一位<br>
format("%s ⇒ %s", "aa", "bb")输入"aa ⇒ bb"<br>
NOTE: 变量类型和format中%x需要对应正确，否则可能导致计算失败，而输出空值</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatdate(X[, Y])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数对X对应UTC时间值格式化为Y具体的时间格式<br>
Y的时间格式字符串遵循java.text.SimpleDateFormat支持的格式，如果不指定Y，则默认的时间格式为"yyyy-MM-dd HH:mm:ss.SSS"，暂不支持时区的自定义</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回timestamp所表示的时间的小时和分钟<br>
…​ | eval v = formatdate(timestamp, "HH:mm")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">datetime_diff(X, Y[, Z])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接受两个时间戳，返回两个时间戳之间的时间差，单位为毫秒。可以指定返回的时间单位，d=天,h=小时,m=分钟,s=秒,默认为ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回1655870082000-1655870081000的时间差，单位为毫秒<br>
…​ | eval v = datetime_diff(1655870081000, 1655870082000)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">if(X, Y, Z)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数接受3个参数，第一个X为布尔表达式，如果X的计算结果为true，则结果为第二个参数Y的值，否则返回第三个参数Z值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将检查status的值，如果status==200，则返回”OK”，否则返回Error<br>
…​ | eval desc = if (status == 200, "OK", "Error")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">in(field, X, …​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">给定一个字段和若干指定值，判断字段中的值是否在指定值中存在。存在返回true，不存在返回false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：…​ | eval field = 'appname' | where in(field, 'appname', 'hostname')</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">isnum(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断字段X是否为数值类型，对于整数类型或者浮点型结果都会返回true，其它返回false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：<br>
…​ | eval a = isnum(apache.status)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">isstr(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断字段X是否为字符串类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​| eval a = isstr(apache.method)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">len(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数接收一个字符串类型的参数，返回字符串的长度</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">如果method的字段值为GET，以下示例n的值为3<br>
…​ | eval n = len(method)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">log(X [,Y])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个或两个数值类型的值，返回以Y为底X的对数，Y默认为10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回以2为底，number的对数<br>
…​ | eval num=log(number,2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pi()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数返回pi的值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回圆的面积<br>
…​ | eval area_circle=pi()*pow(radius,2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pow(X, Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受两个数值类型的参数，返回X的Y次方</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">假设number的值为2，以下示例将返回8<br>
…​ | eval n=pow(number,3)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sqrt(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回X的平方根</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">假设number的值为4，以下示例将返回2<br>
…​ | eval n=sqrt(number)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">acos(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个范围在(-1,1)之间的数值类型的参数，返回以弧度表示的X的反余弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的反余弦值<br>
…​ | eval result = acos(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">acosh(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个大于等于1的数值类型的参数，返回以弧度表示的X的反双曲余弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回1的反双曲余弦值<br>
…​ | eval result = acosh(1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">asin(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个范围在[-1,1]之间的数值类型的参数，返回以弧度表示的X的反正弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的反正弦值<br>
…​ | eval result = asin(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">asinh(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的反双曲正弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回5的反双曲正弦值<br>
…​ | eval result = asinh(5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">atan(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个范围在 [-pi/2,+pi/2] 之间的数值类型的参数，返回以弧度表示的X的反正切值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0.5的反正切值<br>
…​ | eval result = atan(0.5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">atan2(Y, X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受两个数值类型的参数，返回以弧度表示的 Y/X 的反正切值，X的取值范围在 [-pi,+pi]之间</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0.5，0.75的反正切值<br>
…​ | eval result = atan2(0.5, 0.75)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">atanh(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个范围为(-1,1)之间的数值类型的参数，返回以弧度表示的X的反双曲正切值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0.5的反双曲正切值<br>
…​ | eval result = atanh(0.5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cos(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的余弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的余弦值<br>
…​ | eval result = cos(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cosh(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的双曲余弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的双曲余弦值<br>
…​ | eval result = cosh(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hypot(X, Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受两个数值类型的参数，返回欧几里得范数，即sqrt(X^2 + Y^2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回2，2的欧几里得范数<br>
…​ | eval result = hypot(2,2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sin(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的正弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的正弦值<br>
…​ | eval result = sin(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sinh(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的双曲正弦值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的双曲正弦值<br>
…​ | eval result = sinh(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tan(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的正切值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的正切值<br>
…​ | eval result = tan(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tanh(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个数值类型的参数，返回以弧度表示的X的双曲正切值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回0的双曲正切值<br>
…​ | eval result = tanh(0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entropy(field)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数计算指定字段的熵值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回json.name的熵值<br>
…​ | eval e = entropy(json.name)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lower(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受一个字符串类型的参数，返回其小写形式</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">假设method的值为GET，以下示例将返回”get”<br>
…​ | eval lowerstr = lower(method)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">match(X, Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数将使用正则表达式Y对X进行匹配，返回是否匹配成功</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">当且仅当字段于IP地址的基本形式匹配时，则返回true，否则返回false，这里使用了^和$表示执行完全匹配<br>
…​ | eval matched = match(ip, "^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contains(X,Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数会判断字符串X的值与字符串Y进行匹配，返回是否匹配成功,Y可以是多值字符串，Y是多值的情况下，包含Y中的任意一个则返回true，否则返回false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下实例将返回 true …​|eval a = split("a,b,c,e",",")|eval b = "Hello,world!" |eval c = contains(b,a)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max(X,…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受至少一个数值类型的参数，返回值较大的那个值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回101<br>
…​ | eval maxv = max(101, 100.0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">min(X,…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受至少一个数值类型的参数，返回较小的那个值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回 100.0<br>
…​ | eval minv = min(101, 100.0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvsum(X,…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受至少一个数值类型的多值字段或单值字段做为参数，返回所有参数的总和</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回多值字段multiv的值与2的总和<br>
…​ | eval v = mvsum(multiv, 2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvavg(X,…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接受至少一个数值类型的多值字段或单值字段做为参数，返回所有参数的平均值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例将返回多值字段multiv的值与2的平均值,多值字段的每个值都会使计算平均值的分母加1<br>
…​ | eval v = mvavg(multiv, 2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvappend(X,…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数为任意个参数，参数可以为字符串，多值字段，或者单值字段等</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval v=mvappend(initv, "middle")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvcount(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数只有一个参数X，如果X是多值字段，则返回多值字段的值个数，如果是单值字段，则返回1，其他返回0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval c=mvcount(mvfield)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvdedup(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接收一个多值参数X，返回字段值消重后的多值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval v=mvdedup(mvfield)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvfilter(X, filterexpr)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X为类型为多值的参数，filterexpr为过滤条件表达式，其中使用_x描述X中的单个值<br>
对mv多值字段进行过滤，仅保留1a的值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvfilter(mv, _x == "1a")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvfind(X,V)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X为多值类型的参数，V表示需要查找的值，如果找到返回对应下表，否则返回-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval n=mvfind(mymvfield, "err")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvindex(X,start[, end])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X为多值类型的参数，如果无end参数，则返回下表为start的元素，如果start不合法则返回null，否则返回从下标start到下标end（不包括）元素组成列表，如果下表范围不合法返回空数组，<br>
NOTE: 数组下表从0开始</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval v = mvindex(mv, 10, -1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvjoin(X,DELIMITER)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将多值字段X的值使用分隔符DELEMITER组成一个字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">eval v = mvjoin(mv, ", ")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvmap(X,mapexpr)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X为多值类型，mapexpr为转换的表达式，使用_x表示X中的单个值，返回的多值类型为X中的每个元素使用mapexpr转换得到的值组成的多值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval x = mvmap(X, tolong(_x) + 2)<br>
设X = ["1", "3", "4"]<br>
则x = [3, 5, 6]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvdelta(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X为多值类型，该函数按顺序计算当前的值与前一个值的差,写入一个新的多值字段中，返回新的多值字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval x = mvdelta(X)<br>
设X = ["1", "3", "4"]<br>
则x = [2, 1]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvrange(X,Y[,Z])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数使用一个数值的区间生成一个多值字段，其中X表示区间起始值，Y表示区间结束值（不包括），Z表示步跳数，默认为1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">下例返回 1, 3, 5, 7.<br>
…​ | eval mv=mvrange(1,8,2)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvsort(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对多值字段进行排序</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">…​ | eval s=mvsort(mv)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvszip(X,Y[,"Z"])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X和Y都为多值类型，将X中的第一个元素和Y中的第一个元素都转换为字符串，并以Z为分隔符进行拼接，得到返回结果多值结果的第一个元素，类型为字符串，然后按照同样方法对X的第二个元素和Y中的第二个元素进行拼接，以此类推得到一个多值的结果。如果X和Y的长度不等，则当X或者Y处理完最后一个元素后不再进行拼接。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X = [1, 3, 4, 7]<br>
Y = [2, 5, 8]<br>
mvszip(X, Y) = ["1,2", "3,5", "4,8"]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">split(S, SEP)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X为字符串类型，使用字符串SEP分割符对S进行拆分成多值类型，如果SEP为空字符串，则S将被拆分为单字组成的多值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">如X = ":abc::edf: "<br>
则split(X, ":") = ["", "abc", "", "edf", " "]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">now()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数用于表示当前时间，实际值为搜索请求收到的时间，在一个请求中多次调用返回的是同一个值，值为1970-01-01:00:00:00到当前时间的毫秒数，类型为long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​|eval current_time = now()</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parsedate(X, Y[, Z])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">解析日期时间串为unix时间戳<br>
X为日期的字符串，Y为日期的格式说明，遵循java.text.SimpleDateFormat支持的时间格式，Z为可选参数，指定Locale，默认为en（english）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：<br>
parsedate("Thu 28/04/2016:12:01:01""EEE dd/MM/yyyy:HH:mm:ss")其中EEE或者E表示星期几;parsedate("28/四月/2016", "dd/MMM/yyyy", "zh")其中zh表示中文的Locale;parsedate("2017-January-01", "yyyy-MMMM-dd", "UTC", "en")其中UTC代表时区，en表示英文的Locale</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">printf(FORMAT, [X…​])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">格式化字符串(格式)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例: printf("%.1fMB", rate)输出速率，rate保留小数点后一位<br>
printf(“%s ⇒ %s", "aa", "bb")输入"aa ⇒ bb"<br>
NOTE: 变量类型和printf中%x需要对应正确，否则可能导致计算失败，⽽输出空值</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">relative_time(X, Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字段X必须是时间类型，字段Y必须为一个date math(请参考时间格式一节)的相对时间值，返回基于时间戳X的date math的计算结果</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：<br>
…​ | eval ts = relative_time(timestamp, "-1d/d")<br>
返回得到timestamp所代表的时间减去1天的毫秒数，并圆整到0点，即timestamp表示的日期的前一天的零点。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">round(X [,Y])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">把数值X近似到小数点后Y位;Y参数默认值为0，即近似为整数(round会把X近似为“最近的值”;当距离相同时，近似为更⼤的值)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例: round(3.14)输出3;<br>
round(3.1415,3)输出3.142;<br>
注:当round(-1.5)输出-1;round(1.5)输出2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">substring(X, Y[, Z])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数接收三个参数，其中X必须为字符串，Y和Z是数字（Y和Z从0开始），返回X的子字符串，返回X的第Y个字符到第Z个（不包括）字符之间的字符 ，如果不指定Z则返回Y位置开始的剩余字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回"bce"<br>
…​ | eval subs = substring("abcedfg", 1, 4)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">todouble(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接受一个参数，可以是字符串或者数值型，返回对应的双浮点数的值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回123.1<br>
…​ | eval value = todouble("123.1")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber(numStr[, base])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将数字或字符串转化为数值类型，并可将2-36进制转换为10进制，base默认为10进制</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tolong(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接受一个参数，字符串或者数值类型，返回对应的long值，X为10进制</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回123<br>
…​ | eval value=tolong("123")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tostring(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接收一个参数，可以是字符串或者数值类型，返回对应的字符串的值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回”123.1”<br>
…​ | eval strv = tostring(123.1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tojson(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接收一个任意类型的参数，返回对应的 json 字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">假设 a = [1,2,3],那么 "[1,2,3]" 是命令 …​|eval json_str = tojson(a)的结果</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">trim(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接受一个字符串类型的参数，返回X前后去除空白符的字符串值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回" bcd ef"<br>
…​ | eval strv = trim("  bcd ef   \t")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ltrim(X[, Y])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接受一个字符串类型的参数，返回X去除左边空白符的字符串值。或者接收两个字符串类型的参数,用Y字符串从左侧去除在Y中出现过的字符,直到遇到第一个不在Y中的字符为止。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回"yi"<br>
…​ | eval strv = ltrim("rizhiyi", "irhz")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rtrim(X[, Y])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该函数接受一个字符串类型的参数，返回X去除右边空白符的字符串值。或者接收两个字符串类型的参数,用Y字符串从右侧去除在Y中出现过的字符,直到遇到第一个不在Y中的字符为止。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回"rizhiy"<br>
…​ | eval strv = rtrim("rizhiyi", "irhz")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">replace(&lt;str&gt;,&lt;regex&gt;,&lt;replacement&gt;)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数用replacement字符串替换字符串str中每次出现的regex。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例会将月份和日期数字调换位置。如果输入为 1/14/2020 ，则返回值为 14/1/2020。<br>
…​ | eval n=replace(date, "^(\d{1,2})/(\d{1,2})/", "\2/\1/")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">typeof(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取字段X的类型<br>
支持类型为: long, double, int, float, short, string, object, array, bool<br>
如果字段为null，则返回null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例：<br>
…​ | eval a_type = typeof(apache.method)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数接收一个字符串类型的参数，返回X的大写形式</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回GET<br>
…​ | eval strv = upper("Get")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">urlencode(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段X的值执行URL编码，字段X必须为字符串<br>
NOTE: 目前还不支持指定字符编码</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval url = urlencode(url)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">urldecode(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段X的值执行URL解码，字段X必须为字符串<br>
NOTE: 目前还不支持指定字符编码</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval url = urldecode(url)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">base64encode(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段X的值执行base64编码，字段X必须为字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval base64 = base64encode(base64)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">base64decode(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段X的值执行base64解码，字段X必须为字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval base64 = base64decode(base64)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unicodeencode(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段X的值执行unicode编码，字段X必须为字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval unicode = unicodeencode(unicode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unicodedecode(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段X的值执行unicode解码，字段X必须为字符串</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval unicode = unicodedecode(unicode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">md5(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段进行MD5编码</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval a = md5(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sha1(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段进行SHA1编码</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval a = sha1(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sha256(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段进行SHA256编码</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval a = sha256(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sha512(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对字段进行SHA512编码</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval a = sha512(X)&nbsp;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip2long(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将ip地址转化为long类型的数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval ipNum = ip2long(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long2ip(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将long类型的数字转化为ip地址</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval ip = long2ip(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cidr2long(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将cidr路由转化为两个long类型的ip起止数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval ip_range = cidr2long(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">is_valid_mac(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为有效的mac地址，目前只支持六组冒号或横杠分隔的地址</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_valid_mac = is_valid_mac(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">is_valid_ip(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为有效的ip地址</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_valid_ip = is_valid_ip(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">is_valid_mask(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为有效的子网掩码，在[0, 32]之间</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_valid_mask = is_valid_mask(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">is_valid_cidr(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为有效的cidr地址</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_valid_cidr = is_valid_cidr(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expand_ip_range_to_cidr(X, Y [,Z])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将两个ip起止地址转化为cidr地址，X为ip起始地址，Y为ip终止地址，Z为可选参数cleanSingleIps，如果是true代表mask是32的cidr会去掉mask，否则不去掉，默认为false。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval cidr = expand_ip_range_to_cidr("192.168.1.1", "192.168.1.15")<br>
; 或 …​ | eval cidr = expand_ip_range_to_cidr("192.168.1.1", "192.168.1.15", true)<br>
…​ | eval cidr = expand_ip_to_cidr(X)<br>
; 或 …​ | eval cidr = expand_ip_to_cidr(X, true)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">like(X, Y)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">接收两个参数，X为一个字符串，Y是一个表达式。当X与Y匹配时，此函数返回true,否则返回false。表达式Y支持精确文本匹配，以及单字符_和多字符%匹配。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_like = like(X, "a%bc")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">isnotnull(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否不为null。当X不为null时，返回true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_not_null = isnotnull(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">isblank(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为null或仅包含空白字符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_blank = isblank(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">islong(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为long类型字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_long = islong(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">isbool(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">判断是否为boolean类型字段</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例:<br>
…​ | eval is_bool = isbool(X)</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_搜索命令函数参数说明补充"><a class="anchor" href="#_搜索命令函数参数说明补充"></a><a class="link" href="#_搜索命令函数参数说明补充">3.1. 搜索命令函数参数说明补充</a></h3>
<div class="sect3">
<h4 id="_printf函数的format参数类型"><a class="anchor" href="#_printf函数的format参数类型"></a><a class="link" href="#_printf函数的format参数类型">3.1.1. printf函数的format参数类型</a></h4>
<div class="paragraph">
<p>由若干个转译字符（例如，整数d，字符串s，科学技术法g）组成，每个转义字符前可以包含可选项;（例如，flag字符，指明宽度精度）；"(%[flags][width][.precision]&lt;conversion_specifier&gt;)…​"</p>
</div>
<div class="paragraph">
<p>转译字符：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">参数类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'b','B'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean变量</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">根据boolean参数输出true或false, "printf("%b",1==0.5+0.5), 输出 "true"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'s','S'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符串,输出string类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">内容与参数相同,printf("%s","spl"),输出"spl"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'d'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将参数格式化为十进制整数输出,printf("%d",10),输出10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'o</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将参数格式化为八进制整数输出,printf("%d",8),输出10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'x','X'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将参数格式化为十六进制整数输出,printf("%d",16),输出10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'e','E'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数或浮点数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将参数格式化为科学记数法输出,printf("%d",1248),输出1.248e3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'f'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">浮点数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输出参数的浮点数值&nbsp;,printf("%d", round(pi(),2)),输出3.14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'a','A'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">浮点数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">参数格式化为十六进制浮点数输出,printf("%a",3.1415),输出 0x1.921cac083126fp1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'%'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">百分号转译符,printf("%%"),输出%</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>指定结果格式字符：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">描述</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'-'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">结果左对齐（默认右对齐）</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'#'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输出结果展示格式，例如printf("%#x",123) → 0x7b</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'+'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">结构总是包含符号</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">' '</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">正数结果前有一个空格</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'0'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">结果用0补齐精度和宽度</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_tonumber的参数类型"><a class="anchor" href="#_tonumber的参数类型"></a><a class="link" href="#_tonumber的参数类型">3.1.2. tonumber的参数类型</a></h4>
<div class="paragraph">
<p>`tonumber(numStr)`语法：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">numStr类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">描述</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">结果</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number类型 - 数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是数值类型的数字，则原样返回该数字。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number类型的数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber(123) = 123</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String类型 - 基本类型（int, long, float, double)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是基本类型数字字符串，则返回对应数字。（输入不支持L大小写表示的long值和f大小写表示的float值）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">基本类型对应数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber("123") = 123;  tonumber("12345678910123456") = 12345678910123456L;  tonumber("1.23") = 1.23f;  tonumber("1.23456789") = 1.23456789</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String类型 - 超长</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是超长整数或小数位数大于15位的数字，返回约等值。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">约等值，可能会以科学计数法表示。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber("12345678901234567890") = 12345678901234567000;  tonumber("1.12345678901234567890") = 1.1234567890123457</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String类型 - 负数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是负数字符串，返回负数。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">负数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber("-123") = -123;tonumber("-1.23") = -1.23f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String类型 - 科学计数法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是科学计数法表示的数字字符串，返回是对应的数值。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对应数值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber("1.234567890123e+12") = 1234567890123L</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">表达式</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是表达式，返回是表达式结果对应的数值。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对应结果数值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber(23 + 2) = 25;tonumber("23" + 2) = 232</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>`tonumber(numStr, base)`语法：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">numStr类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">base范围</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">描述</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">结果</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数 – Number类型 | String类型（int, long）（包括负数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2-36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是2-36进制的数值类型的整数数字或数字字符串，返回转换为10进制后的整数数字。（输入不支持L大小写表示的long值，16进制支持0x开头字符串且字母大小写都支持）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number类型的整数数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber(123, 10) = 123;tonumber(123, 16) = 291;tonumber("123", 10) = 123;<br>
tonumber("1010", 2) = 10;<br>
tonumber("0xb5", 16) = 181;<br>
tonumber("-123", 10) = -123;<br>
tonumber("-123", 16) = -291</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">小数 - Number类型 | String类型（float, double）（包括负数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是10进制的数值类型的小数或小数字符串，才可返回该小数。（输入不支持f大小写表示的float值）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number类型的小数数字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber(1.23, 10) = 1.23f;<br>
tonumber("1.23", 10) = 1.23f;<br>
tonumber("1.23456789", 10) = 1.23456789;<br>
tonumber("-1.23", 10) = -1.23f</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">超长</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2-36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是超长整数或小数位数大于15位的数字字符串，能解析成功就返回正常值，解析不成功不返回，结果超长返回约等值。（如果是小数字符串，只支持10进制）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">正常值 | 约等值 | 无值，可能会以科学计数法表示。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber("11111111111111111111", 10)= 11111111111111110000;<br>
tonumber("11111111111111111111", 2) = 1048575;<br>
tonumber("1.11111111111111", 10) = 1.11111111111111;<br>
tonumber("1.11111111111111111", 10) = 1.11111111111111112</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">科学计数法</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是科学计数法表示的数字字符串，返回是对应的数值。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对应数值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber("1.12345e+5", 10) = 112345;<br>
tonumber("1.234567890123e-3", 10) = 0.001234567890123</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">表达式</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2-36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">输入是表达式，返回是表达式结果对应的数值。（如果结果是小数，只支持10进制）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对应结果数值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tonumber(2.3 + 2, 10) = 4.3</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_in函数"><a class="anchor" href="#_in函数"></a><a class="link" href="#_in函数">3.1.3. in函数</a></h4>
<div class="paragraph">
<p>in函数支持多种写法:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>WHERE命令：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>（1）... | where in(field, V1, V2, ...)
（2）... | where field in(V1, V2, ...)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>EVAL命令：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>（1）... | eval is_in = in(field, V1, V2, ...)
（2）... | eval is_in = if(in(field, V1, V2, ...), true, false)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>详情:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V系列</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">描述</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">单值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">若干指定值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">如果field的值和V系列若干值中的任意一个相等，则返回true；否则，返回false。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">field = 1 → in(field, 1, 2) = true;<br>
<br>
field = 5 → in(field, 1, 2) = false;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">多值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">若干指定值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">如果field列表中的任一值和V系列人若干值中的任一值相等，则返回true；否则，返回false。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">field = [1,10,100] → in(field, 1, 2) = true;<br>
<br>
field = [1,10,100] → in(field, 11, 22) = false;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">单值或多值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">无</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">如果V系列没有设置值，则都返回false;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">field = 1 → in(field) = false;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">单值或多值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">包含字段名</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">如果V系列中包含字段名，则使用字段值。其余规则同第一条。<br>
<br>
如果V系列中包含的字段名对应的也是多值，则不会平铺，按照列表比较。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">field = "1", value = "1" → in(field, value, "2") = true;<br>
<br>
field = ["1", "10", "100"], value = ["1", "11", "111"] → in(field, value) = false;<br>
<br>
field = ["1", "10", "100"], value = ["1", "10", "100"] → in(field, value) = true;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">单值或多值（数字）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">若干指定值（数字）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">field和V系列是数字类型时，按值比较，相等即返回true，否则，返回false。（in和long，float和double）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">field = 1L → in(field, 1, 2) = true;<br>
<br>
field = 1.5f → in(field, 1.5, 2.5) = true;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_与stats有关的函数"><a class="anchor" href="#_与stats有关的函数"></a><a class="link" href="#_与stats有关的函数">4. 与stats有关的函数</a><a id="stats_function"></a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>eval &lt;expression&gt;介绍</strong>：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>可以在通常使用&lt;field&gt;的统计函数中使用eval &lt;expression&gt;，此时<strong>必须</strong>使用 <code>as newName</code>。</p>
</li>
<li>
<p><code>| stats func(eval(&lt;expression&gt;)) as newName</code> 等同于 <code>| eval temp_field = &lt;expression&gt; | stats func(temp_field) as newName</code>.</p>
</li>
<li>
<p>唯一的特殊情况，当统计函数为count(), 且expression结果为<strong>bool</strong>类型时，统计当结果仅为当expression为<strong>true</strong>的事件数。<br>
例如：<code>…​ | stats count(eval(status="404")) AS count_status BY sourcetype</code>, 统计的结果为status为404的事件总数。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>以下是可与stats等命令使用的统计函数，后续将扩展到其他的命令。约定</strong>：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"X" 表示指定字段名， +</p>
</li>
<li>
<p>"INTERVAL"表示指定时间间隔，描述方式如1m, 1d… 后缀有以下几种：y|M|w|d|h|m|s ， +</p>
</li>
<li>
<p>"LIMIT"表示返回值的限制数量。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>分类</strong>：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>single函数：<br>
avg、count、distinct_count / estdc / dc、distinct、earliest、first、last、latest、max、min、rate、stddev、sum、sumsq、var</p>
</li>
<li>
<p>multi函数：extend_stat / es、percentiles / pct、percentile_ranks / pct_ranks、skewness、kurtosis、covariance、correlation</p>
</li>
<li>
<p>画图函数：date_histogram / dhg、histogram / hg、range_bucket / rb、sparkline</p>
</li>
<li>
<p>其他：…​…​</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">函数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">功能描述</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">avg(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的平均值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回平均响应时间：<br>
avg(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">count[(X)]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的出现次数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回status的个数：<br>
count(status)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date_histogram(X, INTERVAL)<br>
dhg(X, INTERVAL)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">时间直方图统计，可以认为是直方图统计的一种特殊形式</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">把timestamp字段以1h分桶统计：<br>
dhg(timestamp, 1h)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">distinct(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的值去重后的的个数的<strong>精准值</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段clientip的唯一值值的个数的精确值：<br>
distinct(clientip)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">distinct_count(X)<br>
estdc(X)<br>
dc(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的值去重后的个数的<strong>估计值</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回clientip的唯一值值的个数的估计值：<br>
dc(clientip)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">earliest(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X按照<strong>时间增序</strong>排序后的第一个值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回appname字段按照时间增序排序后的第一个值：<br>
earliest(appname)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extend_stat(X)<br>
es(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的es扩展统计。<br>
es将返回多个值，将返回如下字段：<br>
_es.X.count<br>
_es.X.min<br>
_es.X.max<br>
_es.X.avg<br>
_es.X.sum<br>
_es.X.sum_of_squares<br>
_es.X.variance<br>
_es.X.std_deviation +</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回resp_len字段的es统计值：<br>
es(resp_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">first(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回数据中字段X的第一个出现的值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回第一个appname的值：<br>
first(appname)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">histogram(X, INTERVAL)<br>
hg(X, INTERVAL)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">直方图统计。<br>
字段X必须为<strong>整数类型</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">把apache.status以200分桶统计：<br>
hg(apache.status, 200)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">last(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的最后一个出现的值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回数据中最后一个appname的值：<br>
last(appname)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">latest(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X按照<strong>时间增序</strong>排序后的最后一个值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回数据中的appname字段按照时间增序排序后的最后一个值：<br>
latest(appname)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">list(X,[LIMIT])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将字段X的值组合成列表返回。<br>
LIMIT为值列表中值的个数上限，默认值为100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回数据中appname出现的前90个值：<br>
*|stats list(appname,90)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mad(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数将统计指定字段的绝对中位差(MAD)值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回响应时间的绝对中位差(MAD)值:<br>
stats mad(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的最大值<br>
字段X必须为数值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的最大值：<br>
max(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">min(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的最小值<br>
字段X必须为数值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的最小值：<br>
min(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">percentiles(X, Y1, Y2…​)<br>
pct(X, Y1, Y2…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的值排序后，百分位Y1, Y2所对应的字段值。<br>
pct将返回多个值，字段命名方式如下：<br>
Y1对应的字段为_pct.X.Y1<br>
Y2对应的字段为_pct.X.Y2<br>
…​…​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回response_time在50%，75%, 95%分位的值：<br>
pct(response_time, 50, 75, 95)<br>
将返回三个字段：<br>
_pct.response_time.50,<br>
_pct.response_time.75,<br>
_pct.response_time.95</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">percentile_ranks(X, Y1, Y2…​)<br>
pct_ranks(X, Y1, Y2…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回Y1，Y2所对应的百分位。<br>
X： 数值类型字段;<br>
Y1，Y2： 为字段X对应的值<br>
pct_ranks将返回多个值，字段命名方式如下：<br>
_pct_ranks.X.Y1<br>
_pct_ranks.X.Y2<br>
…​</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回100， 200， 500在response_time字段中对应的百分位：<br>
pct_ranks(response_time, 100, 200, 500)<br>
返回字段集合<br>
_pct_ranks.response_time.100<br>
_pct_ranks.response_time.200<br>
_pct_ranks.response_time.500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">range_bucket(RANGE_BUCKET, RANGE_BUCKET…​)<br>
rb(RANGE_BUCKET, RANGE_BUCKET…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X：为<strong>数值类型</strong><br>
RANGE_BUCKET：统计区间，表示为(start, end)。可以设置多个。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例把apache.status以指定区间分桶统计：<br>
rb(apache.status,(100,200) , (200,300), (300,400))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rate(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数将统计在指定时间跨度内指定字段值的变化速率。<br>
具体计算方法：(latest - earliest) / (latestT - earliestT)<br>
latest为字段X按照时间增序排序后的最后一个值<br>
earliest为字段X按照时间增序排序后的第一个值<br>
latestT为latest对应的timestamp<br>
earliestT为earliest对应的timestamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回数据中apache.resp_len值的变化速率：<br>
*|stats rate(apache.resp_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sparkline(agg(X), INTERVAL)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">按照指定区间分桶，通过面积图展示每个分桶内统计数据。<br>
agg：部分与stats有关的函数，支持所有的<strong>single函数</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回按1h分桶，按tag分类后，apache.resp_len的平均值对应的面积图：<br>
stats sparkline(avg(apache.resp_len), 1h) by tag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stddev(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">统计字段X的标准差<br>
字段X必须为数值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的标准差：<br>
stats stddev(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sum(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X的值的和<br>
字段X必须为数值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应长度的和：<br>
sum(response_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sumsq(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">统计字段X的平方和<br>
字段X必须为数值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的平方和：<br>
stats sumsq(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">signify(X,[LIMIT])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回指定字段中有趣或不寻常的字段值的集合，并按照重要性排序。 字段值的重要性取决于score的大小。<br>
<br>
示例：<br>
用户在文本中搜索“禽流感”时提示“H5N1”；<br>
发现欺诈性医生诊断出的鞭伤伤害超过了他们的公平份额；<br>
发现爆胎次数不成比例的轮胎制造商。<br>
<br>
在所有这些情况下，所选择的术语不仅仅是一组中最流行的术语。 它们是在前景和背景集之间测量的流行度发生显着变化的术语。 如果术语“H5N1”仅存在于 1000 万个文档索引中的 5 个文档中，但在构成用户搜索结果的 100 个文档中的 4 个中找到，这些文档很重要并且可能与他们的搜索非常相关。 5/10,000,000 对 4/100 是一个很大的频率摆动。<br>
<br>
打分的原理是根据foregroundPercent(目标术语在前景集所占的百分比)与backgroundPercen(目标术语在背景集所占的百分比)计算得分，<br>
前景集：与查询直接匹配的搜索结果；<br>
背景集：从中检索它们的索引；<br>
目标术语：用户感兴趣的、重要的术语 重要术语聚合的任务是比较这些集合并找到最常与用户查询关联的术语。<br>
<br>
LIMIT默认值为10。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回目标字段appname对应的值中最重要的10个。此例中appname为前景集，query语句查询的内容为背景集，返回的结果为目标术语。<br>
*|stats signify(appname,10)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">top(X, LIMIT)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">此函数统计字段X内最多出现的若干个值 +</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回apache.status使用最多的三个值及其对应使用的次数：<br>
top(apache.status, 3)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">values(X,[LIMIT])</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X<strong>去重</strong>后的值。<br>
LIMIT默认值为100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">以下示例返回数据中appname出现的前90个不重复的值：<br>
*|stats values(appname,90)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">var(X)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">统计字段X的方差<br>
字段X必须为数值类型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的方差：<br>
stats var(response_time)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">skewness(X1, X2…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X1, X2…​的偏度，字段X1, X2…​必须为数值类型，该函数支持多字段。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的偏度：<br>
stats skewness(response_time)<br>
返回响应时间和响应长度的偏度：<br>
stats skewness(response_time, response_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kurtosis(X1, X2…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X1, X2…​的峰度，字段X1, X2…​必须为数值类型，该函数支持多字段。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间的峰度：<br>
stats kurtosis(response_time)<br>
返回响应时间和响应长度的峰度：<br>
stats kurtosis(response_time, response_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">covariance(X1, X2…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X1, X2…​的协方差，字段X1, X2…​必须为数值类型，该函数需要至少两个字段。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间和响应长度的协方差：<br>
stats covariance(response_time, response_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">correlation(X1, X2…​)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回字段X1, X2…​的相关系数，字段X1, X2…​必须为数值类型，该函数需要至少两个字段。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回响应时间和响应长度的相关系数：<br>
stats correlation(response_time, response_len)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">derivative(X,T)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">统计桶间的字段X根据时间字段T的变化速率<br>
具体计算方法：(currentX - previousX) / (currentT - previousT)<br>
currentX为当前桶的字段X<br>
previousX为上一个桶的字段X<br>
currentT为当前桶的时间字段T <br>
previousT为上一个桶的时间字段T</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回当前桶和上一个桶的指定字段值的变化速率<br>
streamstats derivative(value, ts)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_常见的时间和时间格式"><a class="anchor" href="#_常见的时间和时间格式"></a><a class="link" href="#_常见的时间和时间格式">5. 常见的时间和时间格式</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_时间格式"><a class="anchor" href="#_时间格式"></a><a class="link" href="#_时间格式">5.1. 时间格式</a></h3>
<div class="paragraph">
<p>日期和时间格式可以通过时间和日期的模式字符串来指定。日期和时间的模式字符串中，未转义的字符A-Z以及a-z将被解释一个模式字符，用于表示日期和时间字符串的组成部分。文本可以通过使用单引号括起来避免被解释，双单引号则用于表示单个单引号。其他的任何字符都不会被解释，将直接被输出到目标的日期和时间字符串。</p>
</div>
<div class="paragraph">
<p>以下列出定义的模式字符（所有其他A-Z和a-z之间的字符暂时被保留）</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. formatdate函数的时间格式</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字符</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日期和时间的组成部分</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">描述</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">示例</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Era Designator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文本</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ad  (公元)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Centry of era(&gt;=0)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Year of ear(&gt;=0)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1996</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Week year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1996</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Week of year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day of week</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day of week</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuesday; Tue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Year（年）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Year(年)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1996；96</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Month in year（月份）</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Month(月份)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">July，Jul，07</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Week in month(当月第几周)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day in year (当年第几天)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">190</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day in month (当月第几天)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Halfday of day</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PM, AM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hour of halfday(0-11)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clockhour of halfday(1-12)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hour in day (0-23)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">k</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hour in day (1-24)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hour in am/pm (0-11)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minute in hour (0-59)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Second in minute (0-59)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">59</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">S</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Millisecond(毫秒)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">988</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通用时区</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFC 822时区</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-0800；+0800</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escape for text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-08；-0800； -08:00</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>模式字符大多是多个重复出现，出现的个数可精确表示其形式</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Text: 如果模式字符的个数大于等于4，将输出完整的形式，如果小于4且存在可用的简写形式，则输出简写形式</p>
</li>
<li>
<p>Number：模式字符的个数表示输出格式最少的数字个数，如果模式字符的个数大于实际输出的数字个数，则采用0进行填充，比如模式为MM，而实际月份为1月，则输出01</p>
</li>
<li>
<p>Month：如果模式字符个数大于3，则月份将使用文本形式，否则使用数字形式，如MMM输出为Jul，MMMM则输出July</p>
</li>
<li>
<p>Year：</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>如果模式字符个数为2，year将输出为2个数字，比如09，16</p>
</li>
<li>
<p>如果模式字符个数为4，year将被输出为4个字符，比如2009，2016</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. 常用的时间和日期格式示例</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">时间日期模式</th>
<th class="tableblock halign-left valign-top">时间和日期</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"G yyyy-MM-dd HH:mm:ss"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AD 2016-01-01 12:03:01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"EEE, d/MMM/yy"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wed, 4/Jul/01</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"EEEE,dd/MMMM/yyyyy HH:mm:ss Z"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuesday,03/July/02001 12:03:01 -0700</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_与搜索结合使用的时间修饰符"><a class="anchor" href="#_与搜索结合使用的时间修饰符"></a><a class="link" href="#_与搜索结合使用的时间修饰符">5.2. 与搜索结合使用的时间修饰符</a></h3>
<div class="paragraph">
<p>你可以使用时间修饰符来自定义搜索的时间范围，比如说，可以指定搜索的开始时间和结束时间</p>
</div>
<div class="paragraph">
<p>绝对时间修饰符</p>
</div>
<div class="paragraph">
<p>绝对时间由日期和时间组成，格式如下:</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>yyyy-MM-dd:HH:mm:ss</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>示例1：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>2015-01-02:12:33:21</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>注意日期和时间之间有冒号</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>相对时间修饰符</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可使用表示时间量(整数和单位)和对齐到时间单位（可选）的字符串在搜索中定义相对时间。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>" [now]((+|-)&lt;time_integer&gt;&lt;time_unit&gt;(/&lt;time_unit&gt;)?)*"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>在字符串的前面机上加号(+)和减号(-)表示与当前时间的偏移</p>
</li>
<li>
<p>使用数字和单位定义时间量；支持的时间单位为：</p>
<div class="ulist">
<ul>
<li>
<p>秒：  s、sec、secs、second、seconds</p>
</li>
<li>
<p>分钟：m、min、mins、minute、minutes</p>
</li>
<li>
<p>小时：h、H、hr、hrs、hour、hours</p>
</li>
<li>
<p>天：  d、day、days</p>
</li>
<li>
<p>周：  w、week、weeks</p>
</li>
<li>
<p>月：  M、mon、month、months</p>
</li>
<li>
<p>季度：q、qtr、qtrs、quarter、quarters</p>
</li>
<li>
<p>年：  y、year、years</p>
</li>
<li>
<p>交易日：t</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>交易日计算：</p>
<div class="ulist">
<ul>
<li>
<p>如果用户搜索-1t，用户并没有提供对应的交易日列表，则报错提示找不到该domain的交易日信息。</p>
</li>
<li>
<p>如果用户搜索-1t，用户提供的交易日范围大于1t的话则返回正常的交易日对应的自然日日期。</p>
</li>
<li>
<p>如果用户搜索-10t，用户提供的只到-3t的话就返回-3t对应的时间戳并提示交易日计算异常。</p>
</li>
<li>
<p>-1t/t的作用就是找到当天交易日，计算出当天交易日的零点；也就是-1t/d的作用</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>示例1： "-2d/d"</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>前天的零点零分零秒</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>示例2： "now-1M/M-1d/w"</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>当前时间减去一个月，取整到月，再减去一天，按周取整，具体表示上上个月的最后一周的开始</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>示例3： "now"</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>当前时间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_检索指令"><a class="anchor" href="#_检索指令"></a><a class="link" href="#_检索指令">6. 检索指令</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_search"><a class="anchor" href="#_search"></a><a class="link" href="#_search">6.1. search</a></h3>
<div class="paragraph">
<p>search命令的query参数描述对原始日志的搜索条件，在第一个管道前边时从索引取数据，不需要加命令名字，在管道之后位置相当于where</p>
</div>
<div class="paragraph">
<p>语法：  这里采用类似巴克斯范式描述</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[index=&lt;index&gt;] [starttime=&lt;time-modifier&gt;] [endtime=&lt;time-modifier&gt;] [now=&lt;time-modifier&gt;] &lt;query&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>&lt;query&gt;: :  &lt;or-clause&gt; (OR &lt;or-clause&gt;)*</p>
</div>
<div class="paragraph">
<p>&lt;or-clause&gt;: : &lt;and-clause&gt; (AND &lt;and-clause&gt;)*</p>
</div>
<div class="paragraph">
<p>&lt;and-clause&gt;: :  "(" &lt;query&gt; ")" | NOT &lt;query-term&gt; |&lt;query-term&gt;</p>
</div>
<div class="paragraph">
<p>&lt;query-term&gt;: : [&lt;field&gt;:] &lt;term&gt; | &lt;sub-pipe&gt;</p>
</div>
<div class="paragraph">
<p>&lt;sub-pipe&gt;: :  "[[" &lt;pipe-commands&gt; "]]"</p>
</div>
<div class="paragraph">
<p>&lt;term&gt;: : &lt;simple-term&gt;|&lt;wild-term&gt;|&lt;prefix-term&gt;|&lt;regex-term&gt;|&lt;range&gt;</p>
</div>
<div class="paragraph">
<p>语法单元解释：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>index</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定所需搜索的索引，目前支持schedule, yotta，默认为yotta</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>index=schedule</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>starttime</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;time-modifier&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>格式请参考时间修饰符一节，表示搜索的时间区间的开始，包括该时间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>starttime=2018-09-01</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>endtime:</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;time-modifier&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>格式请参考时间修饰符一节，表示搜索的时间区间的结束，不包括该时间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>endtime=2018-09-01</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>如果query中指定了starttime和endtime，则使用该时间区间，忽略页面中指定的时间区间。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>now:</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;time-modifier&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>格式请参考时间修饰符一节，表示搜索的时间区间的结束，不包括该时间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>now=2018-09-01</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>如果指定了now，并且starttime和endtime中有相对时间，则starttime和endtime的绝对时间是基于now来计算的，如果now是相对时间，则now是先基于当前时间计算出now的绝对时间，然后基于now的绝对时间再计算出starttime以及endtime。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>query-term</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[&lt;field&gt;:]&lt;term&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>field部分为可选，如果不写field，则默认field为raw_message，支持通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>term:</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;pharse-term&gt; | &lt;wild-term&gt; | &lt;regex-term&gt; | &lt;range&gt; | &lt;simple-term&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定某个字段中的查询条件，支持通配符，正则表达式，range，短语查询</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数：</p>
<div class="ulist">
<ul>
<li>
<p>phrase-term</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>"&lt;string&gt;"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>放在双引号内的查询表示短语查询
示例："http://rizhiyi.com/"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>wild-term:</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>通配符查询，查询中的?表示匹配单个字符，*表示匹配多个字符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>这里不支持指定标点符号及特殊字符的匹配，例如qu-*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>qu?ck*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>regex-term:</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>/&lt;string&gt;/</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>正则表示式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>name: /joh?n(ath[oa]n)/</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>range:</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>( [ | { ) &lt;value&gt; TO &lt;value&gt; (} | ])</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用中括号和大括号来描述一个range，中括号表示包含，大括号表示不包含，&lt;value&gt;可以是数值或者字符串，也可以使用&gt;=这种写法</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>count值在1到5之间，包括1和5。其写法为：count: [1 TO 5] 或者 count: &gt;=1 AND count: ⇐5</p>
</li>
<li>
<p>count值大于等于10。其写法为：count: [10 TO *] 或者 count: &gt;= 10</p>
</li>
<li>
<p>年龄小于10。其写法为：age: &lt;10</p>
</li>
<li>
<p>年龄小于等于10。其写法为：age: ⇐ 10</p>
</li>
<li>
<p>年龄大于10。其写法为：age: &gt;10</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>simple-term:</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>string</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>不包含在双引号中的字符串，保留字符需要转义</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>保留字符</strong></p>
</div>
<div class="paragraph">
<p>如果你在query中包含以下保留字符，则需要进行转义：使用反斜杠转义</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>+ - = &amp;&amp; || &gt; &lt; ! ( ) { } [ ] ^ " ~ * ? : \ / |</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>由于空格是query各个部分的分割符，如果query包含空格请使用反斜杠转</p>
</div>
<div class="paragraph">
<p><strong>多索引查询的支持</strong></p>
</div>
<div class="paragraph">
<p>1.通配符支持</p>
</div>
<div class="paragraph">
<p>指定index的时候，支持通配符*号和?号</p>
</div>
<div class="ulist">
<ul>
<li>
<p>示例1：index=mai* ERROR | …​</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>在所有mai为前缀的索引返回包含ERROR关键字的日志，比如main，mail索引等等</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例2：index=* &nbsp;ERROR</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>    不会查询schedule索引
   &nbsp; &nbsp;
* 示例3：index=*,schedule ERROR</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>则查询schedule索引（内置索引）和其他用户索引索引</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>如果指定的索引包含通配符，是不会尝试匹配内置索引的（schedule等），如果希望查询schedule索引，必须明确指定schedule索引</p>
</li>
<li>
<p>由于搜索页面仅显示部分数据，所以我们指定在返回非统计查询的的最大返回结果数为1000用于页面展示，如果需要查看全量数据，请下载当次搜索的数据查看，其对应的配置项为query.max_result_count</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>2.多个索引的支持</p>
</div>
<div class="paragraph">
<p>逗号分割的索引列表，不要包含空格</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>index=apache,nginx ERROR | ...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>在apache和nginx的索引中返回包含ERROR关键字的日志</p>
</div>
<div class="paragraph">
<p>3.多个query的支持</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>(index=apache starttime="now/d" endtime = "now"upstream_time:&gt;300) OR ( index=nginx starttime="-1d/d" endtime="now/d" upstream_time:&gt;200)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>apache索引中搜索今天upstream_time大于300的日志，以及nginx索引中搜索昨天upstream:&gt;200的日志</p>
</div>
<div class="ulist">
<ul>
<li>
<p>示例1： logtype为apache，并且apache.req_time大于0.05秒</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>( host: localhost OR host: 127.0.0.1 ) OR apache.req_time: &gt;0.05 | ...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例2：ip地址以10.开头，或者192.开头的所有ip</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ip: 10.* OR ip:192.* | ...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例3：搜索schedule索引，昨天一整天的数据，schedule_name为hour_logsize</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>index=schedule starttime="-1d/d" endtime="now/d" schedule_name:hour_logsize</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例4: 搜索所有数据，相当于 *</p>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> | search *</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例5: 过滤appname字段=apache的日志</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> ... | search appname:apache</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>示例6: 过滤以name结尾的字段=apache的日志</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[source,bash]
 ... | search *name:apache</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_multisearch"><a class="anchor" href="#_multisearch"></a><a class="link" href="#_multisearch">6.2. multisearch</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>同时执行多个搜索，把搜索结果合并起来。需要至少两个子查询</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>multisearch [[ &lt;subsearch&gt; ]] [[ &lt;subsearch&gt; ]]...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>subsearch</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;sub-pipeline&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子查询，支持管道分隔的分布式流式命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 1. 示例1</div>
<div class="content">
<div class="paragraph">
<p>同时搜索yotta索引里appname是apache的日志，和metric索引里appname是json的日志，并提取出来同名的clientip字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> | multisearch [[ _index:yotta appname:apache | eval clientip=apache.clientip ]] [[ _index:metric appname:json | eval clientip=json.sourceip  ]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_addinfo"><a class="anchor" href="#_addinfo"></a><a class="link" href="#_addinfo">6.3. addinfo</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>向每个事件添加包含有关搜索的全局通用信息的字段，如下表所示：</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字段名</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">含义</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info_min_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索时间范围的起始时间</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info_max_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索时间范围的结束时间</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info_sid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">事件所属搜索任务的sid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">info_search_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">事件所属搜索任务的运行时间</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>addinfo</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="exampleblock">
<div class="title">Example 2. 示例：</div>
<div class="content">
<div class="paragraph">
<p>取搜索结果第一条添加上全局通用信息的字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | limit 1 | addinfo</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/addinfo-1.png" alt="addinfo 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_append"><a class="anchor" href="#_append"></a><a class="link" href="#_append">6.4. append</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>append命令允许通过将子管道命令的结果附加在主管道之后，达到合并两个管道结果的目的</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>append &lt;sub-pipeline&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sub-pipeline</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;结果的列表&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子查询 SPL 语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 3. 示例：</div>
<div class="content">
<div class="paragraph">
<p>分别统计大前天和昨天的响应消息长度的平均值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> starttime="-3d/d" endtime="-2d/d" * | stats avg(apache.resp_len) | eval day="the day before yesterday" | append [[ starttime="-1d/d" endtime="now/d" * | stats avg(apache.resp_len) | eval day="yesterday" ]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>主管道统计大前天的平均响应长度，append命令中子管道统计昨天的平均值，其结果合并在一张结果的表中</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-035258.858.png" alt="Image 140318 035258.858">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_union"><a class="anchor" href="#_union"></a><a class="link" href="#_union">6.5. union</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>同时执行多个搜索，把搜索结果合并起来。需要至少两个子查询。可以分布式执行命令的命令相当于multisearch命令，其他命令相当于append命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>union [[ &lt;sub-pipeline&gt; ]] [[ &lt;sub-pipeline&gt; ]]...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sub-pipeline</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;sub-pipe&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子查询，支持管道分隔的命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 4. 示例1</div>
<div class="content">
<div class="paragraph">
<p>同时搜索yotta索引里appname是apache的日志，和metric索引里appname是json的日志，并提取出来同名的clientip字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> | union [[ _index:yotta appname:apache | eval clientip=apache.clientip ]] [[ _index:metric appname:json | eval clientip=json.sourceip  ]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 5. 示例2</div>
<div class="content">
<div class="paragraph">
<p>分别统计yotta索引和metric索引里的结果数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> | union [[ _index:yotta | stats count() | eval index="yotta" ]] [[ _index:metric | stats count() | eval index="metric" ]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_appendcols"><a class="anchor" href="#_appendcols"></a><a class="link" href="#_appendcols">6.6. appendcols</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>添加一个子搜索，并将子搜索的结果按顺序合并到父搜索上</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>appendcols param-options* [[ subsearch ]]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;override&gt; | &lt;maxout&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>override</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>override = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子搜索中的同名字段是否覆盖父搜索的字段值，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxout</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxout = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子搜索的最大返回条数，默认为50000</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>subsearch</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;sub-pipeline&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子查询语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>如上的maxout参数值有上限值，默认为200000；对应的配置项为 appendcols.max_out_limit</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 6. 示例：</div>
<div class="content">
<div class="paragraph">
<p>查询2019-12-04日至2019-12-06日的结果并且将该时间范围统计出来的count数追加到第一行结果中</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | appendcols override=false maxout=10 [[ * | stats count() as cnt]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/appendcols-1.png" alt="appendcols 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_autoregress"><a class="anchor" href="#_autoregress"></a><a class="link" href="#_autoregress">6.7. autoregress</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将当前事件之前的事件中的字段值拷贝到当前事件，该字段可以用于后续的表达式计算等。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>autoregress &lt;field&gt;[ as &lt;as-field&gt; ] p=&lt;num&gt;|&lt;num&gt;-&lt;num&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>事件中需要拷贝的字段，大多情况下是数值字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>p</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>p=&lt;number&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示当前事件之前的那些事件的字段将被拷贝到当前事件，可以指定为单个数字或者数字的范围，如果指定为单个数字，比如p=3，当前事件之前的第三条事件的字段将被拷贝，如果指定为数字的范围，比如p=2-4，则表示当前事件之前的第四条到第二条事件都将被拷贝到当前事件，并采用一定的命名规则命名。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>仅当p指定为单个数字的时候，as-field表示目标的字段名，否则目标字段名为&lt;field&gt;_p&lt;num&gt;这种形式，比如p=2-3，则产生两个新的字段名: &lt;field&gt;_p2, &lt;field&gt;_p3</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 7. 示例</div>
<div class="content">
<div class="paragraph">
<p>按小时统计事件数，并计算出当前小时和上个小时的事件数变化比率</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | bucket timestamp span=1h as ts | stats count() as count_ by ts | autoregress count_ as last_count  p=1 |eval a=(last_count - count_)/count_ | eval change_rate = format("%.3f%%", (last_count - count_)*100/count_)</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-040000.522.png" alt="Image 140318 040000.522">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bucket"><a class="anchor" href="#_bucket"></a><a class="link" href="#_bucket">6.8. bucket</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将字段中连续的数字值，放入离散集的数据桶中，该变量可用于后续的stats等命令的分组字段中</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>bucket &lt;field&gt; &lt;bucketing-option&gt; [as &lt;field&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bucket-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>span | ranges | timeranges</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>离散化选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>bucket-span</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>span = &lt;span-length&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用基于时间或者绝对数值的长度设置每个数据桶的大小</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>span-length</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;[&lt;timeunit&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>每个数据桶的跨度，第一个数字为系数，如果提供了timeunit，这将被视为时间范 围，否则这是一个绝对数值的桶的跨度</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>timeunit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>s | m | h | d | w | M</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>时间单位，分别表示秒，分钟，小时，天，周，月（更多扩展写法详见小节'与搜索结合使用的修饰符')</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>bucket-timeranges</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeranges = &lt;time-ranges&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用时间修饰符指定一组时间的区间，ranges也通过左闭右开的区间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>date_ranges</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>( ([MIN], &lt;time&gt;), (&lt;time&gt;, &lt;time&gt;)*, (&lt;time&gt;, [MAX]) )</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>time</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;date&gt;|&lt;datetime&gt;|&lt;string&gt;|&lt;date-relative&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>date</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>\d{4}-\d{2}-\d{2}</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>datetime</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;date&gt;:\d{2}:\d{2}:\d{2}</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>date-relative</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>-&lt;span-length&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>span-length</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;[&lt;timeunit&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>每个数据桶的跨度，第一个数字为系数，如果提供了timeunit，这将被视为时间范 围，否则这是一个绝对数值的桶的跨度</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>timeunit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>s | m | h | d | w | M | y</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>时间单位，分别表示秒，分钟，小时，天，周，月，年</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>bucket-ranges</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ranges = &lt;number-ranges&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>通过数值对来指定一组range，MIN表示最小值，MAX为最大值，均为可选，所 有的range均为左闭右开的区间，形式化的描述为[&lt;number&gt;, &lt;number&gt;]，包括第一个值，但小于第二个值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>number-ranges</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>( ([MIN], &lt;number&gt;), (&lt;number&gt;, &lt;number&gt;)*, (&lt;number&gt;, [MAX]))</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用时间修饰符指定一组时间的区间，ranges也通过左闭右开的区间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定一个字段名称, 如果未指定，则使用原始字段名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 8. 示例1</div>
<div class="content">
<div class="paragraph">
<p>返回每1小时跨度内的每个hostname的apache.resp_len的平均值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | bucket timestamp span=1h as ts | stats avg(apache.resp_len) by hostname, ts | eval ts_human = formatdate(ts)</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-040407.599.png" alt="Image 140318 040407.599">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 9. 示例2</div>
<div class="content">
<div class="paragraph">
<p>返回apache.status为100-200， 200-400， 400以上的apache.status的个数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | bucket apache.status ranges=((100, 200), (200, 400), (400,)) as rs | stats count(apache.status) by rs</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-040434.515.png" alt="Image 140318 040434.515">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_composite"><a class="anchor" href="#_composite"></a><a class="link" href="#_composite">6.9. composite</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>优化版的stats，一定情况下可减少部分内存使用，使用方法完全相同。与stats的性能对比：无byField时，与stats相同；单byField时，增加少量时间消耗；多byField时，增加少量时间消耗，减少部分内存使用。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | list | values | top | es | dhg | hg | pct | pct_ranks | rb | sparkline | mad</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>每个stats_function都可以定义输出字段名，否则对后续的计算不可见</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>stats_function</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | mad</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与stats命令结合的函数，请参考[#与stats有关的函数]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组字段，所有的stats_func将在分组内统计</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 10. 示例1</div>
<div class="content">
<div class="paragraph">
<p>统计state和pid的组合的事件数量</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:json | composite count() by json.state, json.pid</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/composite-1.png" alt="composite 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_chart"><a class="anchor" href="#_chart"></a><a class="link" href="#_chart">6.10. chart</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>按照over字段进行分桶后的统计行为</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>chart [&lt;chart-params&gt;]* &lt;stats-single-value-func&gt; [&lt;stats-single-value-func&gt;]* [over &lt;field&gt; &lt;chart-over-params&gt;*] [by &lt;field&gt; &lt;chart-by-params&gt;*]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stats-single-value-func-as</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | mad | top</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于统计的函数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>chart-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[sep=&lt;string&gt;] | [format=&lt;string&gt;] | [cont=&lt;bool&gt;] | [limit=&lt;int&gt;] | [rendertype=&lt;string&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>sep</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>sep=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示by field和统计字段组合时的分隔符，默认值为":"。这里默认的顺序为统计字段+分隔符+byfield，如果想改变顺序，请使用下面format参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示规定字段的组合分隔符和组合顺序，默认值为"$AGG:$VAL"。 在这个字段中用$AGG表示统计字段，$VAL表示by field的值，所以一般的写法是format="$AGG$VAL"，此时为字段分隔符，如果想改变组合顺序，可将$VAL和$AGG的顺序反过来，分隔符仍需置于中间位置</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>cont</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>cont=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示是否将不连续的时间桶补充为连续，默认为false。因为将时间按照一定的时间间隔进行分桶时，有些桶内可能没有日志或者时间落入桶，此时桶内的所有统计值都为0。默认情况下会将这些桶所在的行去掉，如果置为true则会将这些行补充到结果中。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示限制使用by field值的个数，默认值为无穷大。即若语句中有 max count avg三种统计函数，by field有10种值，那么在不限制limit的情况下将有3*10+1个字段，即结果中有31列。若limit=5，那么将只取byfield的前5个值与统计字段进行组合，结果就只有3*5+1=16列，结果中也将只有这些列的值。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>rendertype</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rendertype=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可选值：pie(环形图)，rose(玫瑰图)，bar(条形图)，sunburst(旭日图)，sankey(桑基图)，force(力图)，chord(和弦图)，heatmap(热力地图)，wordcloud(词云图)。维度图包含：pie，rose，bar。可同时有over和by字段，或只有任一字段。当同时有两个字段时，会将over的字段与by平铺的字段拼接绘图展示（sunburst除外，只能有两个字段，直接层级展示）；关系图包含：sankey，force，chord。必须同时有over和by字段，over为来源字段，by为目的字段；其他：heatmap，wordcloud。只能有over或by其中一个字段，做切分使用</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>chart-over-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[bins=&lt;int&gt;] | [span=&lt;SPAN&gt;] | [startindex=&lt;int&gt;] | [endindex=&lt;int&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>span-str</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>span=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示分桶间隔，格式为数字或数字+单位，与bucket指令span参数的格式相同，单位可以是 s | m | h | d | M（更多扩展写法详见小节'与搜索结合使用的修饰符')</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>bins</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>bins=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示最多有多少个桶，默认值100。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>startindex</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>startindex=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为0，表示从所有桶中的第几个桶开始取，前面的桶对应的行将被舍弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>endindex</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>endindex=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为无穷大，表示取到所有桶中的第几个桶，后面的桶对应的行将被舍弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>chart-by-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[bins=&lt;int&gt;] | [span=&lt;SPAN&gt;] | [startindex=&lt;int&gt;] | [endindex=&lt;int&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>bins</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>bins=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示最多有多少个桶，默认值100。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>span</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>span=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示分桶间隔，格式为数字或数字+单位，与bucket指令span参数的格式相同</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>startindex</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>startindex=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为0，表示从所有桶中的第几个桶开始取，前面的桶对应的行将被舍弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>endindex</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>endindex=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为无穷大，表示取到所有桶中的第几个桶，后面的桶对应的行将被舍弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于chart支持按照多个字段进行分组,所以这里会与stats命令中的by字段有同样的限制，详情见stats命令的NOTE中的group.size以及stats.oneby.group_size配置项</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 11. 示例1</div>
<div class="content">
<div class="paragraph">
<p>字段分割符为**，组合顺序为byfield值+分隔符+统计字段，限制byfield值为5个进行组合，桶最大个数为10个，分桶为1小时一个，按照agent_send_timestamp进行分组后的结果，collector_recv_timestamp分组间隔为50s，最多分为20个桶，取第四到第六个桶值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | chart sep="," format="$VAL**$AGG" limit=5 cont=true count() over agent_send_timestamp bins=10 span="1h" by collector_recv_timestamp span="50s" bins=20 startindex=4 endindex=7</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-040982.542.png" alt="Image 140318 040982.542">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 12. 示例2</div>
<div class="content">
<div class="paragraph">
<p>字段分割符为**，组合顺序为byfield值+分隔符+统计字段，限制byfield值为5个进行组合，按照apache.status进行分组后的结果统计apache.x_forward的次数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | chart sep="," format="$VAL**$AGG" limit=5 cont=false rendertype="pie" count(apache.x_forward) over apache.status</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-040982.543.png" alt="Image 140318 040982.543">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collect"><a class="anchor" href="#_collect"></a><a class="link" href="#_collect">6.11. collect</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将查询的结果写到索引，需要有运行collect命令的权限</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>collect index=&lt;field&gt; [marker="&lt;key&gt;=&lt;value&gt;, &lt;key&gt;=&lt;value&gt; ..."] [testmode=&lt;bool&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>index</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>index=&lt;field&gt;|&lt;double-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要写入的索引名。索引在"路由配置"中查看和添加。索引必须存在，当前用户必须有索引写权限</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>marker</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>marker=&lt;key&gt;=&lt;value&gt;, &lt;key&gt;=&lt;value&gt; ...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>写入结果中追加对键值对。kv格式的键值对，kv键值对，k和v用等号(=)分隔，kv对儿之间用逗号(,)分隔</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>testmode</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>testmode=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否是用test模式运行，test模式不写入索引，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 13. 示例</div>
<div class="content">
<div class="paragraph">
<p>把搜索的结果写入test索引，修改appname为test，tag为tag1</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">*|collect index=test marker="appname=\"test\", tag=\"tag1\""</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/collect-1.png" alt="collect 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_correlation"><a class="anchor" href="#_correlation"></a><a class="link" href="#_correlation">6.12. correlation</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>按照bucket指定的分桶方式，计算搜索结果如arr_all=[100,3213,421]和每个字段对应的每个值的统计值如arr_k1_v1=[31,1030,123]，再根据pearson算法计算两个数组的相关性，保留每个字段的相关性最高的值，并给出范围在[-1, 1]之间的相关性得分</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>correlation &lt;bucket-field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bucket-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>bucket_field = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>参数值为使用bucket命令的range参数指定分桶信息的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>excludeone</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>excludeone = &lt;boolean&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为true。当background dataset与命中数据在指定的分桶上的结果相同且唯一时，相关性结果为1，指定该参数为true时，过滤这样的结果。例如，`status:error`为bg dataset，`status:error appname:SPL`, 如果appname只有一个值为value时，该结果就可以被过滤</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 14. 示例1</div>
<div class="content">
<div class="paragraph">
<p>按照bucket指定的分桶，查询与状态为error的相关性高的字段与对应的字段值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">error
| where !isnull(json.duration)
| bucket json.duration ranges=((0,500),(500,1000),(1000,20000),(20000,40000),(40000,60000),(60000,80000),(80000,100000),(100000,200000),(200000,400000),(400000,600000),(600000,800000),(800000,1000000),(1000000,2000000),(2000000,4000000),(4000000,6000000),(6000000,)) as rs
| correlation bucket_field=rs
| sort by correlation</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/spl-cmd-correlation-1.png" alt="spl cmd correlation 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dbxexec"><a class="anchor" href="#_dbxexec"></a><a class="link" href="#_dbxexec">6.13. dbxexec</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是一个可以使用sql来更新/删除远程数据的数据</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dbxexec &lt;connection&gt; &lt;param-options&gt;* &lt;query&gt; [&lt;params&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>connection</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>connection = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指的是数据源名称(该数据源是配置页面配置好的)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>query</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>query = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用的sql语句或者其他数据库支持的更新/删除语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;batchsize&gt; | &lt;timeout&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可选参数选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>batchsize</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>batchsize = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查询时分batch取数据，每个batch的大小，默认为100</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timeout</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeout = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>query查询超时时间(单位为秒)，默认为600</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>params = &lt;field&gt;[,&lt;field&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于query中替换的字段值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 15. 示例1</div>
<div class="content">
<div class="paragraph">
<p>更新connection配置为110test的数据源对应的dbxexec_test表中当id为前序字段值的数据为前序count字段值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">dbxexec connection="110test" query="update dbxexec_test set count=? where id=?" params=count,id</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>搜索数据结果：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/dbxexec-1.png" alt="dbxexec 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dbxlookup"><a class="anchor" href="#_dbxlookup"></a><a class="link" href="#_dbxlookup">6.14. dbxlookup</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>类似sql的连接，将来自远程数据库表的结果和子管道的结果连接在一起</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dbxlookup [&lt;chunksize&gt;] (&lt;preset-lookup-option&gt; | &lt;lookup-option&gt;)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>preset-lookup-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;lookup&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>lookup</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指的是已配置的lookup名称(该名称是dbxlookup配置页面配置好的)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>chunksize</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>chunksize = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定分批查询数据的条数batch_size</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>lookup-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;lookup-field-list&gt; &lt;connection&gt; &lt;query&gt; ON &lt;join-field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>lookup-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; [as &lt;field&gt;] (, &lt;field&gt; [as &lt;field&gt;])*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定将远程数据库中的数据保留在搜索结果中的字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>connection</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>connection = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指的是数据源名称(该数据源是配置页面配置好的)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>query</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>query = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用的sql语句或者其他数据库支持的查询语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>join-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; = &lt;field&gt; (, &lt;field&gt; = &lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>等号左边的field表示主结果中的字段，等号右边的field为远程数据库搜索结果中的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>dbxlookup命令每个batch的最大条数的上限默认为10000条，对应配置项为dbxquery.max_fetch_size</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 16. 示例</div>
<div class="content">
<div class="paragraph">
<p>将模拟的数据与已配置lookup名称为gc_test_vertica的数据连接在一起</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">|makeresults count=1 | eval hostname="TEST" | dbxlookup lookup="gc_test_vertica"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>搜索数据结果：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/dbxlookup-1.png" alt="dbxlookup 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 17. 示例</div>
<div class="content">
<div class="paragraph">
<p>将模拟的数据与connection配置为221_test_vertica的数据源的结果中的id和ttime字段通过hostname和text字段进行join并返回的结果</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">|makeresults count=1 | eval hostname="TEST"| dbxlookup id,ttime connection="221_test_vertica" query="SELECT * FROM test.test" on hostname=text</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>搜索数据结果：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/dbxlookup-2.png" alt="dbxlookup 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dbxoutput"><a class="anchor" href="#_dbxoutput"></a><a class="link" href="#_dbxoutput">6.15. dbxoutput</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将当前搜索的数据按照已配置的dbxoutput名称写出到远程数据库</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dbxoutput &lt;output&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>output</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>output=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指的是output名称(该名称是dbxoutput配置页面配置好的)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 18. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将模拟数据输出到output配置为output1对应的远程数据库中的指定字段中。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">|makeresults count=1 | eval appname="ccccc" |eval id=1002 |dbxoutput output="output1"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>搜索数据结果：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/dbxoutput-1.png" alt="dbxoutput 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dbxquery"><a class="anchor" href="#_dbxquery"></a><a class="link" href="#_dbxquery">6.16. dbxquery</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是一个可以使用sql来查远程数据库的数据并作为spl的查询语句的命令（不支持跨库联查，如果要使用两个库的话可以使用append，join等）</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dbxquery connection &lt;dbx-params&gt;* &lt;dbx-query-procedure&gt; [ params=&lt;string&gt;[,&lt;string&gt;]* ]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>connection</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>connection=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指的是数据源名称(该数据源是配置页面配置好的)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>dbx-query-procedure</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;query&gt; | &lt;procedure&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>query</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>query = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用的sql语句或者其他数据库支持的查询语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>procedure</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>procedure = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指的是使用存储过程，支持params</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dbx-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;fetchsize&gt; | &lt;maxrows&gt; | &lt;timeout&gt; | &lt;shortnames&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>fetchsize</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fetchsize = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查询时分batch取数据，每个batch的大小，默认为10000</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxrows</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxrows = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该查询语句所能查到的所有数据的条数限制，默认为100000</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timeout</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeout = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>query查询超时时间(单位为秒)，默认为600</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>shortnames</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>shortnames = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否只显示名称，如果为false则会拼上字段的类型，默认为true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt;[,&lt;string&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于存储过程或者query中替换的变量值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>dbxquery命令每个batch的最大条数的上限默认为10000条，对应配置项为dbxquery.max_fetch_size</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 19. 示例1</div>
<div class="content">
<div class="paragraph">
<p>搜索connection配置为179test的数据源对应的test表中的所有数据</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| dbxquery connection="179test" query="select * from test"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/dbxquery-2.png" alt="dbxquery 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dedup"><a class="anchor" href="#_dedup"></a><a class="link" href="#_dedup">6.17. dedup</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以对搜索结果中指定字段值的重复情况进行去重和过滤</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dedup [&lt;dedup-count&gt;] &lt;field-list&gt; [&lt;dedup-param&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>一列字段名称，表明要对结果中的哪些字段进行dedup操作和判定</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dedup-count</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>此参数指定保留前N条重复出现的日志或结果 默认值：1，默认只保留重复出现的第一条日志</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>dedup-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;keepevents = &lt;bool&gt;&gt; | &lt;keepempty = &lt;bool&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keepevents:是否保留重复事件,keepempty:是否保留空事件</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>keepevents</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>若为true，则会保留所有重复出现的日志，但会移除重复值（除去第一条出现的日志） 默认值：false，重复出现的日志将会被整体移除</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>keepempty</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>若为true，则会保留指定field name的值为空的日志 默认值：false，若指定的一个或多个field name值为空，那么该条日志将会被移除</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 20. 示例1</div>
<div class="content">
<div class="paragraph">
<p>列出每个城市不同的apache.status的各前三条结果</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | table apache.status, apache.geo.city | dedup 3 apache.status, apache.geo.city</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_delete"><a class="anchor" href="#_delete"></a><a class="link" href="#_delete">6.18. delete</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以对搜索结果中query部分命中的原始日志进行删除</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>delete</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>delete仅对query命中的原始日志部分进行删除，且删除有一定延迟</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 21. 示例</div>
<div class="content">
<div class="paragraph">
<p>列出tag为lytest中的原始日志</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">tag:lytest | delete</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_download"><a class="anchor" href="#_download"></a><a class="link" href="#_download">6.19. download</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以download命令之前产生的结果下载到外部文件</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>download &lt;filename&gt; [&lt;param-options&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>filename</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>filename = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定下载文件的名称，无须带后缀</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;fileformat&gt; | &lt;maxsize&gt; | &lt;maxevents&gt; | &lt;charset&gt; | &lt;format&gt; | &lt;compress&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>fileformat</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fileformat = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>必要参数。文件格式类型，可选[csv, json, txt, xlsx]，默认为"txt"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxsize</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxsize=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>下载的最大文件大小，其值为整数，支持单位[g, m, k, b]，默认值见配置项 download.max_file_size</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxevents</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxevents=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>下载的最大事件数，默认值见配置项 download.max_events</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>charset</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>charset = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>字符集，可选[UTF-8, GBK]，默认为"UTF-8"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>csv 文件的格式，可选`rfc`,`default`, 默认为`default`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>compress</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>compress = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用该选项控制下载文件是否压缩, 默认值是 false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 22. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将原始日志中仅保留appname和hostname两个字段的结果下载为aatest.json的结果文件</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | table appname, hostname | download filename="aatest" fileformat="json"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/download-1.png" alt="download 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_esma"><a class="anchor" href="#_esma"></a><a class="link" href="#_esma">6.20. esma</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以对某一个字段的未来值进行预测</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>esma &lt;field&gt; [&lt;as-field-clause&gt;] &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>string</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于表示进行预测的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as-field-clause</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>as &lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示将预测结果字段重新命名，默认为 _predict_&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;timefield&gt; | &lt;period&gt; | &lt;futurecount&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>参数选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>timefield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timefield = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>时间参数字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>period</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>period = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示数据中的时间周期长度，如果没有指定，我们将自己进行计算</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>futurecount</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>futurecount = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示对未来进行预测的个数，默认为5，最大值为100</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>esma命令需要用在统计命令后面，同时统计命令需要根据时间进行分组，并且esma 的timefield字段需要指定为该时间分组字段</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 23. 示例1</div>
<div class="content">
<div class="paragraph">
<p>统计过去一年的每天的平均延迟（我们将周期设置为7天），从而推测接下来一个月的网络延迟</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | bucket timestamp span=1d as ts | stats avg(network.latency) as latency by ts | esma latency timefield=ts period=7 futurecount=30</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_eval"><a class="anchor" href="#_eval"></a><a class="link" href="#_eval">6.21. eval</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>计算表达式并将生成的值放入到新的字段中</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>eval &lt;field&gt;=&lt;expression&gt; [, &lt;field&gt;=&lt;expression&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>生成的目标字段名称，如果字段已存在字段的值将被覆盖。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>expression</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt; | &lt;field&gt; | &lt;operator&gt; | &lt;expression_function&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>代表目标字段值的值、变量、运算符以及函数的组合。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>expression_function</p>
<div class="ulist">
<ul>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>spl本身已经支持了部分函数，请参看eval函数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>operator</p>
<div class="ulist">
<ul>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>运算符按照优先级自低到高排序:
1. ||（逻辑或）二元操作符，操作数必须是布尔类型
2. &amp;&amp;（逻辑与）二元操作符，操作数必须是布尔类型
3. !=（不等于）==（等于）
4. &gt;=，&gt;，&lt;=, &lt;
5. +，- 算术加减，支持数值类型，+另支持字符串
6. *，/，% 算术乘，除，余，乘除支持数值类型</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 24. 示例1</div>
<div class="content">
<div class="paragraph">
<p>对于web日志，将根据响应时间获取short, middle, long三个分类值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">logtype:apache | eval length=case(apache.resp_len &lt; 1500, "short", apache.resp_len &gt; 2000, "long", default, "middle")</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-040958.327.png" alt="Image 140318 040958.327">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 25. 示例2</div>
<div class="content">
<div class="paragraph">
<p>对创建出的一条数据添加tag和appname字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| makeresults count=1 | eval tag="tag1",appname="app1"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/eval-2.png" alt="eval 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_eventstats"><a class="anchor" href="#_eventstats"></a><a class="link" href="#_eventstats">6.22. eventstats</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>提供统计信息，可以选择字段进行分组，并且将按照当前行所属于的分组的统计结果作为新的字段值添加在本行</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>eventstats (&lt;stats-function&gt; [as &lt;field&gt;])+ [by &lt;field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stats-func-as</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | list | values | top | es | dhg | hg | pct | pct_ranks | rb | sparkline | mad</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与stats命令结合的函数，请参考[#与stats有关的函数]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;[,&lt;field&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要保留的字段以逗号或者空格分割的字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>eventstats保留的事件数的上限对应的配置项为eventstats.event_size</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 26. 示例1</div>
<div class="content">
<div class="paragraph">
<p>搜索所有数据并且按照数据logtype计算count值并且根据logtype给每行添加上count()字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | eventstats count() by logtype</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/eventstats-1.png" alt="eventstats 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fields"><a class="anchor" href="#_fields"></a><a class="link" href="#_fields">6.23. fields</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>通过操作符保留或排除结果中的系列字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fields [&lt;operator&gt;] &lt;field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要保留或排除的字段以逗号或者空格分割的字段列表，支持通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>operator</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>+ | -</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>+是保留，-是排除，默认为+。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>注意：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对字段列表的操作是一致的，都为保留或都为排除。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>+</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 27. 示例1</div>
<div class="content">
<div class="paragraph">
<p>仅保留appname和hostname字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | stats count() by appname,hostname | fields appname, hostname</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041041.959.png" alt="Image 140318 041041.959">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 28. 示例2</div>
<div class="content">
<div class="paragraph">
<p>仅保留以json.e开始的字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | stats count() by json.activated,json.id,json.excess_action,json.excess_times_limit | fields + json.e*</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041041.960.png" alt="Image 140318 041041.960">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 29. 示例3</div>
<div class="content">
<div class="paragraph">
<p>排除appname和hostname字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | fields - appname, hostname</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/spl-fields-3.png" alt="spl fields 3">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_filldown"><a class="anchor" href="#_filldown"></a><a class="link" href="#_filldown">6.24. filldown</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将某些字段的null值用上一个最近的非null值进行填充，支持通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>filldown [&lt;space-or-comma-field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>space-or-comma-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;field&gt; &lt;field&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要进行填充的字段列表，可用空白或逗号分隔。字段名可使用通配符匹配</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 30. 示例：</div>
<div class="content">
<div class="paragraph">
<p>对所有字段，都进行null值填充</p>
</div>
<div class="paragraph">
<p>原始数据:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/filldown-1.png" alt="filldown 1">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | filldown</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/filldown-2.png" alt="filldown 2">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 31. 示例：</div>
<div class="content">
<div class="paragraph">
<p>对字段x和满足通配符c*条件的字段，进行null值填充</p>
</div>
<div class="paragraph">
<p>原始数据:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/filldown-1.png" alt="filldown 1">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | filldown x c*</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/filldown-3.png" alt="filldown 3">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fillnull"><a class="anchor" href="#_fillnull"></a><a class="link" href="#_fillnull">6.25. fillnull</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将空值替换为指定值。空值是在特定结果中缺失但在另一结果中存在的字段值。使用fillnull与字符串替换空字段值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fillnull [value=&lt;string&gt;] &lt;field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; (,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定要填充空值的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>value</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定一个字符串来替换空值，默认为"0"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 32. 示例1</div>
<div class="content">
<div class="paragraph">
<p>创建一条日志并且a字段为空，使用fillnull来给a字段填充默认值fillnull_source</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|makeresults count=1 | eval a=null| fillnull value="fillnull_source" a</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/fillnull-1.png" alt="fillnull 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_foreach"><a class="anchor" href="#_foreach"></a><a class="link" href="#_foreach">6.26. foreach</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对字段列表执行流式命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>foreach &lt;wc-field-list&gt; &lt;foreach-options&gt;* &lt;sub-pipe&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>wc-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;wc-field&gt; ( , &lt;wc-field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>字段列表, 支持*作为通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>sub-pipeline</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[[ command ( | command)* ]]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子命令模板，支持管道分隔的多个命令, 必须是流式命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>foreach-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;fieldstr-option&gt; | &lt;matchstr-option&gt; | &lt;matchseg1-option&gt; | &lt;matchseg2-option&gt; | &lt;matchseg3-option&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>foreach可选的参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>fieldstr-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fieldstr=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>匹配的字段名，默认是&lt;&lt;FIELD&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>matchstr-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>matchstr=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>所有通配符匹配到的内容, 默认是&lt;&lt;MATCHSTR&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>matchseg1-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>matchseg1=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>第一个通配符匹配到的内容，默认是&lt;&lt;MATCHSEG1&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>matchseg2-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>matchseg2=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>第二个通配符匹配到的内容，默认是&lt;&lt;MATCHSEG2&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>matchseg3-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>matchseg3=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>第三个通配符匹配到的内容，默认是&lt;&lt;MATCHSEG3&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 33. 示例1</div>
<div class="content">
<div class="paragraph">
<p>对所有前缀是count的字段值加1</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | foreach count* [[ eval &lt;&lt;FIELD&gt;&gt; = &lt;&lt;FIELD&gt;&gt; + 1 ]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 34. 示例2</div>
<div class="content">
<div class="paragraph">
<p>对所有前缀是count的字段求和</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | eval sum = 0 | foreach count* [[ eval tmp = sum | eval sum = tmp + &lt;&lt;FIELD&gt;&gt; ]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fromes"><a class="anchor" href="#_fromes"></a><a class="link" href="#_fromes">6.27. fromes</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是一个可以使用elastic dsl来查elasticsearch的数据并作为spl的查询语句的命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fromes &lt;fromes-options&gt;* &lt;index&gt; &lt;querydsl&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>fromes-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;host&gt; | &lt;port&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fromes可选的参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>host</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>host=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定es服务的ip, 默认值为localhost</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>port</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>port=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定es服务监听的端口, 默认值为9200</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>index</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>index=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定搜索的索引</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>querydsl</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>querydsl=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>es支持的dsl json, json内的单引号需要加 \ 转义</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 35. 指定host、index, 执行搜索</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|fromes host=10.200.0.140 index=logs-my_app-default querydsl='{
          "query": {
            "match_all": { }
          }
        }'</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 36. 指定host、port、index, 执行聚合</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|fromes host=10.200.0.140 port=9200 index=logs-my_app-default querydsl='{
          "query": {
            "match_all": { }
          },
          "aggs": {
            "@timestamp_avg": {
              "avg": {
                "field": "@timestamp"
              }
            }
          }
        }'</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fromkafkapy"><a class="anchor" href="#_fromkafkapy"></a><a class="link" href="#_fromkafkapy">6.28. fromkafkapy</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>消费kafka的数据并作为spl的查询语句的命令</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fromkakfapy (bootstrap-servers | topic | action | partitions | offset | limit | timeout-ms)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bootstrap-servers</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>bootstrap-servers=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>kafka服务列表, 使用逗号分隔。默认值为'localhost:9092'</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>topic</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>topic=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定消费的主题</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>action</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>action=consume | show-partition-info</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>consume是进行消费，show-partition-info是查询分区信息，默认值为为consume.</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>partitions</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>partitions=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定分配分区, 分区不存在时报错, 默认分配所有分区。如 partitions=[0,1]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>offset</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>offset=earliest | latest | '0:100, ...'</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分区的偏移量。默认是根据分配分区与指定limit计算偏移量消费，消费最近limit条</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>earliest指定从分配的分区最早的偏移量开始消费；</p>
</li>
<li>
<p>latest指定从分配的分区最近的偏移量开始消费；</p>
</li>
<li>
<p>'0:100, …​'指定分配的分区与偏移量进行消费, 分区不存在时报错，这种方式不能和partitions同时使用。</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>消费的条数限制. 当消费到指定的数量时停止消费, 默认值为100</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timeout-ms</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeout-ms=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>费的超时限制. 当在指定时间内没有收到record时停止消费，默认值为1000</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 37. 查看test主题的分区信息</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|fromkafkapy action=show-partition-info topic=test</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 38. 消费test主题，直到达到3s的超时条件或者获取100条的record</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|fromkafkapy topic=test timeout-ms=3000</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 39. 从指定分区0，最近的偏移量开始消费</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|fromkafkapy topic=test partitions=[0] offset=latest</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 40. 从偏移量5开始消费分区0</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|fromkafkapy topic=test offset='0:5'</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gentimes"><a class="anchor" href="#_gentimes"></a><a class="link" href="#_gentimes">6.29. gentimes</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可以生成指定范围的时间戳数据</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>| gentimes &lt;start&gt; &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>start</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>start = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定开始时间，可选[ "2019-01-01" | "2019-01-01 18:00:00" | "1571557017000" | "-1d/d" | "now-1d" ]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;end&gt; | &lt;increment&gt; | &lt;humantime&gt; | &lt;timezone&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>end</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>end = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定结束时间，可选[ "2019-01-01" | "2019-01-01 18:00:00" | "1571557017000" | "-1d/d" | "now-1d" ]，默认为当天23:59:59</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>increment</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>increment = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定步长，时长+[s|m|h|d], 默认为1d</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>humantime</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>humantime = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否生成两个个新字段为starthuman和endhuman，用于将start和end转换为YYYY-MM-dd:hh:mm:ss格式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timezone</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timezone = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定时区，默认为+08:00</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>如果没有end，则start必须小于等于今天</p>
</li>
<li>
<p>若时间范围为3.5d，但是increment为1d，则返回四条结果并且endtime为4d并不是3.5d</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 41. 示例1</div>
<div class="content">
<div class="paragraph">
<p>根据2019-01-01~2019-01-04这个时间范围，按步长为1d生成出对应的三条数据，并且根据humantime参数为true，生成出对应的starthuman以及endhuman字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| gentimes start="2019-01-01" end="2019-01-04" increment="1d" humantime=true</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041041.961.png" alt="Image 140318 041041.961">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_geostats"><a class="anchor" href="#_geostats"></a><a class="link" href="#_geostats">6.30. geostats</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使⽤geostats命令可以基于地理位置信息，即经度和纬度进行分区域统计</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>geostats [&lt;geostats-params&gt;]* &lt;stats-single-value-func&gt; [&lt;stats-single-value-func&gt;]* [by &lt;by-field&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stats-single-value-func-as</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | mad</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与stats命令结合的部分函数，请参考[#与stats有关的函数]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>geostats-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[latfield=&lt;field&gt;] [longfield=&lt;field&gt;] [outputlatfield=&lt;field&gt;] [outputlongfield=&lt;field&gt;] [binspanlat=&lt;double&gt;] [binspanlong=&lt;double&gt;] [maxzoomlevel=&lt;int&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>latfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>latfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定的纬度字段，默认值为lat</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>longfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>longfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定的经度字段，默认值为lon</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>outputlatfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>outputlatfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>结果中纬度分桶后的字段名，默认值为latitude</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>outputlongfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>outputlongfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>结果中经度分桶后的字段名，默认值为longitude</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>binspanlat</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>binspanlat=&lt;double&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>纬度分桶间隔，默认值为22.5</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>binspanlong</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>binspanlong=&lt;double&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>经度分桶间隔，默认值为45.0</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxzoomlevel</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxzoomlevel=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>最大缩放级别，最大值为9</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>by-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组字段，所有的stats_func将在分组内统计</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于geostats支持按照多个字段进行分组,所以这里会与stats命令中的by字段有同样的限制，详情见stats命令的NOTE中的group.size以及stats.oneby.group_size配置项</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 42. 示例1</div>
<div class="content">
<div class="paragraph">
<p>纬度字段为verdors.VendorLatitude，经度字段为verdors.VendorLongitude，结果中纬度分桶字段为ccc，结果中经度字段分桶字段为ddd，纬度分桶间隔为35.5，经度分桶间隔为40.65，最大缩放级别为8时对应地理区域中事件数的统计值。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">appname:vendors | geostats latfield=vendors.VendorLatitude longfield=vendors.VendorLongitude outputlatfield=ccc outputlongfield=ddd binspanlat=35.5 binspanlong=40.65 maxzoomlevel=8 count() as cnt by hostname</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041042.336.png" alt="Image 140318 041042.336">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inputlookup"><a class="anchor" href="#_inputlookup"></a><a class="link" href="#_inputlookup">6.31. inputlookup</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使⽤inputlookup 命令可以读取lookup的表，⽬前lookup表⽀持csv⽂件(以.csv为后缀名)，kv字典，资产实体（通过lookup-type参数指定）。csv⽂件第⼀⾏需为字段名的信息。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>inputlookup &lt;param-options&gt;* &lt;lookup-type&gt;? &lt;filename-or-kvstorename-or-assetname&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>filename-or-kvstorename-or-assetname</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;file-name&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>文件名必须以.csv结尾，无须提供路径。文件为通过字典上传或者outputlookup写出的文件。kvstore必须在所属domain和app下已经定义好。使用资产实体时资产模型必须存在。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lookup-type</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>(csv: | kvstore: | asset: )</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>inputlookup文件类型，csv：csv文件；kvstore：kv字典；asset：资产实体。不填优先匹配csv，不成功匹配为kv字典</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;max&gt; | &lt;start&gt; | &lt;format&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>离散化选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>max</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>max = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>最多读取多少个事件，默认值为 10,000,000</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>start</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>start = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定从第多少个事件(每⾏为⼀个事件)开始读取，NOTE: start值从0开始，如果start=4表⽰第五个事件，默认值为 0</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>csv 文件的格式，可选`rfc`,`default`, 默认为`default`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 43. 示例1</div>
<div class="content">
<div class="paragraph">
<p>读取a.csv中的事件信息</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| inputlookup a.csv</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041426.375.png" alt="Image 140318 041426.375">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 44. 示例2</div>
<div class="content">
<div class="paragraph">
<p>读取kvstore名为packetsrc中的事件信息</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| inputlookup packetsrc</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/inputlookup_kvstore.png" alt="inputlookup kvstore">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_iplocation"><a class="anchor" href="#_iplocation"></a><a class="link" href="#_iplocation">6.32. iplocation</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>从ip地址抽取地理信息</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>iplocation [prefix=&lt;string&gt;] &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>prefix=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ip字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>prefix</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>prefix=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>给产生的字段名加上前缀</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 45. 示例1</div>
<div class="content">
<div class="paragraph">
<p>从clientip字段抽取出地理信息</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | iplocation clientip</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_join"><a class="anchor" href="#_join"></a><a class="link" href="#_join">6.33. join</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对父管道的结果和子管道的结果进行类似sql的join</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>join &lt;param-options&gt;* &lt;field-list&gt; [[ subsearch ]]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定要用于连接的具体字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>subsearch</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;sub_pipeline&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子搜索管道</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;type&gt; | &lt;max&gt; | &lt;overwrite&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>join命令的选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>type</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>type = inner | left</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要执行的连接类型，inner和left的区别局势他们如何对待主管道和自管道中的结果不匹配事件，inner连接的结果将不包括没有匹配的事件，left连接不要求必须具有匹配的字段，对于主管道中不匹配的事件将被保留。默认值是inner</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>max</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>max = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定每个主结果可以连接的最大自结果数，默认为1</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>overwrite</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>overwrite = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于性能的影响，子管道的结果数最大为50000条，对应配置项join.subsearch.max_count。</p>
<div class="ulist">
<ul>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>appname:apache |join type=left timestamp [[*|stats count() by timestamp|fields timestamp]]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>上述语句中join语句内的子查询的最大结果数为50000条，如果超过该数值则将之后的数据丢弃，然后将appname:apache的结果与join的子查询中的子查询的50000条数据进行left join操作。注意：子查询结果数超过50000条时，系统会给出提示"触发配置项group.size的配置上限，数据返回不完整"。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 46. 示例</div>
<div class="content">
<div class="paragraph">
<p>统计过去一天每个小时每个ip的事件数占当前这个小时总数的百分比</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | bucket timestamp span=1h as ts | stats count() as ip_count by apache.clientip,ts | join type=left ts [[ logtype:apache | bucket timestamp span=1h as ts | stats count() as hour_count by ts ]] | eval ippercent=100 * ip_count / hour_count</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041338.928.png" alt="Image 140318 041338.928">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jpath"><a class="anchor" href="#_jpath"></a><a class="link" href="#_jpath">6.34. jpath</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>jpath用于支持对json的数据处理，提供类似xpath的机制，并配合上多值函数对json数据进行提取和处理</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>jpath [input=&lt;field&gt;] output=&lt;field&gt; path=&lt;json-path&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>output</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示抽取的输出字段名，字段类型收到json-path的影响，可能为单值也可能为多值类型</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>json-path</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;double-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>json-path描述的路径。语法详见：https://github.com/json-path/JsonPath</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. jsonpath的操作符</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">操作符</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通配符，可用于通配子节点或者数组所有元素</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.&lt;name&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">名为name的子节点</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">['&lt;name&gt;' (, '&lt;name&gt;')]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">方括号形式描述子节点，可以是多个name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[&lt;number&gt; (, &lt;number&gt;)]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">方括号形式描述数组的元素，可以是多个number</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">[start:end]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">类似python中的数组用法，表示数据元素的范围</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">Listing 1. json-path示例</div>
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">{
&nbsp; &nbsp; "store": {
&nbsp; &nbsp; &nbsp; &nbsp; "book": [
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "category": "reference",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "author": "Nigel Rees",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "title": "Sayings of the Century",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "price": 8.95
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "category": "fiction",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "author": "Evelyn Waugh",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "title": "Sword of Honour",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "price": 12.99
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "category": "fiction",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "author": "Herman Melville",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "title": "Moby Dick",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "isbn": "0-553-21311-3",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "price": 8.99
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "category": "fiction",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "author": "J. R. R. Tolkien",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "title": "The Lord of the Rings",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "isbn": "0-395-19395-8",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "price": 22.99
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; &nbsp; &nbsp; ],
&nbsp; &nbsp; &nbsp; &nbsp; "bicycle": {
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "color": "red",
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "price": 19.95
&nbsp; &nbsp; &nbsp; &nbsp; }
&nbsp; &nbsp; },
&nbsp; &nbsp; "expensive": 10
}</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>对应的查询语句结果为:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Json-path</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">store.book[*].author</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">所有书籍的作者</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">store.book[2]['author']</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">第三本书的作者</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">store.book[-2]['price']</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">倒数第二本书的价格</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">store.book[0,1]['price']</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">第一本和第二本书的价格，类型为多值类型</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">store.book[1:2]['price']</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">第二本和第三本数的价格，类型为多值类型</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>input</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定json类型的输入字段，默认为raw_message</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 47. 示例</div>
<div class="content">
<div class="paragraph">
<p>日志原文为{ "a": [  ["x1","r1","31"],  ["x2","r2","32"], ["x3","r3","33"] ]}，其中a为数组的数组，其中第三个元素为价格，抽取所有价格，抽取结果为多值类型</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041716.084.png" alt="Image 140318 041716.084">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_kvextract"><a class="anchor" href="#_kvextract"></a><a class="link" href="#_kvextract">6.35. kvextract</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>提供抽取功能，从指定字段的字符串值中按照指定的键值分割符和对分隔符进行键值抽取，抽取出来的结果以新字段的形式添加在结果中</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>kvextract [&lt;field&gt;] &lt;kvextract-param&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定抽取的字段，默认为raw_message</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>kvextract-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;clean_keys&gt; | &lt;kvdelim&gt; | &lt;limit&gt; | &lt;maxchars&gt; | &lt;mv_add&gt; | &lt;pairdelim&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>clean_keys</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>clearn_keys = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>为true时表示当抽取出来的key值中有非字母或数字的字符时，用下划线代替这些字符，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>kvdelim</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>kvdelim = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定键与值的分隔符，默认为'='</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定最多抽取多少个键值对，默认为50</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxchars</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxchars = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定最多扫描多少个字符用来抽取，默认为10240</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>mv_add</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>mv_add = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定是否对同一key抽取时创建多值，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>pairdelim</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>pairdelim = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定kv对的分隔符，默认为' '</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 48. 示例1</div>
<div class="content">
<div class="paragraph">
<p>按照默认参数抽取json.kvex字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">appname:lykv | kvextract json.kvex</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/kvextract-1.png" alt="kvextract 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 49. 示例2</div>
<div class="content">
<div class="paragraph">
<p>抽取json.kvex字段，当抽取出来的key值中有非字母或数字的字符时，用下划线代替这些字符</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">appname:lykv | kvextract json.kvex clean_keys=true</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/kvextract-2.png" alt="kvextract 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldapfetch"><a class="anchor" href="#_ldapfetch"></a><a class="link" href="#_ldapfetch">6.36. ldapfetch</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以将指定dn下属性值返回并添加在每条结果后，dn为前序命令产生的字段名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ldapfetch &lt;ldap-base-param&gt; &lt;dn&gt; [&lt;attrs&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ldap-base-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;domain&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>dn</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dn = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查询ldap的distinguish name，由前序命令产生的字段值替换</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>domain</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>domain = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>规定连接的ldap配置名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>attrs</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>attrs = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>逗号分割的属性名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 50. 示例</div>
<div class="content">
<div class="paragraph">
<p>将dn为memberOf中所有值下的cn description属性返回并添加在每条结果后</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">|ldapsearch domain="SPL" search="(objectclass=group)" attrs="memberOf" |mvexpand memberOf |ldapfetch dn=memberOf attrs="cn,description"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldapfilter"><a class="anchor" href="#_ldapfilter"></a><a class="link" href="#_ldapfilter">6.37. ldapfilter</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以将指定search语句中的属性值返回并添加在每条结果后，其中domain和search都可以由前面命令产生的结果值填充</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ldapfilter &lt;ldap-base-param&gt; &lt;search&gt; &lt;ldap-filter-param&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ldap-base-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;domain&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>search</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>search = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查询ldap的search语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>domain</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>domain = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>规定连接的ldap配置名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>basedn</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>basedn = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定搜索开始的ldap节点</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>attrs</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>attrs = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>为逗号分割的属性名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>ldap-filter-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;basedn&gt; | &lt;attrs&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 51. 示例</div>
<div class="content">
<div class="paragraph">
<p>将domain为dest_nt_domain字段中所有值并且搜索对应的src_user的结果，取telephoneNumber和displayName字段返回</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | |stats count by src_user,dest_nt_domain |ldapfilter domain="$dest_nt_domain$" search="(objectClass=$src_user$)" attrs="telephoneNumber,displayName"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldapgroup"><a class="anchor" href="#_ldapgroup"></a><a class="link" href="#_ldapgroup">6.38. ldapgroup</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以查询规定dn下所有关联的节点信息，结果将增加member_dn member_domain member_name member_type mv_combo五个字段，其中最后一个字段为前四个字段的拼接值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ldapgroup &lt;ldap-base-param&gt; [&lt;groupdn&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ldap-base-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;domain&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>groupdn</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>groupdn = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查询的dn名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>domain</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>domain = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>规定连接的ldap配置名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 52. 示例</div>
<div class="content">
<div class="paragraph">
<p>将名称为spl的ldap配置环境中，dn名称为groupa下所有关联的节点信息</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">|ldapsearch domain="SPL" search="(objectClass=group)"|ldapgroup domain="SPL" groupdn="groupa"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldapsearch"><a class="anchor" href="#_ldapsearch"></a><a class="link" href="#_ldapsearch">6.39. ldapsearch</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以对ldap进行搜索并将指定结果返回</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ldapsearch &lt;ldap-base-param&gt; &lt;search&gt; &lt;ldap-search-param&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ldap-base-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;domain&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>search</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>search = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查询ldap的search语句</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>attrs</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>attrs = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>为逗号分割的属性名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>domain</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>domain = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>规定连接的ldap配置名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>scope</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>scope = base | noe | sub</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>代表抽哪一层的结果, `base`代表只搜索当前层级、`noe`代表当前层级+向下一级，`sub`代表所有子层级的结果都抽取</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>规定返回结果最多有多少条</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>basedn</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>basedn = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定搜索开始的ldap节点</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>ldap-search-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;basedn&gt; | &lt;attrs&gt; | &lt;limit&gt; | &lt;scope&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 53. 示例</div>
<div class="content">
<div class="paragraph">
<p>查询ldap配置为SPL环境中所有objectclass为user的节点</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">| ldapsearch domain="SPL" search="(objectClass=user)"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldaptestconnection"><a class="anchor" href="#_ldaptestconnection"></a><a class="link" href="#_ldaptestconnection">6.40. ldaptestconnection</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以测试连接已配置好的ldap环境</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>ldaptestconnection &lt;ldap-base-param&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ldap-base-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;domain&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>domain</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>domain = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>规定连接的ldap配置名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 54. 示例</div>
<div class="content">
<div class="paragraph">
<p>测试连接ldap配置名称为testcon的ldap环境配置，如成功返回true</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">| ldaptestconnection domain="testcon"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_limit"><a class="anchor" href="#_limit"></a><a class="link" href="#_limit">6.41. limit</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>以搜索顺序，返回前N个结果或者直到eval表达式为false的结果。使用与head相同</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit [limit-expr]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>limit-expr</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;number&gt; | (&lt;expression&gt;) [limit-params]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回结果数或要满足的表达式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>number</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回结果的数量。默认是10</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>expression</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>有效的eval表达式，其值为布尔值。搜索将返回结果，直到该表达式的计算结果为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;null = &lt;bool&gt;&gt; | &lt;keeplast = &lt;bool&gt;&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>控制参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>null</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>控制eval表达式评估为NULL时如何处理，设置为true则认定eval表达式为true，为false则认定eval表达式为false。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>keeplast</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keeplast=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>控制是否保留结果集中最后一个使得eval表达式评估为false的结果，设置为true则保留，为false则丢弃。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 55. 示例1</div>
<div class="content">
<div class="paragraph">
<p>保留前2条结果</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">sourcetype:splserver | limit 2</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/limit-1.png" alt="limit 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 56. 示例2</div>
<div class="content">
<div class="paragraph">
<p>当count字段为null时，使得count&lt;5评估为NULL，认定count&lt;5为true，保留直到使得count&lt;5为false的结果，并且保留最后一条</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">sourcetype:splserver | limit count&lt;5 null=true keeplast=true</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/limit-2.png" alt="limit 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_head"><a class="anchor" href="#_head"></a><a class="link" href="#_head">6.42. head</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>以搜索顺序，返回前N个结果或者直到eval表达式为false的结果。使用与limit相同</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>head [limit-expr]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>limit-expr</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;number&gt; | (&lt;expression&gt;) [limit-params]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回结果数或要满足的表达式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>number</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回结果的数量。默认是10</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>expression</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>有效的eval表达式，其值为布尔值。搜索将返回结果，直到该表达式的计算结果为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>控制参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>keeplast</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keeplast=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>控制是否保留结果集中最后一个使得eval表达式评估为false的结果，设置为true则保留，为false则丢弃。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>null</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>控制eval表达式评估为NULL时如何处理，设置为true则认定eval表达式为true，为false则认定eval表达式为false。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 57. 示例1</div>
<div class="content">
<div class="paragraph">
<p>保留前2条结果</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">sourcetype:splserver | head 2</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/head-1.png" alt="head 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 58. 示例2</div>
<div class="content">
<div class="paragraph">
<p>当count字段为null时，使得count&lt;5评估为NULL，认定count&lt;5为true，保留直到使得count&lt;5为false的结果，并且保留最后一条</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">sourcetype:splserver | head count&lt;5 null=true keeplast=true</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/head-2.png" alt="head 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lookup"><a class="anchor" href="#_lookup"></a><a class="link" href="#_lookup">6.43. lookup</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用lookup命令可以将外部文件中的结果和当前管道的结果进行join，可为/data/rizhiyi/spldata/lookup下的本地文件、outputlookup生成的文件或kvstore存储或资产实体。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup &lt;lookup-field-list&gt; &lt;lookup-type&gt;? &lt;filename-or-kvstorename-or-assetname&gt; on &lt;join-field-list&gt; &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lookup-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;lookup-field&gt; (, &lt;lookup-field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>外部文件中需要加入搜索结果的字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>lookup-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; [as &lt;field&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对字段列表的重命名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>filename-or-kvstorename-or-assetname</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;file-name&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要关联的外部文件的uri地址，支持http和https地址，或者本地共享文件的地址，或者已经定义并创建好的kvstore名称，或者已经存在的资产模型名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>join-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;join-field&gt; (, &lt;join-field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>join字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>join-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>等号左边的field表示主结果中的字段，等号右边的field为外部文件中的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lookup-type</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>(csv: | kvstore: | asset: )</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup文件类型，csv：csv文件；kvstore：kv字典；asset：资产实体。不填优先匹配csv，不成功匹配为kv字典</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;case-sensitive-match&gt; ｜ &lt;match-type&gt; | &lt;format&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>max</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>max = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定每个主结果可以连接的最大自结果数，默认为1</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>overwrite</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>overwrite = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否覆盖主结果，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>case-sensitive-match</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>case_sensitive_match = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>精确匹配时是否区分大小写，默认值为true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>match-type</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>match_type = &lt;match-type-funcs&gt; (, &lt;match-type-funcs&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup的匹配方式，目前支持cidr和wildcard，默认为精确匹配(不需要单独写出)。这里field-list填写的是搜索数据中所使用该规则的字段列表，非csv中需要使用该规则的字段列表。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>match-type-funcs</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>cidr(&lt;field&gt;[, &lt;field&gt;]*) | wildcar(&lt;field&gt;[, &lt;field&gt;]*)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>cidr或wildcard的匹配规则</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>csv 文件的格式，可选`rfc`,`default`, 默认为`default`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>http和https不支持重定向</p>
</li>
<li>
<p>lookup命令所使用的文件默认的大小限制为8m，对应配置项lookup.max_download_size</p>
</li>
<li>
<p>如果文件下载超时为8s，超过该时间即为读取失败并报错，对应配置项lookup.download_timeout</p>
</li>
<li>
<p>如果指定本地文件，为字典管理列表中的文件</p>
</li>
<li>
<p>由于csv的数据字段都是字符串类型，因此注意join的字段的类型应该为字符串类型才可以lookup成功，如果字段不为字符串类型，可使用eval进行转换。</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 59. 示例1</div>
<div class="content">
<div class="paragraph">
<p>假设外部csv文件有以下字段：host, user, department, 将搜索结果中的username字段和csv文件的user进行关联，在搜索结果中增加host, user, department字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">| makeresults count=1 | eval username="hunter" | lookup user,host,department /data/rizhiyi/spldata/lookup/user.csv on username=user</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041912.396.png" alt="Image 140318 041912.396">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 60. 示例2</div>
<div class="content">
<div class="paragraph">
<p>假设外部csv文件有以下字段：id,mask,pattern,raw, 将搜索结果中的id字段和csv文件的id进行精确匹配，搜索结果中的ip和csv中的mask进行cidr匹配，搜索结果中的rvalue与csv中的pattern进行通配匹配，在搜索结果中增加mask,pattern,raw字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">appname:a | rename 'value' as rvalue | lookup mask,pattern,raw lookupJoiner.csv on id=id,ip=mask,rvalue=pattern match_type=cidr(ip),wildcard(rvalue)</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>lookupJoiner.csv内容</p>
</div>
<div class="paragraph">
<p>"id","mask","pattern","raw"<br>
"1","192.168.1.126/24","abc*","one"<br>
"2","192.168.4.138/24","cd*","two"<br>
"3","aaaaaaaa","abc*","three"<br>
"4","192.168.1.126/24","cd","four"<br>
"5","192.168.1.126/24","ef*","five"root@192.168.1.141:/data/rizhiyi/spldata/lookup</p>
</div>
<div class="paragraph">
<p>关联结果：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/lookup-1.png" alt="lookup 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 61. 示例3</div>
<div class="content">
<div class="paragraph">
<p>假设外部csv文件有以下字段：appname,word, 将搜索结果中的app字段和csv文件的appname进行关联，在搜索结果中增加word字段，其中匹配时不区分大小写。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">| makeresults | eval app = "Test" | lookup word match_test.csv on app=appname case_sensitive_match=false</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/lookup-2.png" alt="lookup 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lookup2"><a class="anchor" href="#_lookup2"></a><a class="link" href="#_lookup2">6.44. lookup2</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用lookup2命令可以添加自定义字段。通过在指定脚本存放路径下(默认为：/data/rizhiyi/spldata/lookup/script)添加相关的配置文件以及python处理数据文件即可添加自定义字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup2 &lt;script-name&gt; &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>script-name</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;identifier&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要关联的script-name</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;outputfields&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>outputfields</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>outputfields &lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>结果过滤字段，结果中只包含指定的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>配置文件以及python文件描述：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>配置文件：</p>
<div class="ulist">
<ul>
<li>
<p>文件名：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup_external.cfg(必须为该名称，否则将读取不到配置)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>文件内容：</p>
<div class="ulist">
<ul>
<li>
<p>示例配置文件：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>lookup_script_names = ["external_script"]
// lookup_scripts config
lookup_scripts {
    external_script {
        external_file = "external_script.py"
        input_fields = "appname,tag"
        join_fields = "appname,tag"
        output_fields = "appname,tag,appnametag"
  }
}</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>说明：</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>lookup_script_names：用于指定当前所有的python脚本名称</p>
</li>
<li>
<p>lookup_scripts：用于写入每个script-name的配置信息</p>
</li>
<li>
<p>external_script：代表script-name的名称，即为lookup2之后使用的script-name名称，内部是该脚本对应的相关配置信息</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>external_file：用于指定该script-name对应的python文件名称</p>
</li>
<li>
<p>input_fields：用于指定该python文件的输入字段(输入字段顺序严格按照该顺序输入数据)</p>
</li>
<li>
<p>join_fields：用于指定该python文件输出结果与上一个命令的结果进行join时所使用的字段</p>
</li>
<li>
<p>output_fields：用于指定该python文件输出字段(需严格保证输出字段顺序),可以通过冒号(:)分隔符来指定输出字段类型，如：timestamp:long等，目前支持的类型有 long,double,boolean,默认为字符串。</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Python脚本：</p>
<div class="ulist">
<ul>
<li>
<p>文件名：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要与配置文件中external_file的名称保持一致</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>文件内容：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将输入的数据经过处理之后生成新的数据并且返回。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>协议：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>无头的csv协议。输入以及输出严格按照配置文件的输入输出顺序</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>#!/usr/bin/env python
import csv
import sys
def main():
    infile = sys.stdin
    outfile = sys.stdout
    r = csv.reader(infile)
    w = csv.writer(outfile)
    for result in r:
        if result:
            result.append(result[0]+result[1])
            w.writerow(result)
main()</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>lookup2的脚本默认存放路径为：/data/rizhiyi/spldata/lookup/script，对应的配置项为lookup2.script_path，如果需要修改脚本存放路径则修改该配置项即可。</p>
</li>
<li>
<p>如果为多台spl集群则需要每台机器上都需要上传配置文件以及python脚本。</p>
</li>
<li>
<p>python文件需要保证在处理同样的join fields的情况下输出统一的output fields</p>
</li>
<li>
<p>join fields可以支持类型不同进行关联操作，如果在使用lookup2命令之前的数据类型是int，但是python返回的数据类型为string时，是可以关联成功并且返回结果的。</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 62. 示例</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | lookup2 external_script outputfields appname,timestamp,appnametimestamp</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>该脚本传入appname以及timestamp两个字段值，将起组合的值拼接起来并生成一个新的字段为appnametimestamp。该脚本在配置文件中配置的对应访问名称为external_sccript。</p>
</div>
<div class="paragraph">
<p>配置文件为：</p>
</div>
<div id="app-listing-1" class="listingblock">
<div class="title">Listing 2. lookup_external.cfg</div>
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">    lookup_script_names = ["external_script"]
    // lookup_scripts config
    lookup_scripts {
        external_script {
            external_file = "external_script.py"
            input_fields = "appname,timestamp"
            join_fields = "appname,timestamp"
            output_fields = "appname,timestamp,appnametimestamp"
        }
    }</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>python文件为：</p>
</div>
<div id="app-listing-2" class="listingblock">
<div class="title">Listing 3. external_script.py</div>
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-Python" data-lang="Python">#!/usr/bin/env python
import csv
import sys
def main():
    infile = sys.stdin
    outfile = sys.stdout
    r = csv.reader(infile)
    w = csv.writer(outfile)
    for result in r:
        if result:
            result.append(result[0]+result[1])
            w.writerow(result)
main()</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041812.396.png" alt="Image 140318 041812.396">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_makecontinuous"><a class="anchor" href="#_makecontinuous"></a><a class="link" href="#_makecontinuous">6.45. makecontinuous</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>在一定数值或时间范围内，根据给定的区间大小，对原始数据升序处理，并补充不连续的区间，区间的划分采用向前圆整的方式。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>makecontinuous [&lt;field&gt;] &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;field&gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要进行区间补全的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timestamp（内置字段）</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>&lt;param-options&gt;</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[&lt;span&gt;] | [&lt;start&gt;] | [&lt;end&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>参数：</p>
<div class="ulist">
<ul>
<li>
<p>span:</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>桶的大小, 可以是数值类型(比如 10)，也可以是时间类型(比如 10d)，单位可以是 s | m | h | d | w | M（更多扩展写法详见小节'与搜索结合使用的修饰符')</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>1 （如果是时间类型，则表示1ms）</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>start:</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>区间补全的起始范围, 实际的起始范围是start的向前圆整
（时间类型只支持long类型的时间戳）</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>数据最小值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>end:</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>区间补全的结束范围, 实际的结束范围是end的向前圆整
（时间类型只支持long类型的时间戳）</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>数据最大值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 63. 示例：</div>
<div class="content">
<div class="paragraph">
<p>对数值类型的数据，对字段x，按大小为3进行排序分桶，在216到226之间进行补全</p>
</div>
<div class="paragraph">
<p>原始数据:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makecontinuous-1.png" alt="makecontinuous 1">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | makecontinuous x span=3 start=216 end=226</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makecontinuous-3.png" alt="makecontinuous 3">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 64. 示例：</div>
<div class="content">
<div class="paragraph">
<p>对时间类型的数据，对字段time，按大小为1d进行排序分桶和补全</p>
</div>
<div class="paragraph">
<p>原始数据:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makecontinuous-2.png" alt="makecontinuous 2">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | makecontinuous time span=1d</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makecontinuous-4.png" alt="makecontinuous 4">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_makeresults"><a class="anchor" href="#_makeresults"></a><a class="link" href="#_makeresults">6.46. makeresults</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>构造指定的结果</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>| makeresults [count=&lt;int&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>count</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述<br>
=     产⽣的结果个数</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 65. 示例1</div>
<div class="content">
<div class="paragraph">
<p>产⽣⼀条结果并⽣成新的app字段，⽤于后续map命令</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| makeresults count = 1 | eval app = "zookeeper" | map "* appname:$app$"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042913.645.png" alt="Image 140318 042913.645">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_map"><a class="anchor" href="#_map"></a><a class="link" href="#_map">6.47. map</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令可以将上次搜索结果应用于接下来的搜索中， 类似于python的map功能</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>map "&lt;subsearch_command&gt;" [maxsearches = &lt;int&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;subsearch_command &gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子查询搜索语句 如 `... | map "index = yotta  starttime=$start$ login_name=$user$"`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;maxsearches&gt;: 可选参数</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxsearches = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>最大的搜索个数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>10</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于性能的考虑，所以对map前一结果的条数限制默认为20，对应的配置项为map.max_searches_limit</p>
<div class="ulist">
<ul>
<li>
<p>示例：</p>
</li>
</ul>
</div>
</li>
<li>
<p>| stats count() by logtype | limit 2 | rename logtype as type | map "logtype:$type$"</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>上述在map命令之前的数据条数必须小于20条，超出部分将被丢弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>map命令是否使用cache，使用cache可以加快速度但是同时会增加内存的使用，默认不使用cache，对应的配置项为map.use_cache</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 66. 示例</div>
<div class="content">
<div class="paragraph">
<p>列出日志数最多的三种logtype他们各自最大的日志文本长度</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* |  stats count() by logtype | limit 3 | rename logtype as type | map "logtype:$type$ | stats max(raw_message_length)"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045352.033.png" alt="Image 140318 045352.033">
</div>
</div>
<div class="paragraph">
<p>以上语句, 实际是先执行 <code>* |  stats count() by logtype | limit 3 | rename logtype as type</code> 找出 日志数最大的3个logtype:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045433.962.png" alt="Image 140318 045433.962">
</div>
</div>
<div class="paragraph">
<p>可以看到分别为apache,java,和other。</p>
</div>
<div class="paragraph">
<p>接下来map会对这三个结果分别生成对应的搜索语句</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>logtype:apache | stats max(raw_message_length)</code></p>
</li>
<li>
<p><code>logtype:java | stats max(raw_message_length)</code></p>
</li>
<li>
<p><code>logtype:other | stats max(raw_message_length)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>分别请求搜索，最终将结果进行合并</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_movingavg"><a class="anchor" href="#_movingavg"></a><a class="link" href="#_movingavg">6.48. movingavg</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>在一个指定大小的移动窗口下计算某个数值字段的移动平均值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>movingavg &lt;field&gt;[,window] [as &lt;as_field&gt;] [by &lt;by-field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要计算移动平均值的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>移动平均值的输出字段名，默认为_moving_avg</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>window</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>移动窗口的大小，对于序号小于window的事件，将根据前面实际的事件进行计算</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>by-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组字段，在分组内进行移动平均值的计算</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 67. 示例1</div>
<div class="content">
<div class="paragraph">
<p>以分钟为单位统计apache返回的apache.resp_len的长度的和，以5为窗口计算移动平均值。得到一个每分钟的响应长度和的平滑后的值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | bucket timestamp span=1m as ts | stats sum(apache.resp_len) as sum_len by ts | movingavg sum_len,5 as moving_avg_resp_len</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042300.802.png" alt="Image 140318 042300.802">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mvcombine"><a class="anchor" href="#_mvcombine"></a><a class="link" href="#_mvcombine">6.49. mvcombine</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将除指定字段外，其他字段值均相等的行合并为一行，指定字段将合并为一个数组值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>mvcombine [&lt;sep&gt;] &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>string</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要指定的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sep</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>sep = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>多行合并时的指定字段值作为字符串合并时的分隔符，默认为空格</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>mvcombine指令由于需要将相同的行进行合并，所以需要在内存中暂存结果，所以对性能有限制。目前默认限制只对5万条结果进行mvcombine，可以根据自己服务器的性能进行调整spl配置项mvcombine.max_events</p>
</li>
<li>
<p>mvcombine需要有除指定field以外值都相同的列</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 68. 示例1</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | table appname, hostname, ip | limit 10 | mvcombine ip</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042502.374.png" alt="Image 140318 042502.374">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mvexpand"><a class="anchor" href="#_mvexpand"></a><a class="link" href="#_mvexpand">6.50. mvexpand</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将一行变成多行，指定字段如果为数组值那么就分成一行一个的值，如果为单值则无影响，其他字段的值原样复制</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>mvexpand &lt;multi-value-field&gt; &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>multi-value-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>须为多值字段，如果字段值为单值将不会有任何改变</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;limit&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>一行分裂为多行时取指定字段数组值的前N个进行分裂，因为有可能存在一个数组里面元素过多的情况，所以在此进行限制。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 69. 示例</div>
<div class="content">
<div class="paragraph">
<p>拆分前的事件:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042340.818.png" alt="Image 140318 042340.818">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | mvexpand json.a</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>拆分后</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042410.542.png" alt="Image 140318 042410.542">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_outputlookup"><a class="anchor" href="#_outputlookup"></a><a class="link" href="#_outputlookup">6.51. outputlookup</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用 outputlookup 命令可以生成字典管理中的 csv 文件；也可以生成kvstore或资产实体，名称和类型在命令中指定</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>outputlookup &lt;param-options&gt;* &lt;lookup-type&gt;? &lt;filename-or-kvstorename-or-assetname&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>filename-or-kvstorename-or-assetname</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;file-name&gt; | &lt;kvstorename&gt; | &lt;asset-name&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>文件名必须以.csv结尾，无须提供路径。文件为通过字典上传或者outputlookup写出的文件。kvstore必须在所属domain和app下已经定义好。使用资产实体时资产模型必须存在。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lookup-type</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>(csv: | kvstore: | asset: )</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>outputlookup文件类型，csv：csv文件；kvstore：kv字典；asset：资产实体。不填优先匹配csv，不成功匹配为kv字典</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;appendwrite&gt; | &lt;createempty&gt; | &lt;overrideifempty&gt; | &lt;maxresult&gt; | &lt;keyfield&gt; | &lt;format&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>离散化选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>appendwrite</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>appendwrite=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示是否为追加写，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>createempty</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>createempty=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示如果结果为空是否要创建一个空文件，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>overrideifempty</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>overrideifempty=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示如果结果为空,是否要用空文件覆盖已经存在的重名文件，默认为true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxresult</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxresult=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示导出结果的最大数量，默认为500000</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>keyfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keyfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>kvstore中的key字段名称。kvstore中将被指定为arangodb的key值的字段名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>csv 文件的格式，可选`rfc`,`default`, 默认为`default`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>maxresult参数值的最大上限值为500000，如果语句中maxresult参数值超过该值，则取该值作为导出结果的最大数量，对应的配置项为outputlookup.max_result_limit</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 70. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将按照时间分组统计的日志个数统计结果写出到外部csv</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> * | stats count() by timestamp| outputlookup stats_count_by_timestamp.csv</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>命令执行：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041426.376.png" alt="Image 140318 041426.376">
</div>
</div>
<div class="paragraph">
<p>下载路径文件：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-041426.377.png" alt="Image 140318 041426.377">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 71. 示例2</div>
<div class="content">
<div class="paragraph">
<p>将按照clientip、type分组统计的日志个数统计结果写出到kvstore存储</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">index=packet * | stats count() as cnt by json.client_ip, json.type | rename json.client_ip as client_ip | rename json.type as type | outputlookup packetsrc</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>命令执行：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/outputlookup_kvstore.png" alt="outputlookup kvstore">
</div>
</div>
<div class="paragraph">
<p>kvstore存储预览：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/outputlookup_kvstore_store.png" alt="outputlookup kvstore store">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parse"><a class="anchor" href="#_parse"></a><a class="link" href="#_parse">6.52. parse</a><a id="parse_function"></a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于搜索时动态抽取字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>parse [field=&lt;field&gt;] “&lt;regex&gt;” [max_match=&lt;int&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;regex&gt;</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;正则表达式&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>支持java的正则表达式，应该包括(?&lt;name&gt;X)形式的named-capturing group, 否则该正则表达式将被忽略</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;field&gt;</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于抽取正则表达式的字段，如果未指定，默认为: raw_message</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>&lt;max_match&gt;</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定抽取正则表达式的次数，如果未指定则默认抽取第一个匹配到的值，如果该值大于1则返回类型为多值字段类型，反之返回单值字段类型</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>不支持eval后的字段</p>
</li>
<li>
<p>parse.max_match：max_match参数的上限，用于限制输入指定的max_match参数值，如果超过该配置项的值，默认值为100</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>不支持eval后的字段</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 72. 示例1</div>
<div class="content">
<div class="paragraph">
<p>从日志原文中抽取ip地址，得到新的字段ip_addr,并且按照ip_addr分组并计算appname的个数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | parse "(?&lt;ip_addr&gt;\d+\.\d+\.\d+\.\d+)" | stats count(appname) by ip_addr</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042913.644.png" alt="Image 140318 042913.644">
</div>
</div>
<div class="paragraph">
<p>从结果图中可以看到新生成的ip_addr字段，该字段的格式满足指定的正则表达式</p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 73. 示例2</div>
<div class="content">
<div class="paragraph">
<p>抽取request_path 的第一级目录outer_path,并按照outer_path分组统计appname的个数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">logtype:apache | parse field=apache.request_path "^(?&lt;outer_path&gt;/[^/]*)" | stats count(appname) by outer_path</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042941.426.png" alt="Image 140318 042941.426">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 74. 示例3</div>
<div class="content">
<div class="paragraph">
<p>从日志原文中抽取raw_message中的前两组数字</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">*|parse "(?&lt;messageNum&gt;\d+)" max_match=2</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-042980.428.png" alt="Image 140318 042980.428">
</div>
</div>
<div class="paragraph">
<p>从结果图中可以看到新生成的messageNum字段，该字段为包含两个值的多值字段</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_partition"><a class="anchor" href="#_partition"></a><a class="link" href="#_partition">6.53. partition</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用partition命令可以将制定统计搜索中的分组字段的值进行随机分组，以解决离散值过多引起的统计分组数限制的问题</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>partition [&lt;int&gt;] [by &lt;field&gt;] [[ sub_stats_command ]]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;int&gt;</p>
<div class="ulist">
<ul>
<li>
<p>格式：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>一个大于0的整数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定将分组字段分成多少组</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>&lt;field&gt;</p>
<div class="ulist">
<ul>
<li>
<p>语法：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>string</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定后面统计中使用的分组字段名称</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>此处指定的分组字段必须为后续统计命令中使用的第一个分组字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>&lt;sub_stats_command&gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子搜索命令，必须为统计类型</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>此处只可以指定一个统计命令，且必须有分组字段，第一个分组字段和外层by field需要一致。
统计命令包括：stats top sort timechart chart geostats</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 75. 示例1</div>
<div class="content">
<div class="paragraph">
<p>按appname分组统计上周日志个数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | partition 10 by appname [[stats count() by appname]]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/partition_stats.png" alt="partition stats">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* |stats count() by appname</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/partition_no_stats.png" alt="partition no stats">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rare"><a class="anchor" href="#_rare"></a><a class="link" href="#_rare">6.54. rare</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>获取字段出现次数最少的值的集合</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rare &lt;field&gt; &lt;rare-option&gt;* [by-fieldlist-clause]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要rare的字段名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rare-option</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>countfield=&lt;field&gt; | percentfield=&lt;field&gt; | showcount=&lt;bool&gt; | showperc=&lt;bool&gt; | limit=&lt;int&gt; | maxdoc=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rare选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>precision</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>precision=&lt;number&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
</li>
</ul>
</div>
</li>
<li>
<p>countfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>countfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rare字段数量输出的字段名, 默认值是'count</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>percentfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>percentfield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rare字段数量百分比输出的字段名, 默认值是'percent'</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>showcount</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>showcount=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否输出字段数量, 默认值是true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>showperc</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>showperc=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否输出数量百分比字段, 默认值是true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>结果的最大行数, 不设置使用spl配置项stats.rare.count_limit</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxdoc</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxdoc=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>限制字段的最大数量，超过的值不会显示，默认不限制</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>by-fieldlist-clause</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>by &lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组的字段列表，表示先按照field-list分组，在分组内部计算rare</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 76. 示例1</div>
<div class="content">
<div class="paragraph">
<p>返回出现次数最少出现的，并且在5次以下的srcip，并输出srcip_cnt字段作为count值，srcip_perc段作为百分比</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">  * | rare srcip countfield=srcip_cnt percentfield=srcip_perc maxdoc=5</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044358.201.png" alt="Image 140318 044358.201">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 77. 示例2</div>
<div class="content">
<div class="paragraph">
<p>按照appname进行分组，分组内找到出现次数最少的clientip</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">  * | rare apache.clientip by appname</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rename"><a class="anchor" href="#_rename"></a><a class="link" href="#_rename">6.55. rename</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>重新命名指定字段 将src-field的字段，重命名为dest-field，可用于结果集中字段名的修改，比如输出为中文字段名；同时目前支持对多个字段同时进行重命名操作,支持通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rename &lt;rename-item&gt; [,&lt;rename-item&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>rename-item</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;src-field&gt; as &lt;dest-field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要rename的字段项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>src-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;|&lt;wildcardfield&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要被重命名的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>dest-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;|&lt;wildcardfield&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>dest-field可以是一个合法的字段名，也可以是一个字符串的常量，比如 "Status from apache"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 78. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将username字段命名为 "用户名"</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>logtype:apache | rename apache.clientip as "ip地址"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>从结果图中的红色标注中，可以看到apache.clientip字段被重新命名成了ip地址 字段</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043126.773.png" alt="Image 140318 043126.773">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043126.774.png" alt="Image 140318 043126.774">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 79. 示例2</div>
<div class="content">
<div class="paragraph">
<p>将stats生成的cnt字段重命名为计数</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache |  stats count() as cnt by apache.clientip | rename cnt as "计数"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043154.692.png" alt="Image 140318 043154.692">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 80. 示例3</div>
<div class="content">
<div class="paragraph">
<p>将stats生成的tag字段和sp字段重命名其他名称</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">*  | stats sparkline(avg(apache.resp_len), 1h) as sp by tag | rename tag as tag2, sp as sp2</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043219.440.png" alt="Image 140318 043219.440">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 81. 示例4</div>
<div class="content">
<div class="paragraph">
<p>将stats生成的以json开始的字段重命名为以rejson开始的字段名</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* |stats count() by json.ip,json.logid,appname|rename json* as rejson*</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043219.441.png" alt="Image 140318 043219.441">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rollingstd"><a class="anchor" href="#_rollingstd"></a><a class="link" href="#_rollingstd">6.56. rollingstd</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>计算移动标准差</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rollingstd &lt;field&gt;[,&lt;window&gt;] [as &lt;as-field&gt;] [by &lt;by-field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要计算移动标准差的字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>window</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>移动窗口的大小，对于序号小于window的事件，将根据前面实际的事件进行计算</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>as-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>移动标准差的输出字段名，默认为_rolling_std</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>by-field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组字段，在分组内进行移动标准差的计算</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 82. 示例1</div>
<div class="content">
<div class="paragraph">
<p>以时间分组算出apache返回的response的长度的和，以10为窗口计算rolling的标准差。以观察resp_len的波动情况。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | stats sum(apache.resp_len) as sum_resp_len by timestamp | rollingstd sum_resp_len,10 as resp_len_rolling_std</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043034.987.png" alt="Image 140318 043034.987">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_save"><a class="anchor" href="#_save"></a><a class="link" href="#_save">6.57. save</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可将搜索的结果保存为文件，目前仅支持csv格式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>save &lt;param-options&gt;* &lt;output-file&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>output-file</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;file-name&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>最好指定挂接共享文件系统的目录，否则保存在yotta的某一台服务器上，基于安全的考虑，本地文件的路径必须为/data/rizhiyi/spldata/或者其子目录。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;format&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>离散化选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>csv 文件的格式，可选`rfc`,`default`, 默认为`default`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 83. 示例1</div>
<div class="content">
<div class="paragraph">
<p>按照hostname分组统计clientip个数，并保存的apache_clientip.csv文件</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">*| stats count(apache.clientip) by hostname | save /data/rizhiyi/spldata/apache_clientip.csv</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043845.862.png" alt="Image 140318 043845.862">
</div>
</div>
<div class="paragraph">
<p>从上图可以看到我们将stats结果输出的到对应文件中去，打开该文件可以看到得到的结果</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043855.757.png" alt="Image 140318 043855.757">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sort"><a class="anchor" href="#_sort"></a><a class="link" href="#_sort">6.58. sort</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>按照指定的字段对搜索结果进行排序。对于数值类型将按照数值进行排序，对于字符串类型将按照字典序进行排序。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>sort [&lt;sort-count&gt;] by &lt;sort-item-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sort-item-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;sort-item&gt;(,&lt;sort-item&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>列出排序所依据的字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>sort-item</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[(+|-)]&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>单个排序的字段，其中+表示升序，-表示降序，默认为降序</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sort-count</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要排序的事件数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>描述：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>sort命令将按照给定字段列表对结果进行排序，对于数值类型将按照数值进行排序，对于字符串类型将按照字典序进行排序。
如果sort是对事件排序（query之后），则by可以支持多个字段，但不允许对eval的字段进行排序
如果sort是对统计结果进行排序(stats, transaction之后)，则by仅支持一个字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>sort的最大条数限制，用于限制输入指定的sort后追加的int参数，如果大于默认200000数则报错，对应配置项为sort.max_size</p>
<div class="ulist">
<ul>
<li>
<p>示例：</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">appname:apache | sort 2000 by +timestamp</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>上述命令中的2000会首先判断是否小于上述的配置项，如果超过则报错，如果不指定则默认sort 200000条数据</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>排序默认保留的条数，默认为10000，对应配置项为sort.maintain_size</p>
</li>
</ul>
</div>
</li>
<li>
<p>示例：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">appname:apache | sort 12000 by +timestamp</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>上述sort命令后的结果如果超过默认值10000条则只取前10000条数据，之后的数据将被丢弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 84. 示例1</div>
<div class="content">
<div class="paragraph">
<p>对事件结果按照timestamp升序排序</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">logtype:apache | sort by +timestamp
image::/static/images/Image-140318-043724.084.png[]</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>从结果图中，可以看出事件是按照timestamp进行升序排列的</p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 85. 示例2</div>
<div class="content">
<div class="paragraph">
<p>统计不同appname下，每个ip的数量，并按照ip的数量降序排序</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">logtype:apache | stats count(apache.clientip) as ip_count by appname | sort by -ip_count</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043751.697.png" alt="Image 140318 043751.697">
</div>
</div>
<div class="paragraph">
<p>从结果图中可以看到，ip_count是从大到小，进行的降序排序</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stats"><a class="anchor" href="#_stats"></a><a class="link" href="#_stats">6.59. stats</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>提供统计信息，可以选择按照字段分组</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>stats (&lt;stats_function&gt; [as &lt;field&gt;])+ [by &lt;field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stats-func-as</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | list | values | top | es | dhg | hg | pct | pct_ranks | rb | sparkline | mad</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与stats命令结合的函数，请参考[#与stats有关的函数]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>每个stats_function都可以定义输出字段名，否则对后续的计算不可见</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组字段，所有的stats_func将在分组内统计</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>描述：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>计算数据集的聚合统计信息，与SQL的聚合类似。如果未使用by子句进行调用，将生成一行，表示对整个传入的数据集进行聚合。如果使用by子句，将为by子句的每个非重复值生成一行。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>该命令统计或者表格情况下的最大结果数，默认为20000，对应配置项为stats.max_result_count</p>
<div class="ulist">
<ul>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>appname:apache</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述：</p>
</li>
</ul>
</div>
</li>
<li>
<p>group.size 配置项：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令由于支持by多个字段进行分组统计。如果stats统计时by n个字段进行统计，每个字段假设都有100个值，这样在统计时则会产生100^n个分组，这样一来如果by的字段数足够多或该字段的值的种类足够多，则对性能影响很大，所以我们这边设置了group.size配置项用于限制by的每个的字段的最大分组数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>stats.oneby.group_size 配置项</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该命令由于支持by单个字段进行分组统计时指定单个字段的最大分组数，如果不填则默认取group.size值。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 86. 示例1</div>
<div class="content">
<div class="paragraph">
<p>统计ip和status的组合的事件数量</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | stats count() by apache.clientip, apache.status</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043559.901.png" alt="Image 140318 043559.901">
</div>
</div>
<div class="paragraph">
<p>结果图中有三栏，第一栏是apache.clientip,说明是先按照apache.clientip分组，对于每个ip组，然后在按照apache.status分组，最后每个status组都会有一个对应的count值</p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 87. 示例2</div>
<div class="content">
<div class="paragraph">
<p>统计每个访问路径的平均响应长度</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache | stats avg(apache.resp_len) as avg_resp_len by apache.request_path | rename avg_resp_len as "平均响应长度"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043625.685.png" alt="Image 140318 043625.685">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_streamstats"><a class="anchor" href="#_streamstats"></a><a class="link" href="#_streamstats">6.60. streamstats</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可以对数据的连续变化进行累积性的统计，并将统计结果以新字段的方式添加在原始数据中</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>streamstats [&lt;streamstats-params&gt;]* &lt;streamstats-func-as&gt; [, &lt;streamstats-func-as&gt; ]* [by &lt;field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>streamstats-func-as</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | derivative | exact_dc | sumsq | var | stddev | list | values | distinct | top | rate</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与stats命令结合的部分函数，请参考[#与stats有关的函数]。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>streamstats-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[reset_on_change=&lt;bool&gt;] | [reset_before=&lt;eval-expression&gt;] | [reset_after=&lt;eval-expression&gt; ] | [current=&lt;bool&gt;] | [window=&lt;int&gt;] | [time_window=&lt;span-length&gt;] | [global=&lt;bool&gt;] | [allnum=&lt;bool&gt;] | [timefield=&lt;field&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>reset-before</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>reset_before=&lt;eval-expression&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>在生成对某一事件的统计值之前重置统计。当此参数与window一起使用时，window也会被重置。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>reset-after</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>reset_after=&lt;eval-expression&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>在生成对某一事件的统计值之后重置统计。当此参数与window一起使用时，window也会被重置。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>time-window</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>time_window=&lt;span-length&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>时间窗口的大小。当time_window和window一起使用时，time_window规定的是一个window内部的时间窗口大小。无论是window还是time_window其实影响的都是在某一窗口中命中的事件数[使用time_window参数的前提是时间必须是按时间字段排序的]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>span-length</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>span_length=&lt;int&gt; &lt;timeunit&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>每个时间窗口的跨度，第一个数字为系数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>timeunit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeunit=s | m | h | d | w</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>时间单位，分别表示秒，分钟，小时，天，周</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>reset-on-change</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>reset_on_change=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>当group by字段的值改变时,是否将累计的统计值重置。只有遇到包含所有group by 字段的事件才会触发这一操作，只有一部分group by 字段的事件会被忽略。当此参数与window一起使用时，window也会被重置。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>current</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>current=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>统计是否包含当前event，默认为true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>window</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>window=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>事件数窗口大小，默认为0(即所有事件)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>global</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>global=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>只有在指定window时生效，决定是否使用单一window还是使用由by字段决定的多个window，默认为true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>allnum</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>allnum=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>聚合字段截止目前是否全部为数值。当allnum为false时，遇到聚合字段为非数值型会跳过此条日志进行统计，即当前这条日志的统计结果为空；allnum为true时，遇到聚合字段为非数值型时会将此条及以后所有日志的统计值均置为空。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timefield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timefield=&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定日志中的时间字段名称，默认为timestamp</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组字段，所有的stats-func-as将在分组内统计</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 88. 示例1</div>
<div class="content">
<div class="paragraph">
<p>window为3以及global为true的情况下，按照生成字段b进行分组并连续统计cnt的distinct count值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> | makeresults count=10
 | streamstats window=10 count() as cnt by timestamp
 | eval b = cnt%2
 | streamstats window=3 global=true dc(cnt) as dc_ by b</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043559.899.png" alt="Image 140318 043559.899">
</div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>说明：
    global为true说明使用一个单一window
    第一行结果就计算的是第1行的事件对应的dc值即为：b为1的时候的dc(cnt)值为1(cnt取值：1)
    第二行结果就计算的是第1-2行的事件对应的dc值为：b为0的时候的dc(cnt)值为1(cnt取值：2)
    第三行结果就计算的是第1-3行的事件对应的dc值为：b为1的时候的dc(cnt)值为2(cnt取值：1，3)
    第四行结果就计算的是第2-4行的事件对应的dc值为：b为0的时候的dc(cnt)值为2(cnt取值为2，4)
    之后以此类推</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 89. 示例2</div>
<div class="content">
<div class="paragraph">
<p>window为3以及global为false的情况下，按照生成字段b进行分组并连续统计cnt的distinct count值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> | makeresults count=10
 | streamstats window=10 count() as cnt by timestamp
 | eval b = cnt%2
 | streamstats window=3 global=false dc(cnt) as dc_ by b</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043559.900.png" alt="Image 140318 043559.900">
</div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>说明：
    global为false说明使用b的结果作为window的个数(在本题中b有两种值，即0代表一种window，1代表一种window)
    第一行结果就计算的是第1行的事件对应的dc值即为：b为1的时候的dc(cnt)值为1(cnt取值：1)
    第二行结果就计算的是第1-2行的事件对应的dc值为：b为0的时候的dc(cnt)值为1(cnt取值：2)
    第三行结果就计算的是第1-3行的事件对应的dc值为：b为1的时候的dc(cnt)值为2(cnt取值：1，3)
    第四行结果就计算的是第2-4行的事件对应的dc值为：b为0的时候的dc(cnt)值为2(cnt取值为2，4)
    第五行结果就计算的是第3-5行的事件对应的dc值为：b为1的时候的dc(cnt)值为3(由于以1为window的桶内数据未达到3，所以cnt取值为1，3，5)
    之后以此类推</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 90. 示例3</div>
<div class="content">
<div class="paragraph">
<p>window为3以及reset_after为cnt&gt;5的情况下，按照生成字段b进行分组并连续统计cnt的distinct count值</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> | makeresults count=10
 | streamstats window=10 count() as cnt by timestamp
 | eval b = cnt%2
 | streamstats reset_after="cnt&gt;5" window=3 global=false dc(cnt) as dc_ by b</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043559.902.png" alt="Image 140318 043559.902">
</div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>说明：
    global为false说明使用b的结果作为window的个数(即0代表一种window，1代表另一种)
    第一行结果就计算的是第1行的事件对应的dc值即为：b为1的时候的dc(cnt)值为1(cnt取值：1)
    第二行结果就计算的是第1-2行的事件对应的dc值为：b为0的时候的dc(cnt)值为1(cnt取值：2)
    第三行结果就计算的是第1-3行的事件对应的dc值为：b为1的时候的dc(cnt)值为2(cnt取值：1，3)
    第四行结果就计算的是第2-4行的事件对饮的dc值为：b为0的时候的dc(cnt)值为2(cnt取值为2，4)
    第五行结果就计算的是第1-5行的事件对饮的dc值为：b为1的时候的dc(cnt)值为3(cnt取值为1，3，5)
    第六行结果就计算的是第2-6行的事件对饮的dc值为：b为0的时候的dc(cnt)值为3(cnt取值为2，4，6)
    此时reset生效，之前统计的所有历史值清零
    第七行结果就计算的是第7行的事件对饮的dc值为：b为1的时候的dc(cnt)值为1(cnt取值为7)
    第八行结果就计算的是第8行的事件对饮的dc值为：b为0的时候的dc(cnt)值为1(cnt取值为8)
    之后以此类推</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_table"><a class="anchor" href="#_table"></a><a class="link" href="#_table">6.61. table</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将查询结果以表格形式展示，并对字段进行筛选，如果日志不包含筛选字段，则用空行显示，支持通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>table &lt;comma-splitted-fieldlist&gt; | &lt;space-splitted-fieldlist&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>comma-splitted-fieldlist</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;wildcard-field&gt;(,&lt;wildcard-field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用逗号分割字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>space-splitted-fieldlist</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;wildcard-field&gt;(,&lt;wildcard-field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用空格分割字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>wildcard-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;|&lt;single-quoted-string&gt;|&lt;wildcardfield&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 91. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将查询中的结果用表格展示并且只显示apache.status和apache.method 字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code> * | table apache.status, apache.method</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045016.696.png" alt="Image 140318 045016.696">
</div>
</div>
<div class="paragraph">
<p>结果中有几行空行，是因为这几条日志中， 没有这两个字段</p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 92. 示例2</div>
<div class="content">
<div class="paragraph">
<p>将查询中的结果用表格展示并且只显示以json.i开始字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code>* |table json.i*</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045016.697.png" alt="Image 140318 045016.697">
</div>
</div>
<div class="paragraph">
<p>结果中有几行空行，是因为这几条日志中， 没有这两个字段</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_timechart"><a class="anchor" href="#_timechart"></a><a class="link" href="#_timechart">6.62. timechart</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timechart的行为是将时间分桶后的统计行为，相当于bucket | stats by</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timechart [&lt;timechart-params&gt;]* &lt;stats-single-value-func&gt; [&lt;stats-single-value-func&gt;]* [by &lt;field&gt; &lt;timechart_by_params&gt;*] [where &lt;expression&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>timechart-func-as</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>avg | min | max | sun | count | distinct_count | first | last | earliest | latest | rate | exact_dc | sumsq | var | stddev | mad | list | top</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与stats命令结合的函数，请参考[#与stats有关的函数]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>timechart-by-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[useother=&lt;bool&gt;] | [otherstr=&lt;double-quoted-string&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>useother</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>useother=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示如果限制了limit的大小，落入limit之后的byfield的值是否使用other代替，默认值为false，即不代替并舍弃这些列</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>otherstr</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>otherstr=&lt;double-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>useother为true时使用otherstr指定的字符串来代替落入limit之后的byfield的值，默认值为other</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timechart-params</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>[sep=&lt;string&gt;] | [format=&lt;string&gt;] | [cont=&lt;bool&gt;] | [limit=&lt;int&gt;] | [bins=&lt;int&gt;] | [span=&lt;TIMESPAN&gt;] | [minspan=&lt;TIMESPAN&gt;] | [startindex=&lt;int&gt;] | [endindex=&lt;int&gt;] | [rendertype=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>span-str</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>span=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示分桶间隔，格式为数字+单位，与bucket指令span参数的格式相同，单位可以是 s | m | h | d | w | M | q（更多扩展写法详见小节'与搜索结合使用的修饰符')</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>sep</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>sep=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示by field和统计字段组合时的分隔符，默认值为":"。
如max(agent_send_timestamp) as ma, by logtype：logtype值为apache时，sep="+" 那么组合出来的字段值为ma+apache
这里默认的顺序为统计字段+分隔符+by field，如果想改变顺序，请使用下面format参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>format</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>format=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示规定字段的组合分隔符和组合顺序，默认值为"$AGG:$VAL"。 在这个字段中用$AGG表示统计字段，$VAL表示by field的值，所以一般的写法是format="$AGG$VAL"，此时为字段分隔符，如果想改变组合顺序，可将$VAL和$AGG的顺序反过来，分隔符仍需置于中间位置</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>cont</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>cont=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示是否将不连续的时间桶补充为连续，默认为false。因为将时间按照一定的时间间隔进行分桶时，有些桶内可能没有日志或者时间落入桶，此时桶内的所有统计值都为0。默认情况下会将这些桶所在的行去掉，如果置为true则会将这些行补充到结果中。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>limit</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>limit=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示限制使用by field值的个数，默认值为无穷大。即若语句中有 max count avg三种统计函数，by field有10种值，那么在不限制limit的情况下将有3*10+1个字段，即结果中有31列。若limit=5，那么将只取byfield的前5个值与统计字段进行组合，结果就只有3*5+1=16列，结果中也将只有这些列的值。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>bins</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>bins=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示最多有多少个桶，默认值100。timechart指令的结果中分桶个数由bins、span、minspan共同决定，bins只规定了桶的最多个数，桶的个数和时间间隔也会随着整个查询的timespan而动态调整。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>minspan</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>minspan=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示最小分桶间隔，格式与span相同。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>startindex</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>startindex=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为0，表示从所有桶中的第几个桶开始取，前面的桶对应的行将被舍弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>endindex</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>endindex=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认值为无穷大，表示取到所有桶中的第几个桶，后面的桶对应的行将被舍弃</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>rendertype</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rendertype=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定绘图的类型，可选值：line(折线图)，area(面积图)，scatter(散点图)，column(柱状图)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>描述：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>与bucket | stats by不同的是，timechart结果的字段名和意义将比较特别，特别适合于画图。其结果的字段为固定的_time字段，即分桶后的timestamp值；其余的所有字段为by field与统计结果的排列组合值。</p>
</li>
<li>
<p>比较特别的是，timechart使用的by field字段只支持by一个field，不支持by一个fieldlist。原因是timechart可以对byfield的取值情况进行限制（如useother），如果by field允许多个，这个参数将存在歧义。</p>
</li>
<li>
<p>timechart只支持统计函数中的单值统计函数，即：avg，min，max，sum，count，dc<br>
比如：timechart max(agent_send_timestamp) as ma count() as cnt by logtype<br>
假设logtype总共两个值apache和other，那么timechart的字段总共有5个，分别为_time，apache:ma，other:ma，apache:cnt，other:cnt。那么timechart的结果一行的含义将变成：在属于某个timestamp分桶值范围内的logtype值为apache的最大agent_send_timestamp值，logtype值为other的最大agent_send_timestamp值，logtype值为apache的事件数count值，logtype值为other的事件数count值，相当于将bucket | stats的结果进行了字段值重组和一定意义上的行列转置。</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于timechart是内部相当于bucket|stats by，所以这里会触发stats命令中的by字段的限制，详情见stats命令的NOTE中的group.size以及stats.oneby.group_size配置项</p>
</li>
<li>
<p>timechart的span参数以及minspan，bins之间的关系</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>有span参数（minspan以及bins不生效）</p>
</li>
<li>
<p>没有span参数(minspan以及bins才生效)</p>
<div class="olist loweralpha">
<ol class="loweralpha">
<li>
<p>当前时间范围除以bins得到的值(设为x,并且x有一定的向上取整范围)如果小于minspan则取minspan</p>
</li>
<li>
<p>如果x大于minspan则取x<br>
注：如果在没有span参数的时候分桶的值不满足预期则需咨询spl相关研发同事帮忙查看</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 93. 示例1</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">tag:timechart|eval x = len(tostring(apache.request_path))|timechart sep="," format="$VAL**$AGG" limit=5 bins=10 minspan=1m span=10m max(x) as ma count() as cnt by apache.geo.city</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>表示字段分割符为**，组合顺序为byfield值+分隔符+统计字段，限制byfield值为5个进行组合，桶最大个数为10个，最小时间分割桶为1分钟一个，时间分割间隔为10分钟一个时，对raw_message字段长度每个桶取最大值为ma字段，对每个桶出现的事件数进行统计为cnt字段，按照apache.geo.city进行分组后的结果。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043924.958.png" alt="Image 140318 043924.958">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043924.959.png" alt="Image 140318 043924.959">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 94. 示例2</div>
<div class="content">
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash"> * | timechart sep="," format="$VAL**$AGG" limit=3 rendertype="line" bins=200 minspan=1m span=10m max(delay_time) as ma count() as cnt by apache.status</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>表示字段分割符为**，组合顺序为byfield值+分隔符+统计字段，桶最大个数为200个，最小时间分割桶为1分钟一个，时间分割间隔为10分钟一个时，对delay_time字段长度每个桶取最大值为ma字段，对每个桶出现的事件数进行统计为cnt字段，按照apache.status进行分组后绘制成折线图。</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-043924.960.png" alt="Image 140318 043924.960">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_timewrap"><a class="anchor" href="#_timewrap"></a><a class="link" href="#_timewrap">6.63. timewrap</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对timechart命令的结果进⾏显⽰或者折叠，可以使⽤timewrap命令实现指定时间周期的数据的⽐较，⽐如按天或者按⽉。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timewrap &lt;timespan&gt; param-options*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>timespan</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;&lt;timeunit&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>描述span的时间跨度. 时间单位支持[s, m, h, d, w, M, q, y（更多扩展写法详见小节'与搜索结合使用的修饰符')]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;align&gt; | &lt;series&gt; | &lt;timeformat&gt; | &lt;timefield&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可选参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>align</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>align = (now | end)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定在按照时间范围进⾏折叠的时候，是对⻬到搜索的结束时间点还是当前时间</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>series</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>series = (relative | exact | short)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定新的列如何被命名，如果series=relative ，并假设timewrap-span 指定为1d，则字段名分别为0days_before, 1days_before ，如果series=exact ，则使⽤timeformat 指定的格式来对列进⾏命名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timeformat</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeformat = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>如果指定了series=exact，则字段名将按照timeformat来格式化时间戳进⾏命名，例如，指定timeformat= "yyyy-MM-dd",则字段名会显⽰为2017-01-01, 2017-01-08</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timefield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timefield = &lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定时间字段的字段名，默认为_time</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 95. 示例1</div>
<div class="content">
<div class="paragraph">
<p>统计昨天的事件数，并将将上午的数据和下午的数据进行对比</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>starttime="now-1d/d" endtime="now/d" * | timechart span=1h count() as ct  | timewrap 12h  | eval date=formatdate(_time)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044939.023.png" alt="Image 140318 044939.023">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_top"><a class="anchor" href="#_top"></a><a class="link" href="#_top">6.64. top</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>获取字段出现次数前N的值的集合，输出字段包括field</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>top &lt;size&gt; &lt;field&gt; &lt;param-options&gt;* [&lt;by-fieldlist-clause&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>size</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回字段值的个数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>string</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>需要求top的字段名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;countfield&gt; | &lt;percentfield&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>top 可选的参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>countfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>countfield = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认top会输出count字段(count目前为SPL的关键字)，可通过countfield指定字段名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>percentfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>percentfield = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认top会输出percent字段，可通过percentfield指定取代percent的字段名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>by-fieldlist-clause</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>by &lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>分组的字段列表，表示先按照field-list分组，在分组内部计算top N的值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于top支持by多个字段,所以这里会与stats命令中的by字段有同样的字段的限制，详情见stats命令的NOTE中的group.size以及stats.oneby.group_size配置项</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 96. 示例1</div>
<div class="content">
<div class="paragraph">
<p>返回top 3的clientip，同时clientip_count字段表示出现次数，clientip_percent表示所占百分比</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">  * | top 3 apache.clientip countfield=clientip_count percentfield=clientip_percent
  * | top 3 apache.clientip countfield=clientip_count percentfield=clientip_percent</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044358.201.png" alt="Image 140318 044358.201">
</div>
</div>
<div class="paragraph">
<p>从结果图中看到，除了想要统计的apache.clientip字段外，还有clientip_count字段表示计数，以及clientip_percent字段表示百分比</p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 97. 示例2</div>
<div class="content">
<div class="paragraph">
<p>搜索结果按照request_path进行分组，每个分组内返回top 3的apache.clientip。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">  * | top 3 apache.clientip by apache.request_path</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044438.044.png" alt="Image 140318 044438.044">
</div>
</div>
<div class="paragraph">
<p>按照apache.request_path分组，分别求出对应的出现次数最多的clientip，同时count，percent为默认字段，表示个数和百分</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transaction"><a class="anchor" href="#_transaction"></a><a class="link" href="#_transaction">6.65. transaction</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将事件分组成交易</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>transaction &lt;field-list&gt; &lt;txn-definition-opt&gt;* &lt;memcontrol-opt&gt;* &lt;trans-states&gt;?</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>一个字段或者字段名的列表，事件将根据此字段的值进行分组成各个交易</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>txn-definition-opt</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;maxspan&gt;|&lt;maxevents&gt;|&lt;startswith&gt;|&lt;endswith&gt;|&lt;contains&gt;|&lt;timeshift&gt;|&lt;keepopentxn&gt;|&lt;mvlist&gt;|&lt;mvraw&gt;|&lt;nullstr&gt;|&lt;sortfield&gt;|&lt;keeporphans&gt;|&lt;maxpause&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>交易定义选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>maxspan</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxspan = &lt;int&gt;(s|m|h|d)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>交易的事件的时间跨度小于maxspan，可以理解为第一条事件的时间戳和最后一条事件的时间戳的跨度不能大于maxspan</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxevents</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxevents = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>一个交易中的最大事件个数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>startswith</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>startswith = eval(&lt;expression&gt;)|&lt;quoted_string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>搜索或者eval过滤表达式，如果某个事件满足条件，则标志新交易的开始</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>endswith</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>endswith = eval(&lt;expression&gt;)|&lt;quoted_string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>搜索或者eval过滤表达式，如果某个事件满足条件，则标志新交易的结束</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>contains</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>containes = eval(&lt;expression&gt;)|&lt;quoted_string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>判断raw_message里是否包含eval或字符串中的值，字符串可以为正则表达式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timeshift</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeshift = &lt;int&gt;(s|m|h|d)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>为解决transaction结束的时间边界问题引入的参数，意思是手动将时间结束节点延后的时间长度</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>示例：</p>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">transaction apache.clientip startswith="Android 4.3" timeshift=10m</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>手动将要执行的命令的搜索时间范围结束点延后10min。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>这样将会使得本来不完整的transaction 在延后的时间段内找到其结束事件，从而变成完整的transaction。timeshift的具体值的设置依赖于实际应用场景和使用经验。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>keepopentxn</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keepopentxn = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否将找到end但未找到start的transaction从结果中去掉</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>false，即不保留</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>mvlist</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>mvlist = &lt;bool&gt; | &lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定为bool值时意义为是否将所有字段抽取为单独的多值字段；指定为字段列表时意义为将指定的字段抽取为单独的多值字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>mvraw</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>mvraw = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示是否将raw_message字段抽取为一个单独的多值字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>nullstr</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>nullstr = &lt;double-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>抽取为多值字段后结果中为空的元素的替换值，默认值为"nullstr"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>"nullstr"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>sortfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>sortfield = [+|-]field,...</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将一个transaction内的事件按照sortfield指定的顺序进行排列，当指定多个字段时表示第一个字段相等则按第二个字段排序...以此类推，默认为+timestamp</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>+timestamp</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>keeporphans</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keeporphans = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定事务命令是否应输出不属于任何事务的结果</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>false，即不输出</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxpause</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxpause= &lt;int&gt;(s|m|h|d)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定事务中事件之间暂停的最长时间（以秒、分钟、小时或天为单位）。如果值为负，则禁用最大暂停约束，并且没有限制</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>-1，即禁用最大暂停约束，且没有限制</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>memcontrol-opt</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;maxopentxn&gt; | &lt;maxopenevents&gt; | &lt;keepevicted&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>内存控制选项</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>maxopentxn</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxopentxn = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>维护在内存中的open transaction的个数，采用LRU的策略进行淘汰</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxopenevents</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>maxopenevents = &lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>维护在内存中的open transaction中的events的最大数量，LRU策略淘汰</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>keepevicted</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>keepevicted = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>是否输出逐出的事务。通过检查“closed_txn”字段的值，可以将逐出的交易与非逐出的交易区分开来。对于已逐出的交易，“closed_txn”字段设置为 “0” 或 false，对于未逐出或已关闭的事务，字段设置为 “1” 或 true。如果满足以下条件之一，则“closed_txn”字段设置为“1”：maxevents，maxpause，maxspan，startswith。对于 startswith，由于事务命令以相反的时间顺序查看事件，因此它会在满足开始条件时关闭事务。如果未指定这些条件，则输出所有事务，即使所有事务都将“closed_txn”设置为“0”。当达到内存限制时，也可以逐出事务。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>默认值：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>false，即不输出逐出的事务</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>trans-states</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>( &lt;trans_states_in_field&gt; | &lt; trans_states_match&gt; ) (results by flow)?</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>根据transaction中的日志匹配出具体状态，形成transaction的状态流</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>trans_states_in_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>with states &lt;field_value&gt;(,&lt;field_value&gt;)* in &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将使用field中的字段值，作为状态的值，该字段值必须包含在field_value列表里</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>trans_states_match</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;trans_state_match&gt; ("," &lt;trans_state_match&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用trans_state_match列表中的规则对日志进行匹配生成状态</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>trans_state_match</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>with "&lt;regex&gt;" ("in" &lt;field&gt;)? as &lt;state&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>如果field中的字段值匹配regex成功，则该条日志状态为state</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>描述：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>如果字段列表为多个字段，并不会解释为这些字段的逻辑AND（field1 AND field2 AND field3）或者逻辑或(field1 OR field2 OR field3)，如果字段列表中的字段存在传递关系，transaction命令将试图通过传递关系来进行计算。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对于下列事件，可能会被归类到一个transaction中：</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>host=a
host=a  username=b
username=b age=20</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>如果指定了trans_state的参数，将会对transaction中的日志进行状态的匹配，按照时间顺序进行匹配，得到每条日志的状态，如果指定了results by flow参数，则生成状态之间的转换关系，目前匹配方式分为两种：</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>利用某个字段中的值作为状态，with states a, b, c in module results by flow</p>
</li>
<li>
<p>对日志原文中使用正则匹配进行状态指定，如：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>with "query parse" in message as qp,
with "fetch doc" in message as fd
results by flow</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>maxopenevents参数对应的最大值默认为100000，对应配置项为transaction.max_open_events_limit</p>
<div class="ulist">
<ul>
<li>
<p>说明：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该配置项用于限制maxopenevents的这个参数值，如果在语句中指定的该参数的值超过该配置项，则会报错。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>maxopenevents参数对应的默认值为50000，对应配置项为transaction.max_open_events</p>
<div class="ulist">
<ul>
<li>
<p>说明：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该配置项为语句中没有指定maxopenevents参数值时，使用的默认参数值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 98. 示例1</div>
<div class="content">
<div class="paragraph">
<p>通过apache.clientip对日志进行关联，按照时间戳排序，包含Receive的日志为一个新的交易的第一条日志，包含Response的为最后一日志，最多包含10条日志，日志的时间跨度最大为5s</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache |  transaction apache.clientip startswith="Android 4.3" endswith="AndroidPhone" maxopenevents = 10</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044724.520.png" alt="Image 140318 044724.520">
</div>
</div>
<div class="paragraph">
<p>从图中可见，以clientip为分组的transaction的起始日志含有”Android 4.3”，并且以含有Android Phone的日志为结束点</p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 99. 示例2</div>
<div class="content">
<div class="paragraph">
<p>通过apache.clientip对日志关联，每个交易最多包含10条日志，满足apache.status等于200的日志为transaction的第一条日志</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache |transaction apache.clientip startswith=eval(apache.status==200)  maxopenevents = 10</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044752.558.png" alt="Image 140318 044752.558">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 100. 示例3</div>
<div class="content">
<div class="paragraph">
<p>输入以下json日志，使用transaction获取状态转移的信息</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre>{"timestamp":"2017-04-12 16:27:14.000", "sid":1, "module":"a"}
{"timestamp":"2017-04-12 16:27:14.000", "sid":2, "module":"a"}
{"timestamp":"2017-04-12 16:27:14.002", "sid":1, "module":"b"}
{"timestamp":"2017-04-12 16:27:14.003", "sid":1, "module":"c"}
{"timestamp":"2017-04-12 16:27:14.003", "sid":2, "module":"c"}
{"timestamp":"2017-04-12 16:27:14.004", "sid":3, "module":"a"}
{"timestamp":"2017-04-12 16:27:14.005", "sid":3, "module":"b"}</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>得到结果如下：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044846.794.png" alt="Image 140318 044846.794">
</div>
</div>
<div class="paragraph">
<p>对transaction的flow结果进行统计，生成桑基图:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044907.605.png" alt="Image 140318 044907.605">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 101. 示例4</div>
<div class="content">
<div class="paragraph">
<p>搜索到的所有数据按照appname进行聚合(图一)，按照appname进行聚合并且按照json.a进行排序(图二)</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">tag:richard2 | transaction appname</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>图一：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/transaction-1.png" alt="transaction 1">
</div>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">tag:richard2 | transaction appname sortfield=+json.a</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>图二：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/transaction-2.png" alt="transaction 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transpose"><a class="anchor" href="#_transpose"></a><a class="link" href="#_transpose">6.66. transpose</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将查询的表格结果进行行列转换</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>transpose [transpose-count] &lt;transpose-row&gt; &lt;transpose-column&gt; &lt;transpose-valueField&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>transpose-row</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>row=&lt;field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于识别新生成的行的关键字，相同的row的字段值的原表格将被合并成同一行</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>transpose-column</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>column=&lt;field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该字段包含的值将被作为新的字段标签</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>transpose-valueField</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>valueField=&lt;field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该字段的值将被用于表示新生成表格中对应的值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>transpose-count</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>表示有多少行将被用于做转换</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于性能的考虑我们该命令最多转换的行数为100000条，对应的配置项为transpose.row_limit，如果需要转换更多的行，则修改该配置项即可。</p>
</li>
<li>
<p>由于性能的考虑我们行列转换后的结果的最大列数为500，对应的配置项为transpose.column_limit，如果需要转换后的结果的列数更多，则修改该配置项即可。</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="exampleblock">
<div class="title">Example 102. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将统计结果进行transpose，row字段为apache.method,column字段为apache.status, value字段为cnt</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | stats count() as cnt by apache.method, apache.status | transpose row=apache.method column=apache.status valuefield=cnt</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045115.648.png" alt="Image 140318 045115.648">
</div>
</div>
<div class="paragraph">
<p>结果图中可以看到apache.method字段的值作为新生成行的关键字，相同的关键字将被合并，apache.status字段的值将会被作为新的标签，而cnt字段的值则成为了表格里的数值</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unpivot"><a class="anchor" href="#_unpivot"></a><a class="link" href="#_unpivot">6.67. unpivot</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>行转列操作</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>unpivot [&lt;count&gt;] &lt;param-options&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>count</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可操作的原始结果行数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>param-options</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;column-name&gt; | &lt;header-field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>column-name</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>column_name = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>新生成的结果的首列名称，可以带双引号也可不带</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>header-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>header_field = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>新生成的结果中，除首列外，其余列名称对应原始结果中该列的内容</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>默认最大可操作行的限制为500，由配置项unpivot.row_size控制</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>示例:</p>
</div>
<div class="paragraph">
<p>原始数据:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/unpivot-1.png" alt="unpivot 1">
</div>
</div>
<div class="exampleblock">
<div class="title">Example 103. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将统计结果直接进行行列转换</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | unpivot</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/unpivot-2.png" alt="unpivot 2">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 104. 示例2</div>
<div class="content">
<div class="paragraph">
<p>将统计结果进行行列转换，并指定新列名对应的原始列名字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | unpivot header_field = group</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/unpivot-3.png" alt="unpivot 3">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 105. 示例3</div>
<div class="content">
<div class="paragraph">
<p>将统计结果进行行列转换，指定可操作的原始行数，原始列对应的名称，以及新列对应的原始字段。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">* | unpivot 2 column_name=aaa header_field=group</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/unpivot-4.png" alt="unpivot 4">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_where"><a class="anchor" href="#_where"></a><a class="link" href="#_where">6.68. where</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用表达式对结果进行过滤</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>where &lt;expression&gt; | &lt;field&gt; &lt;in-func&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>expression</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;expression_function&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>参考eval命令的表达式，但where要求表达式计算结果应该为布尔类型，如果返回true则不过滤当前行的结果，否则任意其他值该行将被过滤掉。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in-func</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>in(x [,y]...)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>给定一个字段和若干指定值，判断字段中的值是否在指定值中存在</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 106. 示例1</div>
<div class="content">
<div class="paragraph">
<p>筛选出所有apache格式且日志中的城市为深圳市的日志后，按照访问路径request_path分组，对每个组求出访问的不同clientip个数，并限制不同的ip数在40到100范围</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">logtype:apache AND apache.geo.city:"深圳市" |  stats dc(apache.clientip) as dc_count by apache.request_path | where dc_count &gt; 40 &amp;&amp; dc_count &lt; 100</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-044939.022.png" alt="Image 140318 044939.022">
</div>
</div>
<div class="paragraph">
<p>从结果图中可以看到，每个不同的requet_path都会是不同一行，对应一个count值，这个count值就是不同的ip个数，且根据where限制将在40-100之间</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xpath"><a class="anchor" href="#_xpath"></a><a class="link" href="#_xpath">6.69. xpath</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>提供对xml数据的处理和抽取</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>xpath [input=&lt;field&gt;] output=&lt;field&gt; path=&lt;string&gt; [default_value=&lt;string&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>path</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>xpath描述的路径</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>output</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定输出字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>input</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定抽取的字段，默认为raw_message</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>default_value</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>当抽出的值为空时默认填充的值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 107. 示例1</div>
<div class="content">
<div class="paragraph">
<p>在搜索appname:lyxpath的结果中，抽取字段json.xp中路径为/purchases/book/title的对应的信息写出到lyly字段中</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">appname:lyxpath | xpath input=json.xp output=lyly path="/purchases/book/title"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/xpath-1.png" alt="xpath 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_replace"><a class="anchor" href="#_replace"></a><a class="link" href="#_replace">6.70. replace</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用指定字符串替换字段值，可以指定一个或多个字段，仅替换指定字段的值，如果没有指定字段，则替换所有字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>replace value-item [,value-item]* [IN &lt;field-list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>value-item</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;source-String&gt; with &lt;target-String&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用&lt;target-String&gt;替换&lt;source-String&gt; , 支持通配符*以匹配多个字段值,如果&lt;source-string&gt;和&lt;target-string&gt;都含有通配符，则根据*的位置，调整字符串顺序</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; ( , &lt;field&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定要替换值的字段，可以指定一个或多个。如果不指定，则替换全部字段</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 108. 示例1</div>
<div class="content">
<div class="paragraph">
<p>将所有值为"192.168.1.1"的字段值替换为"localhost"</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * | replace "192.168.1.1" with "localhost"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/replace-example1.png" alt="replace example1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 109. 示例2</div>
<div class="content">
<div class="paragraph">
<p>调整manufacture字段值的顺序，从以"log"开头，调整为以"log"结尾</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * | replace "log*" with "*log" in manufacture</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/replace-example2.png" alt="replace example2">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 110. 示例3</div>
<div class="content">
<div class="paragraph">
<p>调整fruit,fruit1字段值的顺序，如果字段值以a开头e结尾，且中间有字符，则把该字段值替换为"apple"</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * | replace "a*e" with "apple" in fruit,fruit1</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/replace-example3.png" alt="replace example3">
</div>
</div>
<div class="paragraph">
<p>从图中可以看出，fruit以a头e结尾，因此fruit被替换为apple;fruit1不满足条件，因此不会被替换</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_makemv"><a class="anchor" href="#_makemv"></a><a class="link" href="#_makemv">6.71. makemv</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>使用分隔符或者带捕获组的正则表达式，将单值字段转换为多值字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>makemv [delim=&lt;string&gt; | tokenizer=&lt;string&gt;] [allowempty=&lt;bool&gt;] &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定一个要转换成多值的字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>delim</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>delim=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定一个分隔符。在字符串中每遇到一次delim，就做一次分割。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>tokenizer</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>tokenizer=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定一个带捕获组的正则表达式。每当匹配到一个子串，就用这次匹配的第一个捕获组来创建多值字段的值。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>allowempty</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>allowempty=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>当使用delim作为分割符时，允许结果中出现空字符串。allowempty对于tokenizer无效。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 111. 示例1</div>
<div class="content">
<div class="paragraph">
<p>使用分隔符将字符串"a,b,c"用逗号分割，结果为["a","b","c"]</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">*|eval testmv="a,b,c"|makemv delim="," testmv</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makemv-example1.png" alt="makemv example1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 112. 示例2</div>
<div class="content">
<div class="paragraph">
<p>使用正则表达式 (<span class="^">),? 将字符串"aaa,..bb,c"分割，结果取第一个捕获组 ([^,]</span>) 对应的值,最终结果为["aaa","..bb","c"]</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">*|eval testmv="aaa,..bb,c"|makemv tokenizer="([^,]+),?" testmv</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makemv-example2.png" alt="makemv example2">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 113. 示例3</div>
<div class="content">
<div class="paragraph">
<p>使用分隔符将字符串"a,,,b,c"用逗号分割，保留空值,最终结果为["a","","","b","c"]</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">*|eval testmv="a,,,b,c"|makemv delim="," allowempty=true testmv</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/makemv-example3.png" alt="makemv example3">
</div>
</div>
<div class="paragraph">
<p>从图中可以看出，加上allowempty=true后，空值也被保留下来</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_localop"><a class="anchor" href="#_localop"></a><a class="link" href="#_localop">6.72. localop</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>localop命令强制随后的命令都在spl单机执行</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>localop</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="exampleblock">
<div class="title">Example 114. 示例1</div>
<div class="content">
<div class="paragraph">
<p>如果没有localop，这条语句中的eval命令会在分布式引擎执行；加上localop之后，这条语句中的eval命令以及随后的命令都在spl单机执行</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * | localop | eval a=123</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_strcat"><a class="anchor" href="#_strcat"></a><a class="link" href="#_strcat">6.73. strcat</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>连接来自2个或更多字段的值。将字段值和指定字符串组合到一个新字段中</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>strcat [allrequired=&lt;bool&gt;] &lt;source-field&gt;+ &lt;dest-field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>source-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;quoted-str&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定要连接的字段名称或者带双引号的字符串</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>dest-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定目标字段的名字，用来保存连接后的结果。目标字段要出现在源字段的后面</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>allrequired</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>allrequired = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定每个事件中是否需要所有源字段都存在。如果为allrequired=false，则不存在的源字段将被视为空字符串。如果为allrequired=true，则仅当所有源字段都存在时，才将值写入目标字段。默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 115. 示例1</div>
<div class="content">
<div class="paragraph">
<p>把字段field1，字符串\"abcd\"，字段field2连接，存到字段strcatresult中</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * |eval field1=\"10.192.1.1\",field2=\"192.168.1.1\" |strcat field1 \"abcd\" field2 strcatresult</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/strcat-example1.png" alt="strcat example1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 116. 示例2</div>
<div class="content">
<div class="paragraph">
<p>把一个存在的字段field1和一个不存在的字段field3连接，用allrequired=true要求所有源字段都存在。结果中不会有strcatresult字段</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * |eval field1=\"10.192.1.1\",field2=\"192.168.1.1\" |strcat allrequired=true field1 field3 strcatresult</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/strcat-example2.png" alt="strcat example2">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 117. 示例3</div>
<div class="content">
<div class="paragraph">
<p>把一个集合类型的字段field1和字符串\"abcd\"连接，用allrequired=true要求所有源字段都存在。由于field1是一个空集合，结果中不会有strcatresult字段。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh"> * |eval field1=split(\"\",\".\")|strcat allrequired=true field1 \"abcd\" strcatresult</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/strcat-example3.png" alt="strcat example3">
</div>
</div>
<div class="paragraph">
<p>从图中可以看出，由于field1为空，而allrequired=true要求所有源字段都存在，因此strcat命令执行后，结果中没有strcatresult</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loadjob"><a class="anchor" href="#_loadjob"></a><a class="link" href="#_loadjob">6.74. loadjob</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>加载先前完成的定时任务或告警的执行结果。由ID 和type唯一确定一个任务。如果最近一次时间点的结果不存在，则临时运行原始查询。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>| loadjob &lt;id&gt; ,&lt;type&gt; [&lt;artifact-offset&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>id</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>id=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定一个定时任务或告警的id。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>type</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>type=&lt;quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定job类型，目前我们只支持"savedschedule"。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>artifact-offset</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>artifact_offset=&lt;int&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>选择加载最近执行的第几条结果。例如，如果 artifact_offset=1，则将加载最近执行完成的第二条结果。如果artifact_offset=2，将加载第三个最近的结果。如果artifact_offset=0，则加载最新的执行结果。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 118. 示例1</div>
<div class="content">
<div class="paragraph">
<p>加载id为1的定时任务的最近一次结果。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">| loadjob id=1,type="savedschedule"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_accum"><a class="anchor" href="#_accum"></a><a class="link" href="#_accum">6.75. accum</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对每个事件中为数字的指定字段进行逐次累加，得到的累加结果会放入该字段或者新字段中。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>accum &lt;field&gt; [as &lt;new-field&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>累加字段，该字段必须包含数字。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>new-field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;single-quoted-string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>新字段，会将累加的结果放入该字段，如果不指定该字段，会将累加结果放入累加字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 119. 示例1</div>
<div class="content">
<div class="paragraph">
<p>对于每一个事件，会计算从第一个事件开始，到当前事件为止到所有响应长度的和，并将该值保存在sum_resp_len字段中。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">logtype:apache | accum apache.resp_len as sum_resp_len</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Accum-img-1.png" alt="Accum img 1">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_untable"><a class="anchor" href="#_untable"></a><a class="link" href="#_untable">6.76. untable</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>table指令的逆操作，使用该指令可以将表格的查看方式转换到事件列表的查看方式。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>untable</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="exampleblock">
<div class="title">Example 120. 示例1</div>
<div class="content">
<div class="paragraph">
<p>以事件列表的查看方式显示，该条指令等价于："*"。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | table * | untable</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rest"><a class="anchor" href="#_rest"></a><a class="link" href="#_rest">6.77. rest</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>调用日志易API，返回对应结果</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>rest &lt;url_path&gt; &lt;apikey_field&gt; [count_field] [timeout_field] [rest_field]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>apikey_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>apikey=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>API密钥</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>url_path</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;url_path&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>请求日志易的API地址</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>count_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>count=&lt;number&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回的最大结果数。若不指定或指定为0，则代表不限制</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>timeout_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>timeout=&lt;number&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定API请求的超时时间，单位为秒。若不指定或指定为0，则使用默认超时时间60s。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>rest_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;=&lt;field_value&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>API请求的参数内容</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field_value</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt; | &lt;string&gt; | &lt;number&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>请求参数值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 121. 示例1</div>
<div class="content">
<div class="paragraph">
<p>调用日志易API，获取所有可见的AgentGroup列表，限制返回结果数为2</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|rest /agentgroup/ apikey="user apikey" count=2</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 122. 示例2</div>
<div class="content">
<div class="paragraph">
<p>调用日志易API，获取所有可见的应用名称包含a的应用列表</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|rest /apps/ apikey="user apikey" name__contains="a"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_typeahead"><a class="anchor" href="#_typeahead"></a><a class="link" href="#_typeahead">6.78. typeahead</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回指定前缀的字段信息。返回的最大结果数取决于为size参数指定的值。typeahead命令可以以指定索引为目标，并受时间限制。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;prefix_field&gt; [size_field] [index_field]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>prefix_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>prefix=&lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>字段前缀，也可以选择通过【字段:字段值前缀】来根据字段值前缀提示该字段相应的字段值</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>size_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>size=&lt;number&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>返回的最大结果数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>index_field</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>index=&lt;field-list&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定索引来替代默认索引</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;[,&lt;field&gt;]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>索引字段列表</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 123. 示例1</div>
<div class="content">
<div class="paragraph">
<p>返回以app为前缀的字段信息，指定索引为yotta，限制返回条数为5。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|typeahead prefix="app" size=5 index=yotta</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 124. 示例2</div>
<div class="content">
<div class="paragraph">
<p>返回app字段中以a开头的字段值。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">|typeahead prefix="app:a"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_history"><a class="anchor" href="#_history"></a><a class="link" href="#_history">6.79. history</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>查看当前用户的搜索历史，拥有admin角色权限的用户可以查看所有用户的搜索历史</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>history [showall | onlysearch | onlyapp | events]*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>showall</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>showall=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>取值true会展示所有用户的搜索历史（只针对admin有效），默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>onlysearch</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>onlysearch=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>取值true只展示来自前台界面搜索的历史，不会展示告警、定时任务等非界面搜索历史，默认为false</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>onlyapp</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>onlyapp=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>取值true只展示当前app的搜索历史，默认为true</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>events</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>events=&lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>取值true时以事件列表的形式展示搜索历史，默认为false，即以表格形式展示搜索历史</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>搜索历史字段说明</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">字段名</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">含义</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">beaver.beaver_cost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">执行搜索时的引擎耗时，单位ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">domain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">租户名</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该条历史记录的id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任务类型</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.end_ts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl执行结束时的时间戳</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.internal_use</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">是否为内部使用</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.is_logtail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">是否为实时窗口任务</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.max_search_time_range</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用户拥有的最大搜索时长</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.provenance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任务类型</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.result_bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索结果所占空间的字节数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.result_count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索结果的条数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.search_cost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">执行搜索时的spl耗时，单位ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.search_state</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索任务状态</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.sid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索任务的唯一标识sid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.start_search_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索任务的创建时间</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.start_ts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索任务开始执行的时间</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.task_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任务名称</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.total_hits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">搜索语句命中的事件数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.trace_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">该任务的trice_id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.user_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">执行搜索任务的用户id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.app_name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">执行搜索时所在的应用名称</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.app_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">执行搜索时所在的应用id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spl.query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">执行的搜索语句</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 125. 示例1:</div>
<div class="content">
<div class="paragraph">
<p>查看该用户今天的前台搜索历史。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">| history onlysearch=true</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/history-img-1.png" alt="history img 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 126. 示例2:</div>
<div class="content">
<div class="paragraph">
<p>查看今天所有用户的搜索次数。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">| history showall=true  | stats count() by spl.user_id</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/history-img-2.png" alt="history img 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_addcoltotals"><a class="anchor" href="#_addcoltotals"></a><a class="link" href="#_addcoltotals">6.80. addcoltotals</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>将新结果附加到搜索结果集的末尾。结果包含每个数字字段的总和，也可以指定要汇总的字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>addcoltotals [&lt;field-list&gt;] [labelfield] [label]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field-list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要汇总的字段是以逗号或者空格分割的字段列表，支持通配符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>labelfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>labelfield = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>追加到结果集中的列名</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>label</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>label = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>与labelfield一起在新增的列中添加标签，当labelfield参数不存在时，该参数无意义</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 127. 示例1</div>
<div class="content">
<div class="paragraph">
<p>计算所有字段的总和，并将总和放入结果集中，并添加列名为change_name的新列，标签名为ALL。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | stats count() by ip | addcoltotals labelfield=change_name label=ALL</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/addcoltotals-img-1.png" alt="addcoltotals img 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 128. 示例2</div>
<div class="content">
<div class="paragraph">
<p>指定计算列alert.d*，monitor.check_interval 其余数值列均不计算</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">index=lunaxee * | fields alert.duration_time,monitor.check_interval,alert.domain_id,alert.owner_id | addcoltotals alert.d*,monitor.check_interval</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/addcoltotals-img-2.png" alt="addcoltotals img 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_addtotals"><a class="anchor" href="#_addtotals"></a><a class="link" href="#_addtotals">6.81. addtotals</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>为每个搜索结果计算所有数值字段的算术和。可以指定需要求和的字段列表。设置col=true时，在末尾添加计算出的新结果表示字段的列和。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>addtotals &lt;addtotals-param&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>addtotals-param</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;row&gt; | &lt;col&gt; | &lt;labelfield&gt; | &lt;label&gt; | &lt;fieldname&gt; | [&lt;field_list&gt;]</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>决定求和行为是行求和/列求和/行列求和，指定求和行/列的名称，对求和的行/列进行匹配。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>参数</p>
<div class="ulist">
<ul>
<li>
<p>row</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>row = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定是否为每个事件计算&lt;字段列表&gt;的和。总和被放置在一个新的字段中。row的默认值为true。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>col</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>col = &lt;bool&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>指定是否在事件列表的底部添加列和。col的默认值为false。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>labelfield</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>labelfield = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于给求列和的结果指定显示字段，该参数仅在col=true时有效。如果结果集中没有指定的字段，则添加一个新字段。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>label</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>label = &lt;string&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于为列和指定行标签。如果labelfield参数是结果集中已经存在的字段，标签将出现在该列下；如果labelfield参数创建了一个新字段，标签将出现在新字段的列下。默认值为Total。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>fieldname</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>fieldname = &lt;field&gt;</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>用于指定行求和字段的名称。该参数仅在row=true时有效。默认值为Total。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>field_list</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>&lt;field&gt;(,&lt;field&gt;)* | &lt;single-quoted-string&gt;(,&lt;single-quoted-string&gt;)*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>一个或多个用空格分隔的数字字段。如果该参数不为空时，则只有指定的字段被求和。如果该参数为空，则对所有行的数值字段求和。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 129. 示例1</div>
<div class="content">
<div class="paragraph">
<p>同时求行、列和。列和显示在appname字段下且列和名称为Col Total，行和名称为Row Total。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | eval a=123 | stats count() by appname,a  | addtotals col=true labelfield=appname label="Col Total"  fieldname="Row Total"</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/addtotals-img-1.png" alt="addtotals img 1">
</div>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 130. 示例2</div>
<div class="content">
<div class="paragraph">
<p>计算字段名中包含p或以b开头的字段和，并在名为TotalAmount的字段中保存总和。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">* | eval b=123 | eval app=456 | eval ab=11 | stats count() by appname,b,app,ab  | addtotals *p*,b*</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/addtotals-img-2.png" alt="addtotals img 2">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multireport"><a class="anchor" href="#_multireport"></a><a class="link" href="#_multireport">6.82. multireport</a></h3>
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>multireport 指令可以对同一数据流做不同的处理，最后汇聚输出。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>语法：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>multireport &lt;sub-pipeline&gt;*</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>sub-pipeline</p>
<div class="ulist">
<ul>
<li>
<p>语法</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>null</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>描述</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>子搜索管道。以管道符开头的不包含数据源指令的 SPL 语句，如`|where k&gt;1|eval value=1`</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example131.示例1</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>对命中对数据，进行两种不同的处理，把k为偶数的事件的v设置为0，把k为奇数的事件的v设置为1</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-sh" data-lang="sh">*|limit 10|streamstats count() as _c |multireport [[| where _c%2==0|eval v=0]] [[| where _c%2==1|eval v=1]]|table _c,v</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/multireport-img-1.png" alt="multireport img 1">
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spl中使用注释"><a class="anchor" href="#_spl中使用注释"></a><a class="link" href="#_spl中使用注释">7. SPL中使用注释</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>SPL支持两种形式的注释，可以用来:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>描述SPL的用途，某个参数的目的，增强维护性</p>
</li>
<li>
<p>调试SPL，比如注释掉从某个命令之后的所有命令</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>SPL支持两种注释:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>行注释 // 从开始到行结尾的部分都是注释</p>
</li>
<li>
<p>块注释 /* */ 两个注释块中间的都是注释</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>注释可以放在搜索或者其他命令的任意位置，但是放在引号内(成对的单引号和双引号)注释不能生效</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logtail功能"><a class="anchor" href="#_logtail功能"></a><a class="link" href="#_logtail功能">8. Logtail功能</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>通过在界面选择一个实时的窗口, 窗口范围限制为5s-1h</p>
</li>
<li>
<p>运行logtail后，界面会持续的刷新该窗口内的结果，包括时间轴和事件列表</p>
</li>
<li>
<p>时间轴的显示规则：如果窗口在1s-10s，时间轴会以100ms为一个单位，如果窗口在10s-5min, 时间轴会以1s为一个单位，如果窗口在5min-1h，时间轴会以1m为一个单位</p>
</li>
<li>
<p>界面大概会每2s-3s刷新变化一次</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>语法支持：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>是否使用优化：</p>
<div class="ulist">
<ul>
<li>
<p>未使用优化：支持所有命令</p>
</li>
<li>
<p>使用优化：仅支持stats，top命令</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>由于logtail支持优化，所以我们在配置项中的logtail.optimization将会指定是否尝试使用优化，默认为使用优化，打开优化可以减少性能消耗，但是在小间隔时会有精度损失，和logtail.optimization_boundary配合使用</p>
</li>
<li>
<p>在打开优化的情况下，我们需要指定在实时窗口大于多少间隔再使用优化，默认为300000ms，对应配置项logtail.optimization_boundary，如需修改优化时间间隔，则修改该配置项即可</p>
</li>
<li>
<p>由于是指定时间段实时返回数据的，所以为了性能的考虑我们将对query查询的最大结果数限制为1000条，对应配置项为logtail.query.max_result_count，如果需要返回更多的query查询结果则修改该配置项即可</p>
</li>
<li>
<p>由于是指定时间段实时返回数据的，所以为了性能的考虑我们将对stats统计的最大结果数默认为20000条，对应的配置项为logtail.stats.max_result_count，如果需要返回更多的stats查询结果则修改该配置项即可</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_download功能"><a class="anchor" href="#_download功能"></a><a class="link" href="#_download功能">9. Download功能</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>本功能意在对查询的结果进行导出和下载</p>
</li>
<li>
<p>功能的入口有两个，分别在搜索和仪表盘。在搜索中，提交搜索后会出现下载按钮，点击下载并填写下载参数后即可将当前查询的结果导出到文件并存储在配置路径中。进入设置-下载管理，可以看到正在执行的下载任务和已经结束的历史下载任务，再次点击右侧下载按钮可将文件通过浏览器下载至本地。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;文件名&gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>填写文件名以标识此次任务并作为导出文件的名称，如在同一用户下出现重名，那么本次下载任务将不被会执行</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>&lt;文件类型&gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对于下载文件格式的限制，总体上提供txt、csv和json三种格式支持，具体限制见下面详细描述</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;最大下载&gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>可限制下载文件的大小或者下载结果的条数。同时系统配置了最大大小和最多条数，如果用户输入的参数超过配置，将会报错</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>&lt;文件编码&gt;</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>对于下载文件编码格式的限制，默认为UTF-8，可选为GBK。GBK编码主要是为了解决在windows系统下用excel打开csv格式时内容乱码问题</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>语法和格式支持：</p>
</div>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>目前对于Stats类的查询支持csv和json格式，对于Query类的查询支持txt和json格式，对于Transaction类查询仅支持json格式。另外在仪表盘中对于语法的限制遵循仪表盘的说明。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>下载功能的每个用户可同时保存的文件数目最大限制为20，对应配置项download.files_per_user_limit，如果需要支持单用户下载保存更多的文件数，则修改该配置即可</p>
</li>
<li>
<p>下载功能的最大条数限制，默认为10000000，对应配置项为download.max_events</p>
</li>
<li>
<p>csv文件下载时暂不支持append语句</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_搜索宏功能"><a class="anchor" href="#_搜索宏功能"></a><a class="link" href="#_搜索宏功能">10. 搜索宏功能</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SPL宏是一些SPL命令组织在一起，作为一个单独SPL命令完成一个特定的任务，它能使日常工作变得更容易，并且支持多个参数传入</p>
</li>
<li>
<p>定义SPL宏功能入口为：<code>设置→资源→搜索宏</code>，然后可以看到当前配置的所有宏，再次点击右上角的新建按钮即可创建一个SPL宏</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>必要参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>名称：</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该名称为调用搜索宏的名称及参数个数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>如果搜索宏使用参数，则需在名称后附加参数的数目来进行表示</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="ulist">
<ul>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>testMacro(2)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>标签：</p>
</li>
</ul>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>该搜索宏的标签</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="ulist">
<ul>
<li>
<p>定义：</p>
</li>
</ul>
</div>
</li>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>即此次新增的宏代表的spl语句，这里的spl语句可以是完整的带query部分的语句，也可以是不带query的只由管道符分割的一组命令。当宏带参数时，需要在定义spl语句中将参数用双 "$" 符号包裹。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>新增一个名称为mymacro(1)的宏，其定义为 * | stats count() by $X$，X为调用宏时需要传入的字段名，在调用宏的时候使用的语句为：`mymacro(appname)`。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>可选参数：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>是否使用基于eval的宏的定义：</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>要以 eval 命令表达式创建宏定义，请选择使用基于 eval 的表达式?。此设置指定了搜索宏定义是一个返回字符串的 eval 表达式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="ulist">
<ul>
<li>
<p>示例1：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>搜索宏名：mm(2)，宏定义为：if(isstr(a),$x$-$y$,$x$+$y$)，勾选‘使用基于eval的定义’，搜索页搜索 * | eval x=`mm(1,2)`,搜索错误</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例2：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>搜索宏名：mm(2)，宏定义为："if(isstr(a),$x$-$y$,$x$+$y$)"，勾选‘使用基于eval的定义’，搜索页搜索 * | eval x=`mm(1,2)`,搜索正确，x="3"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例3：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>搜索宏名：mm(2)，宏定义为：if(isstr(a),$x$-$y$,$x$+$y$)，不勾选‘使用基于eval的定义’，搜索页搜索 * | eval x=`mm(1,2)`,搜索正确，x=3</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例4：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>搜索宏名：mm(2)，宏定义为："if(isstr(a),$x$-$y$,$x$+$y$)"，不勾选‘使用基于eval的定义’，搜索页搜索 * | eval x=`mm(1,2)`,搜索正常，x="if(isstr(a),1-2,1+2)"</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>上述四种示例中的示例2，即定义中带双引号且勾选eval定义情况下，isstr(a)这里的函数无法传字段名，因为这种情况下宏定义是在语法解析之前也就是拿到数据之前提前执行的，所以无法获取传入字段名和字段值。如若想实现传入字段值进行判断且最终宏替换结果为计算结果的话，请使用第三种示例进行定义。</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>参数：</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>即在上述的必要参数中填写的定义中定义的参数名称，其间使用","分隔</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>x,y</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>NOTE：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>参数之间以逗号分割，参数名称只能包含字母数字，“_”和“-”字符</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>验证表达式：</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>输入通过宏参数运行的eval或布尔表达式</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>isstr(x) &amp;&amp; isstr(y)</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>验证错误信息：</p>
<div class="ulist">
<ul>
<li>
<p>描述：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>输入在验证表达式返回“false”时要显示的信息</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
<li>
<p>示例：</p>
<div class="literalblock">
<div class="content" style="position: relative;">
<pre>参数错误，请输入正确的参数</pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 131. 示例1</div>
<div class="content">
<div class="paragraph">
<p>新增一个名称为mymacro(1)的宏，其定义为 * | stats count() by $X$，X为调用宏时需要传入的字段名，在调用宏的时候使用的语句为：mymacro(appname)。</p>
</div>
<div class="listingblock">
<div class="content" style="position: relative;">
<pre class="highlight"><code class="language-bash" data-lang="bash">`mymacro("appname")`</code></pre>
<button class="copy-btn" style="background-color: rgb(50, 130, 245); color: white; font-size: 12px; position: absolute; right: 6px; top: 6px; cursor: pointer; border: none; padding: 4px 8px; z-index: 10000;">复制</button></div>
</div>
<div class="paragraph">
<p>新建宏的页面：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045116.648.png" alt="Image 140318 045116.648">
</div>
</div>
<div class="paragraph">
<p>使用宏的界面：</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/static/images/Image-140318-045117.668.png" alt="Image 140318 045117.668">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_高基功能flink"><a class="anchor" href="#_高基功能flink"></a><a class="link" href="#_高基功能flink">11. 高基功能(Flink)</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>摘要：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>高基模式搜索(SPL on Flink) 旨在解决在做数据统计时，因分组数量(配置项：group.size)的限制而导致的统计结果不全的问题。 如 <code>stats count() by srcip</code> 在srcip 的数量超过 group.size 的限制时，只会返回部分结果。</p>
</li>
<li>
<p>不建议在高基模式使用非统计类型的命令</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>目前不支持的命令: iplocation, chart, correlation, dbx系列命令, filldown, geostats, makecontinuous, map, rare, save, timechart, timewrap, transpose, unpivot, gentimes, ldap系列命令, loadjob, multisearch, rest, accum, addcoltotals, addtotals, appendcols, autoregress, eventstats, lookup2, multireport, rollingstd, streamstats, partition, 自定义命令, ML系列命令</p>
</li>
<li>
<p>支持普通搜索、普通告警、定时任务和报表功能。</p>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_自定义命令功能"><a class="anchor" href="#_自定义命令功能"></a><a class="link" href="#_自定义命令功能">12. 自定义命令功能</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_摘要"><a class="anchor" href="#_摘要"></a><a class="link" href="#_摘要">12.1. 摘要：</a></h3>
<div class="ulist">
<ul>
<li>
<p>自定义命令旨在解决需要用户对数据自定义一些计算时使用，如用户想要将数据做一些复杂的功能时则可以使用该自定义命令来完成</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>如需使用自定义命令，必须先保证manager上安装了python模块</p>
<div class="ulist">
<ul>
<li>
<p>检查方式：查看/opt/rizhiyi/parcels下有没有python目录)</p>
</li>
<li>
<p>如果没有，安装方式：去 3.4.0.0/3.3.0.0_update_3.4.0.0下载python包并导入manger激活即可。</p>
</li>
</ul>
</div>
</li>
<li>
<p>目前仅支持python文件作为执行自定义命令的可执行文件</p>
</li>
<li>
<p>设置chunked参数时需要注意：</p>
<div class="ulist">
<ul>
<li>
<p>如果使用v2协议，则需要在python脚本中重写initialized方法并且返回命令类型</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_自定义命令执行文件示例"><a class="anchor" href="#_自定义命令执行文件示例"></a><a class="link" href="#_自定义命令执行文件示例">12.1.1. 自定义命令执行文件示例：</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>生成数据命令示例：</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>脚本含义：用于生成如下10条数据</p>
</li>
<li>
<p>脚本文件：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/script-generating_demo.png" alt="script generating demo"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>搜索示例：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-generating_demo.png" alt="spl generating demo"></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>可分布式处理命令示例：</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>脚本含义：用于在当前行加入一个字段名为appname22的值为xxxxx的列</p>
</li>
<li>
<p>脚本文件：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/script-streaming_demo.png" alt="script streaming demo"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>搜索示例：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-streaming_demo.png" alt="spl streaming demo"></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>集中处理命令示例：</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>脚本含义：用于统计数据中ct字段的累积和</p>
</li>
<li>
<p>脚本文件：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/script-centralized_demo.png" alt="script centralized demo"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>搜索示例：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-centralized_demo.png" alt="spl centralized demo"></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>格式转换命令示例：</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>脚本含义：将输入数据进行排序(倒序)</p>
</li>
<li>
<p>脚本文件：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/script-transformed_demo.png" alt="script transformed demo"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>搜索示例：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-transformed_demo.png" alt="spl transformed demo"></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>使用配置文件的arguments参数示例：</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>脚本含义：通过配置文件里面的arguments参数来控制脚本调用不同的计算function</p>
</li>
<li>
<p>脚本文件：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/script-caculate.png" alt="script caculate"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>搜索示例：</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>计算count：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-caculate_cnt.png" alt="spl caculate cnt"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>计算sum：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-caculate_sum.png" alt="spl caculate sum"></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>使用spl命令参数示例：</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>脚本含义：通过spl命令中的参数来控制脚本调用不同的计算function</p>
</li>
<li>
<p>脚本文件：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/script-caculate2.png" alt="script caculate2"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>搜索示例：</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>计算count：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-caculate2_cnt.png" alt="spl caculate2 cnt"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>计算avg：</p>
<div class="ulist">
<ul>
<li>
<p><span class="image"><img src="/static/images/spl-caculate2_avg.png" alt="spl caculate2 avg"></span></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="mask_div00" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div01" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div10" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div11" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div20" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 1300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div21" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 1460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div30" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 1860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div31" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 2020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div40" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 2420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div41" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 2580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div50" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 2980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div51" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 3140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div60" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 3540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div61" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 3700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div70" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 4100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div71" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 4260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div80" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 4660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div81" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 4820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div90" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 5220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div91" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 5380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div100" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 5780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div101" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 5940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div110" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 6340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div111" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 6500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div120" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 6900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div121" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 7060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div130" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 7460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div131" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 7620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div140" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 8020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div141" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 8180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div150" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 8580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div151" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 8740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div160" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 9140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div161" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 9300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div170" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 9700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div171" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 9860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div180" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 10260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div181" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 10420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div190" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 10820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div191" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 10980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div200" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 11380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div201" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 11540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div210" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 11940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div211" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 12100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div220" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 12500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div221" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 12660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div230" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 13060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div231" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 13220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div240" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 13620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div241" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 13780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div250" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 14180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div251" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 14340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div260" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 14740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div261" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 14900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div270" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 15300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div271" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 15460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div280" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 15860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div281" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 16020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div290" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 16420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div291" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 16580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div300" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 16980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div301" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 17140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div310" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 17540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div311" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 17700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div320" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 18100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div321" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 18260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div330" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 18660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div331" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 18820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div340" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 19220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div341" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 19380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div350" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 19780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div351" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 19940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div360" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 20340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div361" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 20500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div370" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 20900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div371" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 21060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div380" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 21460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div381" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 21620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div390" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 22020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div391" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 22180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div400" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 22580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div401" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 22740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div410" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 23140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div411" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 23300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div420" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 23700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div421" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 23860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div430" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 24260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div431" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 24420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div440" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 24820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div441" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 24980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div450" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 25380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div451" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 25540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div460" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 25940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div461" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 26100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div470" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 26500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div471" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 26660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div480" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 27060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div481" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 27220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div490" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 27620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div491" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 27780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div500" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 28180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div501" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 28340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div510" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 28740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div511" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 28900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div520" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 29300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div521" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 29460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div530" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 29860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div531" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 30020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div540" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 30420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div541" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 30580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div550" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 30980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div551" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 31140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div560" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 31540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div561" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 31700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div570" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 32100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div571" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 32260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div580" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 32660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div581" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 32820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div590" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 33220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div591" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 33380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div600" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 33780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div601" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 33940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div610" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 34340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div611" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 34500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div620" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 34900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div621" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 35060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div630" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 35460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div631" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 35620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div640" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 36020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div641" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 36180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div650" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 36580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div651" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 36740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div660" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 37140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div661" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 37300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div670" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 37700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div671" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 37860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div680" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 38260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div681" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 38420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div690" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 38820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div691" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 38980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div700" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 39380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div701" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 39540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div710" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 39940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div711" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 40100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div720" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 40500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div721" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 40660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div730" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 41060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div731" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 41220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div740" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 41620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div741" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 41780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div750" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 42180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div751" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 42340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div760" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 42740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div761" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 42900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div770" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 43300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div771" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 43460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div780" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 43860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div781" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 44020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div790" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 44420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div791" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 44580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div800" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 44980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div801" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 45140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div810" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 45540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div811" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 45700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div820" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 46100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div821" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 46260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div830" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 46660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div831" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 46820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div840" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 47220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div841" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 47380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div850" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 47780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div851" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 47940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div860" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 48340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div861" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 48500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div870" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 48900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div871" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 49060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div880" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 49460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div881" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 49620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div890" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 50020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div891" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 50180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div900" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 50580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div901" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 50740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div910" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 51140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div911" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 51300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div920" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 51700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div921" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 51860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div930" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 52260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div931" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 52420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div940" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 52820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div941" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 52980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div950" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 53380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div951" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 53540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div960" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 53940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div961" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 54100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div970" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 54500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div971" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 54660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div980" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 55060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div981" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 55220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div990" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 55620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div991" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 55780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1000" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 56180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1001" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 56340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1010" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 56740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1011" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 56900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1020" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 57300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1021" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 57460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1030" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 57860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1031" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 58020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1040" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 58420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1041" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 58580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1050" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 58980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1051" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 59140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1060" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 59540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1061" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 59700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1070" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 60100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1071" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 60260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1080" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 60660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1081" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 60820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1090" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 61220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1091" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 61380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1100" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 61780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1101" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 61940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1110" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 62340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1111" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 62500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1120" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 62900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1121" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 63060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1130" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 63460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1131" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 63620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1140" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 64020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1141" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 64180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1150" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 64580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1151" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 64740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1160" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 65140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1161" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 65300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1170" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 65700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1171" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 65860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1180" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 66260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1181" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 66420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1190" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 66820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1191" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 66980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1200" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 67380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1201" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 67540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1210" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 67940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1211" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 68100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1220" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 68500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1221" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 68660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1230" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 69060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1231" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 69220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1240" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 69620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1241" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 69780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1250" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 70180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1251" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 70340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1260" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 70740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1261" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 70900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1270" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 71300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1271" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 71460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1280" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 71860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1281" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 72020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1290" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 72420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1291" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 72580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1300" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 72980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1301" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 73140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1310" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 73540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1311" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 73700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1320" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 74100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1321" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 74260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1330" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 74660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1331" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 74820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1340" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 75220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1341" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 75380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1350" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 75780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1351" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 75940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1360" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 76340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1361" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 76500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1370" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 76900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1371" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 77060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1380" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 77460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1381" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 77620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1390" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 78020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1391" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 78180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1400" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 78580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1401" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 78740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1410" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 79140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1411" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 79300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1420" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 79700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1421" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 79860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1430" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 80260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1431" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 80420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1440" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 80820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1441" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 80980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1450" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 81380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1451" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 81540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1460" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 81940px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1461" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 82100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1470" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 82500px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1471" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 82660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1480" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 83060px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1481" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 83220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1490" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 83620px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1491" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 83780px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1500" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 84180px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1501" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 84340px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1510" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 84740px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1511" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 84900px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1520" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 85300px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1521" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 85460px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1530" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 85860px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1531" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 86020px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1540" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 86420px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1541" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 86580px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1550" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 86980px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1551" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 87140px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1560" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 87540px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1561" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 87700px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1570" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 88100px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1571" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 88260px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1580" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 88660px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1581" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 88820px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1590" style="transform: rotate(-1deg); position: absolute; left: 240px; top: 89220px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div><div id="mask_div1591" style="transform: rotate(-1deg); position: absolute; left: 680px; top: 89380px; overflow: hidden; z-index: 9999; opacity: 0.3; font-size: 18px; font-family: 微软雅黑; color: rgb(0, 0, 0); text-align: center; width: 200px; height: 200px; display: block;"><img src="/static/img/docs/watermark.png"></div></div>
<div id="footer">
<div id="footer-text">
Version 4.1<br>
Last updated 2024-07-01 15:12:32 +0800
</div>
</div>
</div></div></div></div></div></div><audio src="/api/v0/system/custom/sound/play/"></audio></div></div><script>const iframePages=["/app/siem/subPage","/app/siem/search","/app/siem/dashboard","/app/siem/report","/app/siem/alert"];function checkIfSiemPath(a){return iframePages.some((e=>a.startsWith(e)))}if(window.parent!==window&&checkIfSiemPath(window.parent.location.pathname)){var style=document.createElement("style");style.innerHTML="\n          #app > div:only-child > div:first-child {display: none !important;}\n          #app > div:only-child > div:nth-child(3) {height: calc(100% - 48px);}\n          #app > div:only-child .yotta-pageheader-banner-main .yotta-breadcrumb-list .yotta-breadcrumb-item:nth-child(1),\n          #app > div:only-child .yotta-pageheader-banner-main .yotta-breadcrumb-list .yotta-breadcrumb-separator:nth-child(2) {\n            display: none !important;\n          }\n        ";var head=document.querySelector("head");head.appendChild(style)}</script></body></html>